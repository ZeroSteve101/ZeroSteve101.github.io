<!doctype HTML>
<html>
    <head>
        <link rel="icon" href="data:image/png;base64,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">
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"> 
        <title>player</title>
        <style>
            * {
                font-family: 'Verdana', sans-serif;
            }
            body {
                background-color: black;
                color: white;
            }
            .smalltitle, .smallinfo {
                overflow: hidden;
                white-space: nowrap; 
                text-overflow: ellipsis; 
            }
            .smalltitle {
                font-size: 15px; 
                margin-top: 5px;
                font-weight: bold;
            }
            .smallinfo {
                font-size: 12px;
                font-weight: lighter;
            }
            .playerbox {
                background-color: #111111;
                height: 90vh;
                width: 70%;
                min-height: 200px;
                min-width: 600px;
                border: 1px solid grey;
                margin: auto;
                margin-top: 25px;
                border-radius: 1%;
            }
            .playerhalf {
                width: 50%;
                float: left;
            }
            .queuehalf {
                height: 80vh;
                width: 50%;
                float: left;
            }
            .queue {
                margin-left: 10px;
                margin-top: 15px;
                margin-right: 45px;
                max-height: 95%;
                overflow: scroll;
                border-radius: 1%;
                border: 1px solid grey;
            }
            .queueblob {
                border-radius: 5%;
                margin: auto;
                margin-top: 3px;
                margin-bottom: 2px;
                margin-left: 5px;
                margin-right: 5px;
                height: 50px;
                border: 1px solid grey;
                border-radius: 5px;
                max-width: calc(35vw - 12px);
                max-height: 50px;
            }
            .select {
                background-color: darkblue;
                border: 2px solid grey;
            }
            .smallcover {
                max-height: 100%;
                height: 50px;
                float: left;
                margin: auto;
                margin-right: 10px;
                border-radius: 5px;
            }
            .player {
                border-radius: 1%;
                margin: auto;
                background-color: #222222;
                margin-top: 30px;
                width: 80%;
                border-radius: 1%;
                border: 1px solid grey
            }
            .albumdiv {
				padding-top: 20px;
			}
            .albumcover {
                max-height: calc(45vh - 30px);
                max-width: 80%;
                display: block; 
                margin: auto;
                border: 1px solid grey; 
                border-radius: 2%;
            }
            .controls {
                margin: auto;
                margin-bottom: 15px;
                text-align: center;
            }
            .seek {
				width: 85%;
			}
            button {
                background-color: darkblue;
                border: 1px solid white;
                color: white;
                justify-content: center;
                vertical-align: bottom;
                align-items: center;
                font-weight: bold;
            }
			.buttonlarge {
				height: 40px;
				width: 40px;
				font-size: 20px;
                border-radius: 5px;
			}
            label {
                padding-left: 5px;
                padding-right: 5px;
                height: 20px;
                background-color: darkblue;
                border: 1px solid white;
                color: white;
                justify-content: center;
                align-items: center;
                font-weight: bold;
            }
            .buttontext {
                height: 20px;
                border-radius: 2px;
                width: auto;
                margin-left: 10px;
                margin-top: 15px;
                font-size: 15px;
            }
            button:hover {
                background-color: blue;
            }
            button:active {
                background-color: #5b5bff;
            }
            label:hover {
                background-color: blue;
            }
            label:active {
                background-color: #5b5bff;
            }
            .info {
                text-align: center;
                margin-top: 10px;
                margin-bottom: 15px;
                padding-left: 15px;
                padding-right: 15px;
                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;
            }
            .data, .errormsg {
                text-align: center;
                font-size: small;
                color: #777777;
                margin-top: 10px;
                margin-bottom: 0px;
                font-weight: lighter;
            }
            .playback {
                font-family: monospace;
            }
            input[type="file"] {
                display: none;
            }
            input[type="range"] {
                accent-color: rgb(0,0,139);
                border: 1px solid white;
            }
        </style>
        <style id="styleMod">

        </style>
    </head>

    <body>
        <div class="playerbox">
            <div class="playerhalf">
                <div class="player">
                    <div class="albumdiv">
                        <img class="albumcover" id="albumcover" src="">
                    </div>
                    <div class="info">
                        <b id="playingTitle">TITLE</b><br>
                        <span id="playingArtist" style="font-size: 12px;">ARTIST</span><br>
                        <span id="playingAlbum" style="font-size: 12px;">ALBUM</span>
                    </div>
                    <div class="controls">
                        <button class="buttonlarge" id="back" type="button">«</button>
                        <button class="buttonlarge" id="paused" type="button">▶</button>
                        <button class="buttonlarge" id="forward" type="button">»</button><br>
                        <input class="seek" id="playerSeek" type="range" min="0" max="100" value="0"><br>
                        <div class="playback">
                            <span id="currentTime">0:00</span> / <span id="minusTime">-0:00</span> / <span id="totalTime">0:00</span>
                        </div>
                        <div id="data" class="data">
                            data
                        </div>
                        <div id="errormsg" class="data">
                            error
                        </div>
                        <audio id="currentAudio" preload="auto"></audio>
                    </div>
                </div>
            </div>
            <div class="queuehalf">
                <div class="queuecontainer">
                    <button class="buttontext" id="shuffle" type="button" onclick="shufflePlaylist()">Shuffle</button>
                    <label class="buttontext">
                        Load Folder
                        <input id="loadFolders" type="file" webkitdirectory directory multiple accept="audio/*">
                    </label>
                    <label class="buttontext">
                        Load Files
                        <input id="loadFiles" type="file" multiple accept="audio/*">
                    </label>
                    <button class="buttontext" id="clearqueue" type="button" onclick="clearQueue()">Dump Queue</button>
                </div>
                <div class="queue" id="queue">
                    Add some audio files to get started!
                </div>
            </div>
        </div>
    </body>
    <script type="module">
        //const {parseBlob,selectCover} = await import('https://cdn.jsdelivr.net/npm/music-metadata@11.0.0/+esm')
        //music-metadata
        // 566 572 509 177 283 679 695 773 869 873 883 897

        (()=>{var e,t,i={4:(e,t,i)=>{"use strict";i.r(t),i.d(t,{AnsiStringType:()=>O,Float16_BE:()=>A,Float16_LE:()=>E,Float32_BE:()=>C,Float32_LE:()=>_,Float64_BE:()=>M,Float64_LE:()=>R,Float80_BE:()=>z,Float80_LE:()=>N,INT16_BE:()=>g,INT16_LE:()=>T,INT24_BE:()=>y,INT24_LE:()=>b,INT32_BE:()=>k,INT32_LE:()=>w,INT64_BE:()=>S,INT64_LE:()=>x,INT8:()=>h,IgnoreType:()=>L,StringType:()=>U,UINT16_BE:()=>l,UINT16_LE:()=>u,UINT24_BE:()=>p,UINT24_LE:()=>m,UINT32_BE:()=>f,UINT32_LE:()=>d,UINT64_BE:()=>I,UINT64_LE:()=>v,UINT8:()=>c,Uint8ArrayType:()=>B});var r=i(506);const a={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},n={};for(const[e,t]of Object.entries(a))n[t]=Number.parseInt(e);function s(e,t="utf-8"){switch(t.toLowerCase()){case"utf-8":case"utf8":return void 0!==globalThis.TextDecoder?new globalThis.TextDecoder("utf-8").decode(e):function(e){let t="",i=0;for(;i<e.length;){const r=e[i++];if(r<128)t+=String.fromCharCode(r);else if(r<224){const a=63&e[i++];t+=String.fromCharCode((31&r)<<6|a)}else if(r<240){const a=63&e[i++],n=63&e[i++];t+=String.fromCharCode((15&r)<<12|a<<6|n)}else{let a=(7&r)<<18|(63&e[i++])<<12|(63&e[i++])<<6|63&e[i++];a-=65536,t+=String.fromCharCode(55296+(a>>10&1023),56320+(1023&a))}}return t}(e);case"utf-16le":return function(e){let t="";for(let i=0;i<e.length;i+=2)t+=String.fromCharCode(e[i]|e[i+1]<<8);return t}(e);case"ascii":return function(e){return String.fromCharCode(...e.map(e=>127&e))}(e);case"latin1":case"iso-8859-1":return function(e){return String.fromCharCode(...e)}(e);case"windows-1252":return function(e){let t="";for(const i of e)t+=i>=128&&i<=159&&a[i]?a[i]:String.fromCharCode(i);return t}(e);default:throw new RangeError(`Encoding '${t}' not supported`)}}function o(e){return new DataView(e.buffer,e.byteOffset)}const c={len:1,get:(e,t)=>o(e).getUint8(t),put:(e,t,i)=>(o(e).setUint8(t,i),t+1)},u={len:2,get:(e,t)=>o(e).getUint16(t,!0),put:(e,t,i)=>(o(e).setUint16(t,i,!0),t+2)},l={len:2,get:(e,t)=>o(e).getUint16(t),put:(e,t,i)=>(o(e).setUint16(t,i),t+2)},m={len:3,get(e,t){const i=o(e);return i.getUint8(t)+(i.getUint16(t+1,!0)<<8)},put(e,t,i){const r=o(e);return r.setUint8(t,255&i),r.setUint16(t+1,i>>8,!0),t+3}},p={len:3,get(e,t){const i=o(e);return(i.getUint16(t)<<8)+i.getUint8(t+2)},put(e,t,i){const r=o(e);return r.setUint16(t,i>>8),r.setUint8(t+2,255&i),t+3}},d={len:4,get:(e,t)=>o(e).getUint32(t,!0),put:(e,t,i)=>(o(e).setUint32(t,i,!0),t+4)},f={len:4,get:(e,t)=>o(e).getUint32(t),put:(e,t,i)=>(o(e).setUint32(t,i),t+4)},h={len:1,get:(e,t)=>o(e).getInt8(t),put:(e,t,i)=>(o(e).setInt8(t,i),t+1)},g={len:2,get:(e,t)=>o(e).getInt16(t),put:(e,t,i)=>(o(e).setInt16(t,i),t+2)},T={len:2,get:(e,t)=>o(e).getInt16(t,!0),put:(e,t,i)=>(o(e).setInt16(t,i,!0),t+2)},b={len:3,get(e,t){const i=m.get(e,t);return i>8388607?i-16777216:i},put(e,t,i){const r=o(e);return r.setUint8(t,255&i),r.setUint16(t+1,i>>8,!0),t+3}},y={len:3,get(e,t){const i=p.get(e,t);return i>8388607?i-16777216:i},put(e,t,i){const r=o(e);return r.setUint16(t,i>>8),r.setUint8(t+2,255&i),t+3}},k={len:4,get:(e,t)=>o(e).getInt32(t),put:(e,t,i)=>(o(e).setInt32(t,i),t+4)},w={len:4,get:(e,t)=>o(e).getInt32(t,!0),put:(e,t,i)=>(o(e).setInt32(t,i,!0),t+4)},v={len:8,get:(e,t)=>o(e).getBigUint64(t,!0),put:(e,t,i)=>(o(e).setBigUint64(t,i,!0),t+8)},x={len:8,get:(e,t)=>o(e).getBigInt64(t,!0),put:(e,t,i)=>(o(e).setBigInt64(t,i,!0),t+8)},I={len:8,get:(e,t)=>o(e).getBigUint64(t),put:(e,t,i)=>(o(e).setBigUint64(t,i),t+8)},S={len:8,get:(e,t)=>o(e).getBigInt64(t),put:(e,t,i)=>(o(e).setBigInt64(t,i),t+8)},A={len:2,get(e,t){return r.L(e,t,!1,10,this.len)},put(e,t,i){return r.M(e,i,t,!1,10,this.len),t+this.len}},E={len:2,get(e,t){return r.L(e,t,!0,10,this.len)},put(e,t,i){return r.M(e,i,t,!0,10,this.len),t+this.len}},C={len:4,get:(e,t)=>o(e).getFloat32(t),put:(e,t,i)=>(o(e).setFloat32(t,i),t+4)},_={len:4,get:(e,t)=>o(e).getFloat32(t,!0),put:(e,t,i)=>(o(e).setFloat32(t,i,!0),t+4)},M={len:8,get:(e,t)=>o(e).getFloat64(t),put:(e,t,i)=>(o(e).setFloat64(t,i),t+8)},R={len:8,get:(e,t)=>o(e).getFloat64(t,!0),put:(e,t,i)=>(o(e).setFloat64(t,i,!0),t+8)},z={len:10,get(e,t){return r.L(e,t,!1,63,this.len)},put(e,t,i){return r.M(e,i,t,!1,63,this.len),t+this.len}},N={len:10,get(e,t){return r.L(e,t,!0,63,this.len)},put(e,t,i){return r.M(e,i,t,!0,63,this.len),t+this.len}};class L{constructor(e){this.len=e}get(e,t){}}class B{constructor(e){this.len=e}get(e,t){return e.subarray(t,t+this.len)}}class U{constructor(e,t){this.len=e,this.encoding=t}get(e,t=0){return s(e.subarray(t,t+this.len),this.encoding)}}class O extends U{constructor(e){super(e,"windows-1252")}}},68:(e,t,i)=>{"use strict";i.d(t,{e:()=>o});var r=i(74),a=i(790),n=i(453);const s=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/,o={len:4,get:(e,t)=>{const i=(0,r.c)(e.subarray(t,t+o.len),"latin1");if(!i.match(s))throw new n.gP(`FourCC contains invalid characters: ${a.DY(i)} "${i}"`);return i},put:(e,t,i)=>{const a=(0,r.I)(i,"latin1");if(4!==a.length)throw new n.nK("Invalid length");return e.set(a,t),t+4}}},74:(e,t,i)=>{"use strict";i.d(t,{I:()=>s,c:()=>n});const r={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},a={};for(const[e,t]of Object.entries(r))a[t]=Number.parseInt(e);function n(e,t="utf-8"){switch(t.toLowerCase()){case"utf-8":case"utf8":return void 0!==globalThis.TextDecoder?new globalThis.TextDecoder("utf-8").decode(e):function(e){let t="",i=0;for(;i<e.length;){const r=e[i++];if(r<128)t+=String.fromCharCode(r);else if(r<224){const a=63&e[i++];t+=String.fromCharCode((31&r)<<6|a)}else if(r<240){const a=63&e[i++],n=63&e[i++];t+=String.fromCharCode((15&r)<<12|a<<6|n)}else{let a=(7&r)<<18|(63&e[i++])<<12|(63&e[i++])<<6|63&e[i++];a-=65536,t+=String.fromCharCode(55296+(a>>10&1023),56320+(1023&a))}}return t}(e);case"utf-16le":return function(e){let t="";for(let i=0;i<e.length;i+=2)t+=String.fromCharCode(e[i]|e[i+1]<<8);return t}(e);case"ascii":return function(e){return String.fromCharCode(...e.map(e=>127&e))}(e);case"latin1":case"iso-8859-1":return function(e){return String.fromCharCode(...e)}(e);case"windows-1252":return function(e){let t="";for(const i of e)i>=128&&i<=159&&r[i]?t+=r[i]:t+=String.fromCharCode(i);return t}(e);default:throw new RangeError(`Encoding '${t}' not supported`)}}function s(e="",t="utf-8"){switch(t.toLowerCase()){case"utf-8":case"utf8":return void 0!==globalThis.TextEncoder?(new globalThis.TextEncoder).encode(e):function(e){const t=[];for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<65536?t.push(224|r>>12,128|r>>6&63,128|63&r):t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}return new Uint8Array(t)}(e);case"utf-16le":return function(e){const t=new Uint8Array(2*e.length);for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);t[2*i]=255&r,t[2*i+1]=r>>8}return t}(e);case"ascii":return i=e,new Uint8Array([...i].map(e=>127&e.charCodeAt(0)));case"latin1":case"iso-8859-1":return function(e){return new Uint8Array([...e].map(e=>255&e.charCodeAt(0)))}(e);case"windows-1252":return function(e){return new Uint8Array([...e].map(e=>{const t=e.charCodeAt(0);return t<=255?t:void 0!==a[e]?a[e]:63}))}(e);default:throw new RangeError(`Encoding '${t}' not supported`)}var i}},142:(e,t,i)=>{"use strict";i.r(t),i.d(t,{APEv2Parser:()=>A,ApeContentError:()=>I,tryParseApeHeader:()=>S});var r=i(288),a=i(959),n=i(4),s=i(790),o=i(585),c=i(68);const u=0,l=1,m=2,p=3,d={len:52,get:(e,t)=>({ID:c.e.get(e,t),version:n.UINT32_LE.get(e,t+4)/1e3,descriptorBytes:n.UINT32_LE.get(e,t+8),headerBytes:n.UINT32_LE.get(e,t+12),seekTableBytes:n.UINT32_LE.get(e,t+16),headerDataBytes:n.UINT32_LE.get(e,t+20),apeFrameDataBytes:n.UINT32_LE.get(e,t+24),apeFrameDataBytesHigh:n.UINT32_LE.get(e,t+28),terminatingDataBytes:n.UINT32_LE.get(e,t+32),fileMD5:new n.Uint8ArrayType(16).get(e,t+36)})},f={len:24,get:(e,t)=>({compressionLevel:n.UINT16_LE.get(e,t),formatFlags:n.UINT16_LE.get(e,t+2),blocksPerFrame:n.UINT32_LE.get(e,t+4),finalFrameBlocks:n.UINT32_LE.get(e,t+8),totalFrames:n.UINT32_LE.get(e,t+12),bitsPerSample:n.UINT16_LE.get(e,t+16),channel:n.UINT16_LE.get(e,t+18),sampleRate:n.UINT32_LE.get(e,t+20)})},h={len:32,get:(e,t)=>({ID:new n.StringType(8,"ascii").get(e,t),version:n.UINT32_LE.get(e,t+8),size:n.UINT32_LE.get(e,t+12),fields:n.UINT32_LE.get(e,t+16),flags:T(n.UINT32_LE.get(e,t+20))})},g={len:8,get:(e,t)=>({size:n.UINT32_LE.get(e,t),flags:T(n.UINT32_LE.get(e,t+4))})};function T(e){return{containsHeader:b(e,31),containsFooter:b(e,30),isHeader:b(e,29),readOnly:b(e,0),dataType:(6&e)>>1}}function b(e,t){return!!(e&1<<t)}var y=i(453),k=i(74);const w=r("music-metadata:parser:APEv2"),v="APEv2",x="APETAGEX";class I extends((0,y.fO)("APEv2")){}function S(e,t,i){return new A(e,t,i).tryParseApeHeader()}class A extends o.s{constructor(){super(...arguments),this.ape={}}static calculateDuration(e){let t=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return t+=e.finalFrameBlocks,t/e.sampleRate}static async findApeFooterOffset(e,t){const i=new Uint8Array(h.len),r=e.position;if(t<=h.len)w(`Offset is too small to read APE footer: offset=${t}`);else if(t>h.len){await e.readBuffer(i,{position:t-h.len}),e.setPosition(r);const a=h.get(i,0);if("APETAGEX"===a.ID)return a.flags.isHeader?w("APE Header found at offset="+(t-h.len)):(w("APE Footer found at offset="+(t-h.len)),t-=a.size),{footer:a,offset:t}}}static parseTagFooter(e,t,i){const r=h.get(t,t.length-h.len);if(r.ID!==x)throw new I("Unexpected APEv2 Footer ID preamble value");a.vY(t);return new A(e,a.vY(t),i).parseTags(r)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<h.len)return void w("No APEv2 header found, end-of-file reached");const e=await this.tokenizer.peekToken(h);if(e.ID===x)return await this.tokenizer.ignore(h.len),this.parseTags(e);if(w(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position,t=new Uint8Array(e);return await this.tokenizer.readBuffer(t),A.parseTagFooter(this.metadata,t,this.options)}}async parse(){const e=await this.tokenizer.readToken(d);if("MAC "!==e.ID)throw new I("Unexpected descriptor ID");this.ape.descriptor=e;const t=e.descriptorBytes-d.len,i=await(t>0?this.parseDescriptorExpansion(t):this.parseHeader());return this.metadata.setAudioOnly(),await this.tokenizer.ignore(i.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const t=new Uint8Array(256);let i=e.size-h.len;w(`Parse APE tags at offset=${this.tokenizer.position}, size=${i}`);for(let r=0;r<e.fields;r++){if(i<g.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-r} items remaining, but no more tag data to read.`);break}const a=await this.tokenizer.readToken(g);i-=g.len+a.size,await this.tokenizer.peekBuffer(t,{length:Math.min(t.length,i)});let o=s.sX(t,0,t.length);const c=await this.tokenizer.readToken(new n.StringType(o,"ascii"));switch(await this.tokenizer.ignore(1),i-=c.length+1,a.flags.dataType){case u:{const e=(await this.tokenizer.readToken(new n.StringType(a.size,"utf8"))).split(/\x00/g);await Promise.all(e.map(e=>this.metadata.addTag(v,c,e)));break}case l:if(this.options.skipCovers)await this.tokenizer.ignore(a.size);else{const e=new Uint8Array(a.size);await this.tokenizer.readBuffer(e),o=s.sX(e,0,e.length);const t=(0,k.c)(e.subarray(0,o),"utf-8"),i=e.subarray(o+1);await this.metadata.addTag(v,c,{description:t,data:i})}break;case m:w(`Ignore external info ${c}`),await this.tokenizer.ignore(a.size);break;case p:w(`Ignore external info ${c}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${c}"`),await this.tokenizer.ignore(a.size)}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(f);if(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",A.calculateDuration(e)),!this.ape.descriptor)throw new I("Missing APE descriptor");return{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}},198:(e,t,i)=>{"use strict";i.d(t,{Jp:()=>p,MW:()=>s,St:()=>c,YF:()=>m,aY:()=>d,n5:()=>n,nl:()=>l,sd:()=>o,yW:()=>u});var r=i(4),a=i(790);const n={0:"Other",1:"32x32 pixels 'file icon' (PNG only)",2:"Other file icon",3:"Cover (front)",4:"Cover (back)",5:"Leaflet page",6:"Media (e.g. label side of CD)",7:"Lead artist/lead performer/soloist",8:"Artist/performer",9:"Conductor",10:"Band/Orchestra",11:"Composer",12:"Lyricist/text writer",13:"Recording Location",14:"During recording",15:"During performance",16:"Movie/video screen capture",17:"A bright coloured fish",18:"Illustration",19:"Band/artist logotype",20:"Publisher/Studio logotype"},s={other:0,lyrics:1,text:2,movement_part:3,events:4,chord:5,trivia_pop:6},o={notSynchronized0:0,mpegFrameNumber:1,milliseconds:2},c={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},u={len:10,get:(e,t)=>({fileIdentifier:new r.StringType(3,"ascii").get(e,t),version:{major:r.INT8.get(e,t+3),revision:r.INT8.get(e,t+4)},flags:{unsynchronisation:a.mh(e,t+5,7),isExtendedHeader:a.mh(e,t+5,6),expIndicator:a.mh(e,t+5,5),footer:a.mh(e,t+5,4)},size:c.get(e,t+6)})},l={len:10,get:(e,t)=>({size:r.UINT32_BE.get(e,t),extendedFlags:r.UINT16_BE.get(e,t+4),sizeOfPadding:r.UINT32_BE.get(e,t+6),crcDataPresent:a.mh(e,t+4,31)})},m={len:1,get:(e,t)=>{switch(e[t]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf-16le",bom:!0};case 2:return{encoding:"utf-16le",bom:!1};default:return{encoding:"utf8",bom:!1}}}},p={len:4,get:(e,t)=>({encoding:m.get(e,t),language:new r.StringType(3,"latin1").get(e,t+1)})},d={len:6,get:(e,t)=>{const i=p.get(e,t);return{encoding:i.encoding,language:i.language,timeStampFormat:r.UINT8.get(e,t+4),contentType:r.UINT8.get(e,t+5)}}}},288:(e,t,i)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;t.splice(1,0,i,"color: inherit");let r=0,a=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(a=r))}),t.splice(a,0,i)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=i(783)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},453:(e,t,i)=>{"use strict";i.d(t,{U9:()=>r,e6:()=>a,fO:()=>u,gP:()=>o,nK:()=>c,qq:()=>n});const r=e=>class extends Error{constructor(t){super(t),this.name=e}};class a extends(r("CouldNotDetermineFileTypeError")){}class n extends(r("UnsupportedFileTypeError")){}class s extends(r("UnexpectedFileContentError")){constructor(e,t){super(t),this.fileType=e}toString(){return`${this.name} (FileType: ${this.fileType}): ${this.message}`}}class o extends(r("FieldDecodingError")){}class c extends(r("InternalParserError")){}const u=e=>class extends s{constructor(t){super(e,t)}}},486:(e,t)=>{"use strict";var i=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,r=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,a=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,n=/\\([\u000b\u0020-\u00ff])/g,s=/([\\"])/g,o=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function c(e){var t=String(e);if(a.test(t))return t;if(t.length>0&&!r.test(t))throw new TypeError("invalid parameter value");return'"'+t.replace(s,"\\$1")+'"'}function u(e){this.parameters=Object.create(null),this.type=e}t.format=function(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.parameters,i=e.type;if(!i||!o.test(i))throw new TypeError("invalid type");var r=i;if(t&&"object"==typeof t)for(var n,s=Object.keys(t).sort(),u=0;u<s.length;u++){if(n=s[u],!a.test(n))throw new TypeError("invalid parameter name");r+="; "+n+"="+c(t[n])}return r},t.parse=function(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?function(e){var t;"function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]);if("string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var r=t.indexOf(";"),a=-1!==r?t.slice(0,r).trim():t.trim();if(!o.test(a))throw new TypeError("invalid media type");var s=new u(a.toLowerCase());if(-1!==r){var c,l,m;for(i.lastIndex=r;l=i.exec(t);){if(l.index!==r)throw new TypeError("invalid parameter format");r+=l[0].length,c=l[1].toLowerCase(),34===(m=l[2]).charCodeAt(0)&&-1!==(m=m.slice(1,-1)).indexOf("\\")&&(m=m.replace(n,"$1")),s.parameters[c]=m}if(r!==t.length)throw new TypeError("invalid parameter format")}return s}},506:(e,t)=>{t.L=function(e,t,i,r,a){var n,s,o=8*a-r-1,c=(1<<o)-1,u=c>>1,l=-7,m=i?a-1:0,p=i?-1:1,d=e[t+m];for(m+=p,n=d&(1<<-l)-1,d>>=-l,l+=o;l>0;n=256*n+e[t+m],m+=p,l-=8);for(s=n&(1<<-l)-1,n>>=-l,l+=r;l>0;s=256*s+e[t+m],m+=p,l-=8);if(0===n)n=1-u;else{if(n===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),n-=u}return(d?-1:1)*s*Math.pow(2,n-r)},t.M=function(e,t,i,r,a,n){var s,o,c,u=8*n-a-1,l=(1<<u)-1,m=l>>1,p=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:n-1,f=r?1:-1,h=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+m>=1?p/c:p*Math.pow(2,1-m))*c>=2&&(s++,c/=2),s+m>=l?(o=0,s=l):s+m>=1?(o=(t*c-1)*Math.pow(2,a),s+=m):(o=t*Math.pow(2,m-1)*Math.pow(2,a),s=0));a>=8;e[i+d]=255&o,d+=f,o/=256,a-=8);for(s=s<<a|o,u+=a;u>0;e[i+d]=255&s,d+=f,s/=256,u-=8);e[i+d-f]|=128*h}},525:(e,t)=>{"use strict";var i=/^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/,r=/^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/,a=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;function n(e,t,i){this.type=e,this.subtype=t,this.suffix=i}t.qg=function(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");var t=a.exec(e.toLowerCase());if(!t)throw new TypeError("invalid media type");var i,r=t[1],s=t[2],o=s.lastIndexOf("+");-1!==o&&(i=s.substr(o+1),s=s.substr(0,o));return new n(r,s,i)}},585:(e,t,i)=>{"use strict";i.d(t,{s:()=>r});class r{constructor(e,t,i){this.metadata=e,this.tokenizer=t,this.options=i}}},738:(e,t,i)=>{"use strict";i.d(t,{S:()=>a,vQ:()=>n,yK:()=>r});const r={10:"shot",20:"scene",30:"track",40:"part",50:"album",60:"edition",70:"collection"},a={video:1,audio:2,complex:3,logo:4,subtitle:17,button:18,control:32},n={[a.video]:"video",[a.audio]:"audio",[a.complex]:"complex",[a.logo]:"logo",[a.subtitle]:"subtitle",[a.button]:"button",[a.control]:"control"}},783:(e,t,i)=>{e.exports=function(e){function t(e){let i,a,n,s=null;function o(...e){if(!o.enabled)return;const r=o,a=Number(new Date),n=a-(i||a);r.diff=n,r.prev=i,r.curr=a,i=a,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(i,a)=>{if("%%"===i)return"%";s++;const n=t.formatters[a];if("function"==typeof n){const t=e[s];i=n.call(r,t),e.splice(s,1),s--}return i}),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=r,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(a!==t.namespaces&&(a=t.namespaces,n=t.enabled(e)),n),set:e=>{s=e}}),"function"==typeof t.init&&t.init(o),o}function r(e,i){const r=t(this.namespace+(void 0===i?":":i)+e);return r.log=this.log,r}function a(e,t){let i=0,r=0,a=-1,n=0;for(;i<e.length;)if(r<t.length&&(t[r]===e[i]||"*"===t[r]))"*"===t[r]?(a=r,n=i,r++):(i++,r++);else{if(-1===a)return!1;r=a+1,n++,i=n}for(;r<t.length&&"*"===t[r];)r++;return r===t.length}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const i=("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const e of i)"-"===e[0]?t.skips.push(e.slice(1)):t.names.push(e)},t.enabled=function(e){for(const i of t.skips)if(a(e,i))return!1;for(const i of t.names)if(a(e,i))return!0;return!1},t.humanize=i(854),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(i=>{t[i]=e[i]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let i=0;for(let t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return t.colors[Math.abs(i)%t.colors.length]},t.enable(t.load()),t}},790:(e,t,i)=>{"use strict";i.d(t,{DY:()=>d,F6:()=>l,cD:()=>p,f5:()=>m,ku:()=>h,mh:()=>s,qW:()=>c,sX:()=>o,sc:()=>u,th:()=>f});var r=i(4),a=i(453),n=i(946);function s(e,t,i){return!!(e[t]&1<<i)}function o(e,t,i,r){let a=t;if("utf-16le"===r){for(;0!==e[a]||0!==e[a+1];){if(a>=i)return i;a+=2}return a}for(;0!==e[a];){if(a>=i)return i;a++}return a}function c(e){const t=e.indexOf("\0");return-1===t?e:e.substr(0,t)}function u(e,t){if(255===e[0]&&254===e[1])return u(e.subarray(2),t);if("utf-16le"===t&&254===e[0]&&255===e[1]){if(1&e.length)throw new a.gP("Expected even number of octets for 16-bit unicode string");return u(function(e){const t=e.length;if(1&t)throw new a.gP("Buffer length must be even");for(let i=0;i<t;i+=2){const t=e[i];e[i]=e[i+1],e[i+1]=t}return e}(e),t)}return new r.StringType(e.length,t).get(e,0)}function l(e){return e=(e=e.replace(/^\x00+/g,"")).replace(/\x00+$/g,"")}function m(e,t,i,r){const a=i%8;let n=e[t+~~(i/8)];n&=255>>a;const s=8-a,o=r-s;return o<0?n>>=8-a-r:o>0&&(n<<=o,n|=m(e,t,i+s,o)),n}function p(e,t,i){return 1===m(e,t,i,1)}function d(e){const t=[];for(let i=0,r=e.length;i<r;i++){const r=Number(e.charCodeAt(i)).toString(16);t.push(1===r.length?`0${r}`:r)}return t.join(" ")}function f(e){const t=e.split(" ").map(e=>e.trim().toLowerCase());if(t.length>=1){const e=Number.parseFloat(t[0]);return 2===t.length&&"db"===t[1]?{dB:e,ratio:(r=e,10**(r/10))}:{dB:(i=e,10*Math.log10(i)),ratio:e}}var i,r}function h(e){if(0===e.length)throw new Error("decodeUintBE: empty Uint8Array");const t=new DataView(e.buffer,e.byteOffset,e.byteLength);return(0,n.AW)(t)}},854:e=>{var t=1e3,i=60*t,r=60*i,a=24*r,n=7*a,s=365.25*a;function o(e,t,i,r){var a=t>=1.5*i;return Math.round(e/i)+" "+r+(a?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!o)return;var c=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*n;case"days":case"day":case"d":return c*a;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*i;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var n=Math.abs(e);if(n>=a)return o(e,n,a,"day");if(n>=r)return o(e,n,r,"hour");if(n>=i)return o(e,n,i,"minute");if(n>=t)return o(e,n,t,"second");return e+" ms"}(e):function(e){var n=Math.abs(e);if(n>=a)return Math.round(e/a)+"d";if(n>=r)return Math.round(e/r)+"h";if(n>=i)return Math.round(e/i)+"m";if(n>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},946:(e,t,i)=>{"use strict";i.d(t,{AS:()=>p,AW:()=>d,EY:()=>l});const r=Object.prototype.toString,a="[object Uint8Array]";function n(e,t,i){return!!e&&(e.constructor===t||r.call(e)===i)}function s(e){return n(e,Uint8Array,a)}function o(e){if(!s(e))throw new TypeError(`Expected \`Uint8Array\`, got \`${typeof e}\``)}new globalThis.TextDecoder("utf8");function c(e){if("string"!=typeof e)throw new TypeError(`Expected \`string\`, got \`${typeof e}\``)}new globalThis.TextEncoder;const u=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function l(e){o(e);let t="";for(let i=0;i<e.length;i++)t+=u[e[i]];return t}const m={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function p(e){if(c(e),e.length%2!=0)throw new Error("Invalid Hex string length.");const t=e.length/2,i=new Uint8Array(t);for(let r=0;r<t;r++){const t=m[e[2*r]],a=m[e[2*r+1]];if(void 0===t||void 0===a)throw new Error("Invalid Hex character encountered at position "+2*r);i[r]=t<<4|a}return i}function d(e){const{byteLength:t}=e;return 6===t?e.getUint16(0)*2**32+e.getUint32(2):5===t?e.getUint8(0)*2**32+e.getUint32(1):4===t?e.getUint32(0):3===t?65536*e.getUint8(0)+e.getUint16(1):2===t?e.getUint16(0):1===t?e.getUint8(0):void 0}},959:(e,t,i)=>{"use strict";i.d(t,{d1:()=>r,_F:()=>h,vY:()=>f,Xx:()=>d});class r extends Error{constructor(){super("End-Of-Stream"),this.name="EndOfStreamError"}}class a extends Error{constructor(e="The operation was aborted"){super(e),this.name="AbortError"}}class n{constructor(){this.endOfStream=!1,this.interrupted=!1,this.peekQueue=[]}async peek(e,t=!1){const i=await this.read(e,t);return this.peekQueue.push(e.subarray(0,i)),i}async read(e,t=!1){if(0===e.length)return 0;let i=this.readFromPeekBuffer(e);if(this.endOfStream||(i+=await this.readRemainderFromStream(e.subarray(i),t)),0===i&&!t)throw new r;return i}readFromPeekBuffer(e){let t=e.length,i=0;for(;this.peekQueue.length>0&&t>0;){const r=this.peekQueue.pop();if(!r)throw new Error("peekData should be defined");const a=Math.min(r.length,t);e.set(r.subarray(0,a),i),i+=a,t-=a,a<r.length&&this.peekQueue.push(r.subarray(a))}return i}async readRemainderFromStream(e,t){let i=0;for(;i<e.length&&!this.endOfStream;){if(this.interrupted)throw new a;const r=await this.readFromStream(e.subarray(i),t);if(0===r)break;i+=r}if(!t&&i<e.length)throw new r;return i}}class s extends n{constructor(e){super(),this.reader=e}async abort(){return this.close()}async close(){this.reader.releaseLock()}}class o extends s{async readFromStream(e,t){if(0===e.length)return 0;const i=await this.reader.read(new Uint8Array(e.length),{min:t?void 0:e.length});return i.done&&(this.endOfStream=i.done),i.value?(e.set(i.value),i.value.length):0}}class c extends n{constructor(e){super(),this.reader=e,this.buffer=null}writeChunk(e,t){const i=Math.min(t.length,e.length);return e.set(t.subarray(0,i)),i<t.length?this.buffer=t.subarray(i):this.buffer=null,i}async readFromStream(e,t){if(0===e.length)return 0;let i=0;for(this.buffer&&(i+=this.writeChunk(e,this.buffer));i<e.length&&!this.endOfStream;){const t=await this.reader.read();if(t.done){this.endOfStream=!0;break}t.value&&(i+=this.writeChunk(e.subarray(i),t.value))}if(!t&&0===i&&this.endOfStream)throw new r;return i}abort(){return this.interrupted=!0,this.reader.cancel()}async close(){await this.abort(),this.reader.releaseLock()}}class u{constructor(e){this.numBuffer=new Uint8Array(8),this.position=0,this.onClose=e?.onClose,e?.abortSignal&&e.abortSignal.addEventListener("abort",()=>{this.abort()})}async readToken(e,t=this.position){const i=new Uint8Array(e.len);if(await this.readBuffer(i,{position:t})<e.len)throw new r;return e.get(i,0)}async peekToken(e,t=this.position){const i=new Uint8Array(e.len);if(await this.peekBuffer(i,{position:t})<e.len)throw new r;return e.get(i,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new r;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new r;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){await this.abort(),await(this.onClose?.())}normalizeOptions(e,t){if(!this.supportsRandomAccess()&&t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return{mayBeLess:!1,offset:0,length:e.length,position:this.position,...t}}abort(){return Promise.resolve()}}class l extends u{constructor(e,t){super(t),this.streamReader=e,this.fileInfo=t?.fileInfo??{}}async readBuffer(e,t){const i=this.normalizeOptions(e,t),a=i.position-this.position;if(a>0)return await this.ignore(a),this.readBuffer(e,t);if(a<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===i.length)return 0;const n=await this.streamReader.read(e.subarray(0,i.length),i.mayBeLess);if(this.position+=n,(!t||!t.mayBeLess)&&n<i.length)throw new r;return n}async peekBuffer(e,t){const i=this.normalizeOptions(e,t);let a=0;if(i.position){const t=i.position-this.position;if(t>0){const r=new Uint8Array(i.length+t);return a=await this.peekBuffer(r,{mayBeLess:i.mayBeLess}),e.set(r.subarray(t)),a-t}if(t<0)throw new Error("Cannot peek from a negative offset in a stream")}if(i.length>0){try{a=await this.streamReader.peek(e.subarray(0,i.length),i.mayBeLess)}catch(e){if(t?.mayBeLess&&e instanceof r)return 0;throw e}if(!i.mayBeLess&&a<i.length)throw new r}return a}async ignore(e){const t=Math.min(256e3,e),i=new Uint8Array(t);let r=0;for(;r<e;){const a=e-r,n=await this.readBuffer(i,{length:Math.min(t,a)});if(n<0)return n;r+=n}return r}abort(){return this.streamReader.abort()}async close(){return this.streamReader.close()}supportsRandomAccess(){return!1}}class m extends u{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo={...t?.fileInfo??{},size:e.length}}async readBuffer(e,t){t?.position&&(this.position=t.position);const i=await this.peekBuffer(e,t);return this.position+=i,i}async peekBuffer(e,t){const i=this.normalizeOptions(e,t),a=Math.min(this.uint8Array.length-i.position,i.length);if(!i.mayBeLess&&a<i.length)throw new r;return e.set(this.uint8Array.subarray(i.position,i.position+a)),a}close(){return super.close()}supportsRandomAccess(){return!0}setPosition(e){this.position=e}}class p extends u{constructor(e,t){super(t),this.blob=e,this.fileInfo={...t?.fileInfo??{},size:e.size,mimeType:e.type}}async readBuffer(e,t){t?.position&&(this.position=t.position);const i=await this.peekBuffer(e,t);return this.position+=i,i}async peekBuffer(e,t){const i=this.normalizeOptions(e,t),a=Math.min(this.blob.size-i.position,i.length);if(!i.mayBeLess&&a<i.length)throw new r;const n=await this.blob.slice(i.position,i.position+a).arrayBuffer();return e.set(new Uint8Array(n)),a}close(){return super.close()}supportsRandomAccess(){return!0}setPosition(e){this.position=e}}function d(e,t){const i=function(e){try{const t=e.getReader({mode:"byob"});return t instanceof ReadableStreamDefaultReader?new c(t):new o(t)}catch(t){if(t instanceof TypeError)return new c(e.getReader());throw t}}(e),r=t??{},a=r.onClose;return r.onClose=async()=>{if(await i.close(),a)return a()},new l(i,r)}function f(e,t){return new m(e,t)}function h(e,t){return new p(e,t)}},972:(e,t,i)=>{"use strict";i.d(t,{Bn:()=>d,jR:()=>l,zc:()=>f});var r=i(288),a=i(4),n=i(790),s=i(585),o=i(142),c=i(74);const u=r("music-metadata:parser:ID3v1"),l=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"],m={len:128,get:(e,t)=>{const i=new p(3).get(e,t);return"TAG"===i?{header:i,title:new p(30).get(e,t+3),artist:new p(30).get(e,t+33),album:new p(30).get(e,t+63),year:new p(4).get(e,t+93),comment:new p(28).get(e,t+97),zeroByte:a.UINT8.get(e,t+127),track:a.UINT8.get(e,t+126),genre:a.UINT8.get(e,t+127)}:null}};class p{constructor(e){this.len=e,this.stringType=new a.StringType(e,"latin1")}get(e,t){let i=this.stringType.get(e,t);return i=n.qW(i),i=i.trim(),i.length>0?i:void 0}}class d extends s.s{constructor(e,t,i){super(e,t,i),this.apeHeader=i.apeHeader}static getGenre(e){if(e<l.length)return l[e]}async parse(){if(!this.tokenizer.fileInfo.size)return void u("Skip checking for ID3v1 because the file-size is unknown");if(this.apeHeader){this.tokenizer.ignore(this.apeHeader.offset-this.tokenizer.position);const e=new o.APEv2Parser(this.metadata,this.tokenizer,this.options);await e.parseTags(this.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-m.len;if(this.tokenizer.position>e)return void u("Already consumed the last 128 bytes");const t=await this.tokenizer.readToken(m,e);if(t){u("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-m.len);const e=["title","artist","album","comment","track","year"];for(const i of e)t[i]&&""!==t[i]&&await this.addTag(i,t[i]);const i=d.getGenre(t.genre);i&&await this.addTag("genre",i)}else u("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-m.len)}async addTag(e,t){await this.metadata.addTag("ID3v1",e,t)}}async function f(e){if(e.fileInfo.size>=128){const t=new Uint8Array(3),i=e.position;return await e.readBuffer(t,{position:e.fileInfo.size-128}),e.setPosition(i),"TAG"===(0,c.c)(t,"latin1")}return!1}}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,a),n.exports}a.m=i,a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,i)=>(a.f[i](e,t),t),[])),a.u=e=>e+".music-metadata.bundle.js",a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="meta:",a.l=(i,r,n,s)=>{if(e[i])e[i].push(r);else{var o,c;if(void 0!==n)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var m=u[l];if(m.getAttribute("src")==i||m.getAttribute("data-webpack")==t+n){o=m;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",t+n),o.src=i),e[i]=[r];var p=(t,r)=>{o.onerror=o.onload=null,clearTimeout(d);var a=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(r)),t)return t(r)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),c&&document.head.appendChild(o)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="",(()=>{var e={792:0};a.f.j=(t,i)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var n=new Promise((i,a)=>r=e[t]=[i,a]);i.push(r[2]=n);var s=a.p+a.u(t),o=new Error;a.l(s,i=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var n=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+n+": "+s+")",o.name="ChunkLoadError",o.type=n,o.request=s,r[1](o)}},"chunk-"+t,t)}};var t=(t,i)=>{var r,n,[s,o,c]=i,u=0;if(s.some(t=>0!==e[t])){for(r in o)a.o(o,r)&&(a.m[r]=o[r]);if(c)c(a)}for(t&&t(i);u<s.length;u++)n=s[u],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0},i=self.webpackChunkmeta=self.webpackChunkmeta||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var n={};(()=>{"use strict";a.r(n),a.d(n,{CouldNotDetermineFileTypeError:()=>Pe.e6,FieldDecodingError:()=>Pe.gP,InternalParserError:()=>Pe.nK,LyricsContentType:()=>Fe.MW,TimestampFormat:()=>Fe.sd,UnsupportedFileTypeError:()=>Pe.qq,getSupportedMimeTypes:()=>yt,makeParseError:()=>Pe.U9,makeUnexpectedFileContentError:()=>Pe.fO,orderTags:()=>dt,parseBlob:()=>ut,parseBuffer:()=>mt,parseFile:()=>Tt,parseFromTokenizer:()=>pt,parseStream:()=>bt,parseWebStream:()=>lt,ratingToStars:()=>ft,scanAppendingHeaders:()=>gt,selectCover:()=>ht});var e=a(959),t=a(4),i=Uint8Array,r=Uint16Array,s=Int32Array,o=new i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c=new i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),u=new i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=function(e,t){for(var i=new r(31),a=0;a<31;++a)i[a]=t+=1<<e[a-1];var n=new s(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)n[o]=o-i[a]<<5|a;return{b:i,r:n}},m=l(o,2),p=m.b,d=m.r;p[28]=258,d[258]=28;for(var f=l(c,0),h=f.b,g=(f.r,new r(32768)),T=0;T<32768;++T){var b=(43690&T)>>1|(21845&T)<<1;b=(61680&(b=(52428&b)>>2|(13107&b)<<2))>>4|(3855&b)<<4,g[T]=((65280&b)>>8|(255&b)<<8)>>1}var y=function(e,t,i){for(var a=e.length,n=0,s=new r(t);n<a;++n)e[n]&&++s[e[n]-1];var o,c=new r(t);for(n=1;n<t;++n)c[n]=c[n-1]+s[n-1]<<1;if(i){o=new r(1<<t);var u=15-t;for(n=0;n<a;++n)if(e[n])for(var l=n<<4|e[n],m=t-e[n],p=c[e[n]-1]++<<m,d=p|(1<<m)-1;p<=d;++p)o[g[p]>>u]=l}else for(o=new r(a),n=0;n<a;++n)e[n]&&(o[n]=g[c[e[n]-1]++]>>15-e[n]);return o},k=new i(288);for(T=0;T<144;++T)k[T]=8;for(T=144;T<256;++T)k[T]=9;for(T=256;T<280;++T)k[T]=7;for(T=280;T<288;++T)k[T]=8;var w=new i(32);for(T=0;T<32;++T)w[T]=5;var v=y(k,9,1),x=y(w,5,1),I=function(e){for(var t=e[0],i=1;i<e.length;++i)e[i]>t&&(t=e[i]);return t},S=function(e,t,i){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&i},A=function(e,t){var i=t/8|0;return(e[i]|e[i+1]<<8|e[i+2]<<16)>>(7&t)},E=function(e){return(e+7)/8|0},C=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new i(e.subarray(t,r))},_=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],M=function(e,t,i){var r=new Error(t||_[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,M),!i)throw r;return r},R=function(e,t,r,a){var n=e.length,s=a?a.length:0;if(!n||t.f&&!t.l)return r||new i(0);var l=!r,m=l||2!=t.i,d=t.i;l&&(r=new i(3*n));var f=function(e){var t=r.length;if(e>t){var a=new i(Math.max(2*t,e));a.set(r),r=a}},g=t.f||0,T=t.p||0,b=t.b||0,k=t.l,w=t.d,_=t.m,R=t.n,z=8*n;do{if(!k){g=S(e,T,1);var N=S(e,T+1,3);if(T+=3,!N){var L=e[($=E(T)+4)-4]|e[$-3]<<8,B=$+L;if(B>n){d&&M(0);break}m&&f(b+L),r.set(e.subarray($,B),b),t.b=b+=L,t.p=T=8*B,t.f=g;continue}if(1==N)k=v,w=x,_=9,R=5;else if(2==N){var U=S(e,T,31)+257,O=S(e,T+10,15)+4,P=U+S(e,T+5,31)+1;T+=14;for(var D=new i(P),F=new i(19),X=0;X<O;++X)F[u[X]]=S(e,T+3*X,7);T+=3*O;var G=I(F),W=(1<<G)-1,j=y(F,G,1);for(X=0;X<P;){var $,q=j[S(e,T,W)];if(T+=15&q,($=q>>4)<16)D[X++]=$;else{var H=0,Y=0;for(16==$?(Y=3+S(e,T,3),T+=2,H=D[X-1]):17==$?(Y=3+S(e,T,7),T+=3):18==$&&(Y=11+S(e,T,127),T+=7);Y--;)D[X++]=H}}var Z=D.subarray(0,U),K=D.subarray(U);_=I(Z),R=I(K),k=y(Z,_,1),w=y(K,R,1)}else M(1);if(T>z){d&&M(0);break}}m&&f(b+131072);for(var V=(1<<_)-1,J=(1<<R)-1,Q=T;;Q=T){var ee=(H=k[A(e,T)&V])>>4;if((T+=15&H)>z){d&&M(0);break}if(H||M(2),ee<256)r[b++]=ee;else{if(256==ee){Q=T,k=null;break}var te=ee-254;if(ee>264){var ie=o[X=ee-257];te=S(e,T,(1<<ie)-1)+p[X],T+=ie}var re=w[A(e,T)&J],ae=re>>4;re||M(3),T+=15&re;K=h[ae];if(ae>3){ie=c[ae];K+=A(e,T)&(1<<ie)-1,T+=ie}if(T>z){d&&M(0);break}m&&f(b+131072);var ne=b+te;if(b<K){var se=s-K,oe=Math.min(K,ne);for(se+b<0&&M(3);b<oe;++b)r[b]=a[se+b]}for(;b<ne;++b)r[b]=r[b-K]}}t.l=k,t.p=Q,t.b=b,t.f=g,k&&(g=1,t.m=_,t.d=w,t.n=R)}while(!g);return b!=r.length&&l?C(r,0,b):r.subarray(0,b)},z=new i(0),N=function(e){31==e[0]&&139==e[1]&&8==e[2]||M(6,"invalid gzip data");var t=e[3],i=10;4&t&&(i+=2+(e[10]|e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[i++]);return i+(2&t)},L=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},B=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&M(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&M(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)};function U(e,t){return R(e,{i:2},t&&t.out,t&&t.dictionary)}function O(e,t){var r=N(e);return r+8>e.length&&M(6,"invalid gzip data"),R(e.subarray(r,-8),{i:2},t&&t.out||new i(L(e)),t&&t.dictionary)}function P(e,t){return R(e.subarray(B(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var D="undefined"!=typeof TextDecoder&&new TextDecoder;try{D.decode(z,{stream:!0})}catch(e){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var F=a(288);const X=67324752,G=134695760,W=33639248,j=101010256,$={get(e){t.UINT16_LE.get(e,6);return{signature:t.UINT32_LE.get(e,0),compressedSize:t.UINT32_LE.get(e,8),uncompressedSize:t.UINT32_LE.get(e,12)}},len:16},q={get(e){const i=t.UINT16_LE.get(e,6);return{signature:t.UINT32_LE.get(e,0),minVersion:t.UINT16_LE.get(e,4),dataDescriptor:!!(8&i),compressedMethod:t.UINT16_LE.get(e,8),compressedSize:t.UINT32_LE.get(e,18),uncompressedSize:t.UINT32_LE.get(e,22),filenameLength:t.UINT16_LE.get(e,26),extraFieldLength:t.UINT16_LE.get(e,28),filename:null}},len:30},H={get:e=>({signature:t.UINT32_LE.get(e,0),nrOfThisDisk:t.UINT16_LE.get(e,4),nrOfThisDiskWithTheStart:t.UINT16_LE.get(e,6),nrOfEntriesOnThisDisk:t.UINT16_LE.get(e,8),nrOfEntriesOfSize:t.UINT16_LE.get(e,10),sizeOfCd:t.UINT32_LE.get(e,12),offsetOfStartOfCd:t.UINT32_LE.get(e,16),zipFileCommentLength:t.UINT16_LE.get(e,20)}),len:22},Y={get(e){const i=t.UINT16_LE.get(e,8);return{signature:t.UINT32_LE.get(e,0),minVersion:t.UINT16_LE.get(e,6),dataDescriptor:!!(8&i),compressedMethod:t.UINT16_LE.get(e,10),compressedSize:t.UINT32_LE.get(e,20),uncompressedSize:t.UINT32_LE.get(e,24),filenameLength:t.UINT16_LE.get(e,28),extraFieldLength:t.UINT16_LE.get(e,30),fileCommentLength:t.UINT16_LE.get(e,32),relativeOffsetOfLocalHeader:t.UINT32_LE.get(e,42),filename:null}},len:46};function Z(e){const i=new Uint8Array(t.UINT32_LE.len);return t.UINT32_LE.put(i,0,e),i}const K=F("tokenizer:inflate"),V=262144,J=Z(G),Q=Z(j);class ee{constructor(e){this.tokenizer=e,this.syncBuffer=new Uint8Array(V)}async isZip(){return await this.peekSignature()===X}peekSignature(){return this.tokenizer.peekToken(t.UINT32_LE)}async findEndOfCentralDirectoryLocator(){const e=this.tokenizer,t=Math.min(16384,e.fileInfo.size),i=this.syncBuffer.subarray(0,t);await this.tokenizer.readBuffer(i,{position:e.fileInfo.size-t});for(let r=i.length-4;r>=0;r--)if(i[r]===Q[0]&&i[r+1]===Q[1]&&i[r+2]===Q[2]&&i[r+3]===Q[3])return e.fileInfo.size-t+r;return-1}async readCentralDirectory(){if(!this.tokenizer.supportsRandomAccess())return void K("Cannot reading central-directory without random-read support");K("Reading central-directory...");const e=this.tokenizer.position,i=await this.findEndOfCentralDirectoryLocator();if(i>0){K("Central-directory 32-bit signature found");const r=await this.tokenizer.readToken(H,i),a=[];this.tokenizer.setPosition(r.offsetOfStartOfCd);for(let e=0;e<r.nrOfEntriesOfSize;++e){const i=await this.tokenizer.readToken(Y);if(i.signature!==W)throw new Error("Expected Central-File-Header signature");i.filename=await this.tokenizer.readToken(new t.StringType(i.filenameLength,"utf-8")),await this.tokenizer.ignore(i.extraFieldLength),await this.tokenizer.ignore(i.fileCommentLength),a.push(i),K(`Add central-directory file-entry: n=${e+1}/${a.length}: filename=${a[e].filename}`)}return this.tokenizer.setPosition(e),a}this.tokenizer.setPosition(e)}async unzip(e){const t=await this.readCentralDirectory();if(t)return this.iterateOverCentralDirectory(t,e);let i=!1;do{const t=await this.readLocalFileHeader();if(!t)break;const r=e(t);let a;if(i=!!r.stop,await this.tokenizer.ignore(t.extraFieldLength),t.dataDescriptor&&0===t.compressedSize){const e=[];let i=V;K("Compressed-file-size unknown, scanning for next data-descriptor-signature....");let a=-1;for(;a<0&&i===V;){i=await this.tokenizer.peekBuffer(this.syncBuffer,{mayBeLess:!0}),a=te(this.syncBuffer.subarray(0,i),J);const t=a>=0?a:i;if(r.handler){const i=new Uint8Array(t);await this.tokenizer.readBuffer(i),e.push(i)}else await this.tokenizer.ignore(t)}K(`Found data-descriptor-signature at pos=${this.tokenizer.position}`),r.handler&&await this.inflate(t,ie(e),r.handler)}else r.handler?(K(`Reading compressed-file-data: ${t.compressedSize} bytes`),a=new Uint8Array(t.compressedSize),await this.tokenizer.readBuffer(a),await this.inflate(t,a,r.handler)):(K(`Ignoring compressed-file-data: ${t.compressedSize} bytes`),await this.tokenizer.ignore(t.compressedSize));if(K(`Reading data-descriptor at pos=${this.tokenizer.position}`),t.dataDescriptor){if(134695760!==(await this.tokenizer.readToken($)).signature)throw new Error("Expected data-descriptor-signature at position "+(this.tokenizer.position-$.len))}}while(!i)}async iterateOverCentralDirectory(e,t){for(const i of e){const e=t(i);if(e.handler){this.tokenizer.setPosition(i.relativeOffsetOfLocalHeader);const t=await this.readLocalFileHeader();if(t){await this.tokenizer.ignore(t.extraFieldLength);const r=new Uint8Array(i.compressedSize);await this.tokenizer.readBuffer(r),await this.inflate(t,r,e.handler)}}if(e.stop)break}}inflate(e,t,i){if(0===e.compressedMethod)return i(t);K(`Decompress filename=${e.filename}, compressed-size=${t.length}`);var r,a;return i(31==(r=t)[0]&&139==r[1]&&8==r[2]?O(r,a):8!=(15&r[0])||r[0]>>4>7||(r[0]<<8|r[1])%31?U(r,a):P(r,a))}async readLocalFileHeader(){const e=await this.tokenizer.peekToken(t.UINT32_LE);if(e===X){const e=await this.tokenizer.readToken(q);return e.filename=await this.tokenizer.readToken(new t.StringType(e.filenameLength,"utf-8")),e}if(e===W)return!1;if(3759263696===e)throw new Error("Encrypted ZIP");throw new Error("Unexpected signature")}}function te(e,t){const i=e.length,r=t.length;if(r>i)return-1;for(let a=0;a<=i-r;a++){let i=!0;for(let n=0;n<r;n++)if(e[a+n]!==t[n]){i=!1;break}if(i)return a}return-1}function ie(e){const t=e.reduce((e,t)=>e+t.length,0),i=new Uint8Array(t);let r=0;for(const t of e)i.set(t,r),r+=t.length;return i}var re=a(946);const ae={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},ne=4100;async function se(e,t){return new ue(t).fromBuffer(e)}function oe(e){switch(e=e.toLowerCase()){case"application/epub+zip":return{ext:"epub",mime:e};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:e};case"application/vnd.oasis.opendocument.text-template":return{ext:"ott",mime:e};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:e};case"application/vnd.oasis.opendocument.spreadsheet-template":return{ext:"ots",mime:e};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:e};case"application/vnd.oasis.opendocument.presentation-template":return{ext:"otp",mime:e};case"application/vnd.oasis.opendocument.graphics":return{ext:"odg",mime:e};case"application/vnd.oasis.opendocument.graphics-template":return{ext:"otg",mime:e};case"application/vnd.openxmlformats-officedocument.presentationml.slideshow":return{ext:"ppsx",mime:e};case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return{ext:"xlsx",mime:e};case"application/vnd.ms-excel.sheet.macroenabled":return{ext:"xlsm",mime:"application/vnd.ms-excel.sheet.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.spreadsheetml.template":return{ext:"xltx",mime:e};case"application/vnd.ms-excel.template.macroenabled":return{ext:"xltm",mime:"application/vnd.ms-excel.template.macroenabled.12"};case"application/vnd.ms-powerpoint.slideshow.macroenabled":return{ext:"ppsm",mime:"application/vnd.ms-powerpoint.slideshow.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return{ext:"docx",mime:e};case"application/vnd.ms-word.document.macroenabled":return{ext:"docm",mime:"application/vnd.ms-word.document.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":return{ext:"dotx",mime:e};case"application/vnd.ms-word.template.macroenabledtemplate":return{ext:"dotm",mime:"application/vnd.ms-word.template.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.presentationml.template":return{ext:"potx",mime:e};case"application/vnd.ms-powerpoint.template.macroenabled":return{ext:"potm",mime:"application/vnd.ms-powerpoint.template.macroenabled.12"};case"application/vnd.openxmlformats-officedocument.presentationml.presentation":return{ext:"pptx",mime:e};case"application/vnd.ms-powerpoint.presentation.macroenabled":return{ext:"pptm",mime:"application/vnd.ms-powerpoint.presentation.macroenabled.12"};case"application/vnd.ms-visio.drawing":return{ext:"vsdx",mime:"application/vnd.visio"};case"application/vnd.ms-package.3dmanufacturing-3dmodel+xml":return{ext:"3mf",mime:"model/3mf"}}}function ce(e,t,i){i={offset:0,...i};for(const[r,a]of t.entries())if(i.mask){if(a!==(i.mask[r]&e[r+i.offset]))return!1}else if(a!==e[r+i.offset])return!1;return!0}class ue{constructor(e){this.options={mpegOffsetTolerance:0,...e},this.detectors=[...e?.customDetectors??[],{id:"core",detect:this.detectConfident},{id:"core.imprecise",detect:this.detectImprecise}],this.tokenizerOptions={abortSignal:e?.signal}}async fromTokenizer(e){const t=e.position;for(const i of this.detectors){const r=await i.detect(e);if(r)return r;if(t!==e.position)return}}async fromBuffer(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof t}\``);const i=t instanceof Uint8Array?t:new Uint8Array(t);if(i?.length>1)return this.fromTokenizer(e.vY(i,this.tokenizerOptions))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(t){const i=await e.Xx(t,this.tokenizerOptions);try{return await this.fromTokenizer(i)}finally{await i.close()}}async toDetectionStream(t,i){const{sampleSize:r=ne}=i;let a,n;const s=t.getReader({mode:"byob"});try{const{value:t,done:i}=await s.read(new Uint8Array(r));if(n=t,!i&&t)try{a=await this.fromBuffer(t.subarray(0,r))}catch(t){if(!(t instanceof e.d1))throw t;a=void 0}n=t}finally{s.releaseLock()}const o=new TransformStream({async start(e){e.enqueue(n)},transform(e,t){t.enqueue(e)}}),c=t.pipeThrough(o);return c.fileType=a,c}check(e,t){return ce(this.buffer,e,t)}checkString(e,t){return this.check((i=e,[...i].map(e=>e.charCodeAt(0))),t);var i}detectConfident=async e=>{if(this.buffer=new Uint8Array(ne),void 0===e.fileInfo.size&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.detectConfident(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const i=await e.readToken(ae);return e.position+i>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(i),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===this.buffer[0]||70===this.buffer[0])&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){let r;return await new ee(e).unzip(e=>{switch(e.filename){case"META-INF/mozilla.rsa":return r={ext:"xpi",mime:"application/x-xpinstall"},{stop:!0};case"META-INF/MANIFEST.MF":return r={ext:"jar",mime:"application/java-archive"},{stop:!0};case"mimetype":return{async handler(e){const t=new TextDecoder("utf-8").decode(e).trim();r=oe(t)},stop:!0};case"[Content_Types].xml":return{async handler(e){let t=new TextDecoder("utf-8").decode(e);const i=t.indexOf('.main+xml"');if(-1===i){const e="application/vnd.ms-package.3dmanufacturing-3dmodel+xml";t.includes(`ContentType="${e}"`)&&(r=oe(e))}else{t=t.slice(0,Math.max(0,i));const e=t.lastIndexOf('"'),a=t.slice(Math.max(0,e+1));r=oe(a)}},stop:!0};default:return/classes\d*\.dex/.test(e.filename)?(r={ext:"apk",mime:"application/vnd.android.package-archive"},{stop:!0}):{}}}),r??{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const a=new Uint8Array(8);return await e.readBuffer(a),ce(a,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/ogg; codecs=opus"}:ce(a,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:ce(a,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:ce(a,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:ce(a,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:ce(a,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(3===this.buffer[2]||5===this.buffer[2]||7===this.buffer[2])&&(4===this.buffer[3]||6===this.buffer[3]||8===this.buffer[3]))return{ext:"zip",mime:"application/zip"};if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF"))return{ext:"pdf",mime:"application/pdf"};if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const n=await this.readTiffHeader(!1);if(n)return n}if(this.check([77,77])){const s=await this.readTiffHeader(!0);if(s)return s}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function o(){const i=await e.peekNumber(t.UINT8);let r=128,a=0;for(;0===(i&r)&&0!==r;)++a,r>>=1;const n=new Uint8Array(a+1);return await e.readBuffer(n),n}async function c(){const e=await o(),t=await o();t[0]^=128>>t.length-1;const i=Math.min(6,t.length),r=new DataView(e.buffer),a=new DataView(t.buffer,t.length-i,i);return{id:(0,re.AW)(r),len:(0,re.AW)(a)}}async function u(i){for(;i>0;){const r=await c();if(17026===r.id){return(await e.readToken(new t.StringType(r.len))).replaceAll(/\00.*$/g,"")}await e.ignore(r.len),--i}}const l=await c();switch(await u(l.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/matroska"};default:return}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1")||this.checkString("PARE"))return{ext:"parquet",mime:"application/vnd.apache.parquet"};if(this.checkString("ttcf"))return{ext:"ttc",mime:"font/collection"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([4,34,77,24]))return{ext:"lz4",mime:"application/x-lz4"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.checkString(".RMF"))return{ext:"rm",mime:"application/vnd.rn-realmedia"};if(this.checkString("DRACO"))return{ext:"drc",mime:"application/vnd.google.draco"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(0===this.buffer[6]||1===this.buffer[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const m=new t.StringType(4,"latin1").get(this.buffer,2);if(m.match("^d*")&&m>=1e3&&m<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>")){await e.ignore(8);return"debian-binary"===await e.readToken(new t.StringType(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"}}if(this.checkString("WEBVTT")&&["\n","\r","\t"," ","\0"].some(e=>this.checkString(e,{offset:6})))return{ext:"vtt",mime:"text/vtt"};if(this.check([137,80,78,71,13,10,26,10])){async function p(){return{length:await e.readToken(t.INT32_BE),type:await e.readToken(new t.StringType(4,"latin1"))}}await e.ignore(8);do{const d=await p();if(d.length<0)return;switch(d.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(d.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/vnd.apache.arrow.file"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.checkString("ftyp",{offset:4})&&96&this.buffer[8]){const f=new t.StringType(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(f){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return f.startsWith("3g")?f.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.check([82,73,70,70])){if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function h(){const i=new Uint8Array(16);return await e.readBuffer(i),{id:i,size:Number(await e.readToken(t.UINT64_LE))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const g=await h();let T=g.size-24;if(ce(g.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const b=new Uint8Array(16);if(T-=await e.readBuffer(b),ce(b,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(ce(b,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(T)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10])){await e.ignore(20);switch(await e.readToken(new t.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("**ACE",{offset:7})&&this.checkString("**",{offset:12}))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const y=new DataView(this.buffer.buffer).getUint32(12,!0);if(y>12&&this.buffer.length>=y+16)try{const k=(new TextDecoder).decode(this.buffer.subarray(16,y+16));if(JSON.parse(k).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}return this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2])?{ext:"mxf",mime:"application/mxf"}:this.checkString("SCRM",{offset:44})?{ext:"s3m",mime:"audio/x-s3m"}:this.check([71])&&this.check([71],{offset:188})||this.check([71],{offset:4})&&this.check([71],{offset:196})?{ext:"mts",mime:"video/mp2t"}:this.check([66,79,79,75,77,79,66,73],{offset:60})?{ext:"mobi",mime:"application/x-mobipocket-ebook"}:this.check([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70])?{ext:"lnk",mime:"application/x.ms.shortcut"}:this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0])?{ext:"alias",mime:"application/x.apple.alias"}:this.checkString("Kaydara FBX Binary  \0")?{ext:"fbx",mime:"application/x.autodesk.fbx"}:this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8}))?{ext:"eot",mime:"application/vnd.ms-fontobject"}:this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29])?{ext:"indd",mime:"application/x-indesign"}:(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),this.checkString("ustar",{offset:257})&&(this.checkString("\0",{offset:262})||this.checkString(" ",{offset:262}))||this.check([0,0,0,0,0,0],{offset:257})&&function(e,i=0){const r=Number.parseInt(new t.StringType(6).get(e,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(r))return!1;let a=256;for(let t=i;t<i+148;t++)a+=e[t];for(let t=i+156;t<i+512;t++)a+=e[t];return r===a}(this.buffer)?{ext:"tar",mime:"application/x-tar"}:this.check([255,254])?this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0:this.checkString("-----BEGIN PGP MESSAGE-----")?{ext:"pgp",mime:"application/pgp-encrypted"}:void 0)};detectImprecise=async e=>{if(this.buffer=new Uint8Array(ne),await e.peekBuffer(this.buffer,{length:Math.min(8,e.fileInfo.size),mayBeLess:!0}),this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(await e.peekBuffer(this.buffer,{length:Math.min(2+this.options.mpegOffsetTolerance,e.fileInfo.size),mayBeLess:!0}),this.buffer.length>=2+this.options.mpegOffsetTolerance)for(let e=0;e<=this.options.mpegOffsetTolerance;++e){const t=this.scanMpeg(e);if(t)return t}};async readTiffTag(e){const i=await this.tokenizer.readToken(e?t.UINT16_BE:t.UINT16_LE);switch(this.tokenizer.ignore(10),i){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const i=await this.tokenizer.readToken(e?t.UINT16_BE:t.UINT16_LE);for(let t=0;t<i;++t){const t=await this.readTiffTag(e);if(t)return t}}async readTiffHeader(e){const i=(e?t.UINT16_BE:t.UINT16_LE).get(this.buffer,2),r=(e?t.UINT32_BE:t.UINT32_LE).get(this.buffer,4);if(42===i){if(r>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r>=8){const i=(e?t.UINT16_BE:t.UINT16_LE).get(this.buffer,8),r=(e?t.UINT16_BE:t.UINT16_LE).get(this.buffer,10);if(28===i&&254===r||31===i&&11===r)return{ext:"nef",mime:"image/x-nikon-nef"}}}await this.tokenizer.ignore(r);return await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(43===i)return{ext:"tif",mime:"image/tiff"}}scanMpeg(e){if(this.check([255,224],{offset:e,mask:[255,224]})){if(this.check([16],{offset:e+1,mask:[22]}))return this.check([8],{offset:e+1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:e+1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:e+1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:e+1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}}new Set(["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ttc","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx","vtt","apk","drc","lz4","potx","xltx","dotx","xltm","ott","ots","otp","odg","otg","xlsm","docm","dotm","potm","pptm","jar","rm","ppsm","ppsx"]),new Set(["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.ms-powerpoint.slideshow.macroenabled.12","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/vnd.apache.arrow.file","video/mp4","audio/midi","video/matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","video/ogg","audio/ogg","audio/ogg; codecs=opus","application/ogg","audio/flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","font/collection","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","text/vtt","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/vnd.apache.parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio","application/vnd.android.package-archive","application/vnd.google.draco","application/x-lz4","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-excel.template.macroenabled.12","application/vnd.oasis.opendocument.text-template","application/vnd.oasis.opendocument.spreadsheet-template","application/vnd.oasis.opendocument.presentation-template","application/vnd.oasis.opendocument.graphics","application/vnd.oasis.opendocument.graphics-template","application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.ms-word.document.macroenabled.12","application/vnd.ms-word.template.macroenabled.12","application/vnd.ms-powerpoint.template.macroenabled.12","application/vnd.ms-powerpoint.presentation.macroenabled.12","application/java-archive","application/vnd.rn-realmedia"]);var le=a(486),me=a(525),pe=a(738);const de={multiple:!1},fe={year:de,track:de,disk:de,title:de,artist:de,artists:{multiple:!0,unique:!0},albumartist:de,album:de,date:de,originaldate:de,originalyear:de,releasedate:de,comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:de,subtitle:{multiple:!0},discsubtitle:de,totaltracks:de,totaldiscs:de,compilation:de,rating:{multiple:!0},bpm:de,mood:de,media:de,catalognumber:{multiple:!0,unique:!0},tvShow:de,tvShowSort:de,tvSeason:de,tvEpisode:de,tvEpisodeId:de,tvNetwork:de,podcast:de,podcasturl:de,releasestatus:de,releasetype:{multiple:!0},releasecountry:de,script:de,language:de,copyright:de,license:de,encodedby:de,encodersettings:de,gapless:de,barcode:de,isrc:{multiple:!0},asin:de,musicbrainz_recordingid:de,musicbrainz_trackid:de,musicbrainz_albumid:de,musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:de,musicbrainz_workid:de,musicbrainz_trmid:de,musicbrainz_discid:de,acoustid_id:de,acoustid_fingerprint:de,musicip_puid:de,musicip_fingerprint:de,website:de,"performer:instrument":{multiple:!0,unique:!0},averageLevel:de,peakLevel:de,notes:{multiple:!0,unique:!1},key:de,originalalbum:de,originalartist:de,discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:de,discogs_label_id:de,discogs_master_release_id:de,discogs_votes:de,discogs_rating:de,replaygain_track_peak:de,replaygain_track_gain:de,replaygain_album_peak:de,replaygain_album_gain:de,replaygain_track_minmax:de,replaygain_album_minmax:de,replaygain_undo:de,description:{multiple:!0},longDescription:de,category:{multiple:!0},hdVideo:de,keywords:{multiple:!0},movement:de,movementIndex:de,movementTotal:de,podcastId:de,showMovement:de,stik:de,playCounter:de};class he{static toIntOrNull(e){const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t}static normalizeTrack(e){const t=e.toString().split("/");return{no:Number.parseInt(t[0],10)||null,of:Number.parseInt(t[1],10)||null}}constructor(e,t){this.tagTypes=e,this.tagMap=t}mapGenericTag(e,t){e={id:e.id,value:e.value},this.postMap(e,t);const i=this.getCommonName(e.id);return i?{id:i,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,t){}}he.maxRatingScore=1;const ge={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class Te extends he{constructor(){super(["ID3v1"],ge)}}class be extends he{constructor(e,t){const i={};for(const e of Object.keys(t))i[e.toUpperCase()]=t[e];super(e,i)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}var ye=a(790);const ke={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer",USLT:"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"releasedate",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl",GRP1:"grouping",PCNT:"playCounter"};class we extends be{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*he.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],ke)}postMap(e,i){switch(e.id){case"UFID":{const t=e.value;"http://musicbrainz.org"===t.owner_identifier&&(e.id+=`:${t.owner_identifier}`,e.value=(0,ye.sc)(t.identifier,"latin1"))}break;case"PRIV":{const r=e.value;switch(r.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=`:${r.owner_identifier}`,e.value=4===r.data.length?t.UINT32_LE.get(r.data,0):null,null===e.value&&i.addWarning("Failed to parse PRIV:PeakValue");break;default:i.addWarning(`Unknown PRIV owner-identifier: ${r.data}`)}}break;case"POPM":e.value=we.toRating(e.value)}}}const ve={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class xe extends he{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super(["asf"],ve)}postMap(e){switch(e.id){case"WM/SharedUserRating":{const t=e.id.split(":");e.value=xe.toRating(e.value),e.id=t[0];break}}}}const Ie={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class Se extends be{constructor(){super(["ID3v2.2"],Ie)}}const Ae={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Releasedate:"releasedate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class Ee extends be{constructor(){super(["APEv2"],Ae)}}const Ce={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear","----:com.apple.iTunes:RELEASEDATE":"releasedate",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"};class _e extends be{constructor(){super(["iTunes"],Ce)}postMap(e,t){if("rate"===e.id)e.value={source:void 0,rating:Number.parseFloat(e.value)/100}}}const Me={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",RELEASEDATE:"releasedate",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class Re extends he{static toRating(e,t,i){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(t)/i*he.maxRatingScore}}constructor(){super(["vorbis"],Me)}postMap(e){if("RATING"===e.id)e.value=Re.toRating(void 0,e.value,100);else if(0===e.id.indexOf("RATING:")){const t=e.id.split(":");e.value=Re.toRating(t[1],e.value,1),e.id=t[0]}}}const ze={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class Ne extends he{constructor(){super(["exif"],ze)}}const Le={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:DATE_RELEASED":"releasedate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class Be extends be{constructor(){super(["matroska"],Le)}}const Ue={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class Oe extends he{constructor(){super(["AIFF"],Ue)}}var Pe=a(453);class De{constructor(){this.tagMappers={},[new Te,new Se,new we,new _e,new _e,new Re,new Ee,new xe,new Ne,new Be,new Oe].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,t,i){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(t,i);throw new Pe.nK(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(const t of e.tagTypes)this.tagMappers[t]=e}}var Fe=a(198);const Xe=F("music-metadata:collector"),Ge=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class We{constructor(e){this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new De,this.opts=e;let t=1;for(const e of Ge)this.originPriority[e]=t++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){Xe(`streamInfo: type=${e.type?pe.vQ[e.type]:"?"}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,t){Xe(`format: ${e} = ${t}`),this.format[e]=t,this.opts?.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:t}})}setAudioOnly(){this.setFormat("hasAudio",!0),this.setFormat("hasVideo",!1)}async addTag(e,t,i){Xe(`tag ${e}.${t} = ${i}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:t,value:i}),await this.toCommon(e,t,i)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,t){switch(t.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:t.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:t.value});break;case"artists":if(!(this.common.artist&&this.commonOrigin.artist!==this.originPriority.artificial||this.common.artists&&-1!==this.common.artists.indexOf(t.value))){const e=function(e){if(e.length>2)return`${e.slice(0,e.length-1).join(", ")} & ${e[e.length-1]}`;return e.join(" & ")}((this.common.artists||[]).concat([t.value])),i={id:"artist",value:e};this.setGenericTag("artificial",i)}break;case"picture":return this.postFixPicture(t.value).then(i=>{null!==i&&(t.value=i,this.setGenericTag(e,t))});case"totaltracks":return void(this.common.track.of=he.toIntOrNull(t.value));case"totaldiscs":return void(this.common.disk.of=he.toIntOrNull(t.value));case"movementTotal":return void(this.common.movementIndex.of=he.toIntOrNull(t.value));case"track":case"disk":case"movementIndex":{const e=this.common[t.id].of;return this.common[t.id]=he.normalizeTrack(t.value),void(this.common[t.id].of=null!=e?e:this.common[t.id].of)}case"bpm":case"year":case"originalyear":t.value=Number.parseInt(t.value,10);break;case"date":{const e=Number.parseInt(t.value.substr(0,4),10);Number.isNaN(e)||(this.common.year=e);break}case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":t.value="string"==typeof t.value?Number.parseInt(t.value,10):t.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":t.value=(0,ye.th)(t.value);break;case"replaygain_track_minmax":t.value=t.value.split(",").map(e=>Number.parseInt(e,10));break;case"replaygain_undo":{const e=t.value.split(",").map(e=>Number.parseInt(e,10));t.value={leftChannel:e[0],rightChannel:e[1]};break}case"gapless":case"compilation":case"podcast":case"showMovement":t.value="1"===t.value||1===t.value;break;case"isrc":{const e=this.common[t.id];if(e&&-1!==e.indexOf(t.value))return;break}case"comment":"string"==typeof t.value&&(t.value={text:t.value}),"iTunPGAP"===t.value.descriptor&&this.setGenericTag(e,{id:"gapless",value:"1"===t.value.text});break;case"lyrics":"string"==typeof t.value&&(t.value=function(e){const t=e.split("\n"),i=[],r=/\[(\d{2}):(\d{2})\.(\d{2,3})\]/;for(const e of t){const t=e.match(r);if(t){const a=Number.parseInt(t[1],10),n=Number.parseInt(t[2],10),s=t[3];let o;o=3===s.length?Number.parseInt(s,10):10*Number.parseInt(s,10);const c=1e3*(60*a+n)+o,u=e.replace(r,"").trim();i.push({timestamp:c,text:u})}}return{contentType:Fe.MW.lyrics,timeStampFormat:Fe.sd.milliseconds,syncText:i}}(t.value))}null!==t.value&&this.setGenericTag(e,t)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const t=await se(Uint8Array.from(e.data));if(!t)return null;e.format=t.mime}if(e.format=e.format.toLocaleLowerCase(),"image/jpg"===e.format)e.format="image/jpeg";return e}return this.addWarning("Empty picture tag found"),null}async toCommon(e,t,i){const r={id:t,value:i},a=this.tagMapper.mapTag(e,r,this);a&&await this.postMap(e,a)}setGenericTag(e,t){Xe(`common.${t.id} = ${t.value}`);const i=this.commonOrigin[t.id]||1e3,r=this.originPriority[e];if(a=t.id,fe[a]&&!fe[a].multiple){if(!(r<=i))return Xe(`Ignore native tag (singleton): ${e}.${t.id} = ${t.value}`);this.common[t.id]=t.value,this.commonOrigin[t.id]=r}else if(r===i)!function(e){return!fe[e].multiple||fe[e].unique||!1}(t.id)||-1===this.common[t.id].indexOf(t.value)?this.common[t.id].push(t.value):Xe(`Ignore duplicate value: ${e}.${t.id} = ${t.value}`);else{if(!(r<i))return Xe(`Ignore native tag (list): ${e}.${t.id} = ${t.value}`);this.common[t.id]=[t.value],this.commonOrigin[t.id]=r}var a;this.opts?.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:t.id,value:t.value}})}}const je={parserType:"mpeg",extensions:[".mp2",".mp3",".m2a",".aac","aacp"],mimeTypes:["audio/mpeg","audio/mp3","audio/aacs","audio/aacp"],load:async()=>(await a.e(177).then(a.bind(a,177))).MpegParser},$e={parserType:"apev2",extensions:[".ape"],mimeTypes:["audio/ape","audio/monkeys-audio"],load:async()=>(await Promise.resolve().then(a.bind(a,142))).APEv2Parser},qe={parserType:"asf",extensions:[".asf"],mimeTypes:["audio/ms-wma","video/ms-wmv","audio/ms-asf","video/ms-asf","application/vnd.ms-asf"],load:async()=>(await a.e(883).then(a.bind(a,883))).AsfParser},He={parserType:"dsdiff",extensions:[".dff"],mimeTypes:["audio/dsf","audio/dsd"],load:async()=>(await a.e(897).then(a.bind(a,897))).DsdiffParser},Ye={parserType:"aiff",extensions:[".aif","aiff","aifc"],mimeTypes:["audio/aiff","audio/aif","audio/aifc","application/aiff"],load:async()=>(await a.e(679).then(a.bind(a,679))).AIFFParser},Ze={parserType:"dsf",extensions:[".dsf"],mimeTypes:["audio/dsf"],load:async()=>(await a.e(283).then(a.bind(a,283))).DsfParser},Ke={parserType:"flac",extensions:[".flac"],mimeTypes:["audio/flac"],load:async()=>(await a.e(566).then(a.bind(a,566))).FlacParser},Ve={parserType:"matroska",extensions:[".mka",".mkv",".mk3d",".mks","webm"],mimeTypes:["audio/matroska","video/matroska","audio/webm","video/webm"],load:async()=>(await a.e(695).then(a.bind(a,695))).MatroskaParser},Je={parserType:"mp4",extensions:[".mp4",".m4a",".m4b",".m4pa","m4v","m4r","3gp"],mimeTypes:["audio/mp4","audio/m4a","video/m4v","video/mp4"],load:async()=>(await a.e(509).then(a.bind(a,509))).MP4Parser},Qe={parserType:"musepack",extensions:[".mpc"],mimeTypes:["audio/musepack"],load:async()=>(await a.e(873).then(a.bind(a,873))).MusepackParser},et={parserType:"ogg",extensions:[".ogg",".ogv",".oga",".ogm",".ogx",".opus",".spx"],mimeTypes:["audio/ogg","audio/opus","audio/speex","video/ogg"],load:async()=>(await a.e(572).then(a.bind(a,572))).OggParser},tt={parserType:"wavpack",extensions:[".wv",".wvp"],mimeTypes:["audio/wavpack"],load:async()=>(await a.e(869).then(a.bind(a,869))).WavPackParser},it={parserType:"riff",extensions:[".wav","wave",".bwf"],mimeTypes:["audio/vnd.wave","audio/wav","audio/wave"],load:async()=>(await a.e(773).then(a.bind(a,773))).WaveParser},rt=F("music-metadata:parser:factory");class at{constructor(){this.parsers=[],[Ke,je,$e,Je,Ve,it,et,qe,Ye,tt,Qe,Ze,He].forEach(e=>{this.registerParser(e)})}registerParser(e){this.parsers.push(e)}async parse(e,t,i){if(e.supportsRandomAccess()?(rt("tokenizer supports random-access, scanning for appending headers"),await gt(e,i)):rt("tokenizer does not support random-access, cannot scan for appending headers"),!t){const i=new Uint8Array(4100);if(e.fileInfo.mimeType&&(t=this.findLoaderForContentType(e.fileInfo.mimeType)),!t&&e.fileInfo.path&&(t=this.findLoaderForExtension(e.fileInfo.path)),!t){rt("Guess parser on content..."),await e.peekBuffer(i,{mayBeLess:!0});const r=await se(i,{mpegOffsetTolerance:10});if(!r||!r.mime)throw new Pe.e6("Failed to determine audio format");if(rt(`Guessed file type is mime=${r.mime}, extension=${r.ext}`),!(t=this.findLoaderForContentType(r.mime)))throw new Pe.qq(`Guessed MIME-type not supported: ${r.mime}`)}}rt(`Loading ${t.parserType} parser...`);const r=new We(i),a=new(await t.load())(r,e,i??{});return rt(`Parser ${t.parserType} loaded`),await a.parse(),r.format.trackInfo&&(void 0===r.format.hasAudio&&r.setFormat("hasAudio",!!r.format.trackInfo.find(e=>e.type===pe.S.audio)),void 0===r.format.hasVideo&&r.setFormat("hasVideo",!!r.format.trackInfo.find(e=>e.type===pe.S.video))),r.toCommonMetadata()}findLoaderForExtension(e){if(!e)return;const t=function(e){const t=e.lastIndexOf(".");return-1===t?"":e.substring(t)}(e).toLocaleLowerCase()||e;return this.parsers.find(e=>-1!==e.extensions.indexOf(t))}findLoaderForContentType(e){let t;if(!e)return;try{t=function(e){const t=le.parse(e),i=(0,me.qg)(t.type);return{type:i.type,subtype:i.subtype,suffix:i.suffix,parameters:t.parameters}}(e)}catch(t){return void rt(`Invalid HTTP Content-Type header value: ${e}`)}const i=0===t.subtype.indexOf("x-")?t.subtype.substring(2):t.subtype;return this.parsers.find(e=>e.mimeTypes.find(e=>-1!==e.indexOf(`${t.type}/${i}`)))}getSupportedMimeTypes(){const e=new Set;return this.parsers.forEach(t=>{t.mimeTypes.forEach(t=>{e.add(t),e.add(t.replace("/","/x-"))})}),Array.from(e)}}var nt=a(142),st=a(972),ot=a(74);const ct="LYRICS200";async function ut(t,i={}){const r=(0,e._F)(t);try{return await pt(r,i)}finally{await r.close()}}async function lt(t,i,r={}){const a=(0,e.Xx)(t,{fileInfo:"string"==typeof i?{mimeType:i}:i});try{return await pt(a,r)}finally{await a.close()}}async function mt(t,i,r={}){return pt((0,e.vY)(t,{fileInfo:"string"==typeof i?{mimeType:i}:i}),r)}function pt(e,t){return(new at).parse(e,void 0,t)}function dt(e){const t={};for(const{id:i,value:r}of e)(t[i]||(t[i]=[])).push(r);return t}function ft(e){return void 0===e?0:1+Math.round(4*e)}function ht(e){return e?e.reduce((e,t)=>t.name&&t.name.toLowerCase()in["front","cover","cover (front)"]?t:e):null}async function gt(e,t={}){let i=e.fileInfo.size;if(await(0,st.zc)(e)){i-=128;const t=await async function(e){const t=e.fileInfo.size;if(t>=143){const i=new Uint8Array(15),r=e.position;await e.readBuffer(i,{position:t-143}),e.setPosition(r);const a=(0,ot.c)(i,"latin1");if(a.substring(6)===ct)return Number.parseInt(a.substring(0,6),10)+15}return 0}(e);i-=t}t.apeHeader=await nt.APEv2Parser.findApeFooterOffset(e,i)}async function Tt(e,t={}){throw new Error("This function require a Node engine. To load Web API File objects use parseBlob instead.")}async function bt(e,t,i={}){throw new Error("This function require a Node engine.")}function yt(){return(new at).getSupportedMimeTypes()}})(),window.meta=n})();
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[566],{51:(e,t,a)=>{a.d(t,{Sl:()=>o,Z:()=>n,xu:()=>i});var s=a(4),r=a(198);class i{static fromBase64(e){return i.fromBuffer(Uint8Array.from(atob(e),e=>e.charCodeAt(0)))}static fromBuffer(e){return new i(e.length).get(e,0)}constructor(e){this.len=e}get(e,t){const a=r.n5[s.UINT32_BE.get(e,t)];t+=4;const i=s.UINT32_BE.get(e,t);t+=4;const n=new s.StringType(i,"utf-8").get(e,t);t+=i;const o=s.UINT32_BE.get(e,t);t+=4;const d=new s.StringType(o,"utf-8").get(e,t);t+=o;const c=s.UINT32_BE.get(e,t);t+=4;const h=s.UINT32_BE.get(e,t);t+=4;const l=s.UINT32_BE.get(e,t);t+=4;const m=s.UINT32_BE.get(e,t);t+=4;const g=s.UINT32_BE.get(e,t);t+=4;return{type:a,format:n,description:d,width:c,height:h,colour_depth:l,indexed_color:m,data:e.slice(t,t+g)}}}const n={len:7,get:(e,t)=>({packetType:s.UINT8.get(e,t),vorbis:new s.StringType(6,"ascii").get(e,t+1)})},o={len:23,get:(e,t)=>({version:s.UINT32_LE.get(e,t+0),channelMode:s.UINT8.get(e,t+4),sampleRate:s.UINT32_LE.get(e,t+5),bitrateMax:s.UINT32_LE.get(e,t+9),bitrateNominal:s.UINT32_LE.get(e,t+13),bitrateMin:s.UINT32_LE.get(e,t+17)})}},195:(e,t,a)=>{a.d(t,{Y:()=>i});var s=a(4),r=a(74);class i{constructor(e,t){this.data=e,this.offset=t}readInt32(){const e=s.UINT32_LE.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),t=(0,r.c)(this.data.subarray(this.offset,this.offset+e),"utf-8");return this.offset+=e,t}parseUserComment(){const e=this.offset,t=this.readStringUtf8(),a=t.indexOf("=");return{key:t.substring(0,a).toUpperCase(),value:t.substring(a+1),len:this.offset-e}}}},566:(e,t,a)=>{a.r(t),a.d(t,{FlacParser:()=>u});var s=a(288),r=a(4),i=a(51),n=a(834),o=a(68),d=a(923),c=a(195),h=a(453),l=a(892);const m=s("music-metadata:parser:FLAC");class g extends((0,h.fO)("FLAC")){}class u extends n.k{constructor(){super(...arguments),this.vorbisParser=new d._(this.metadata,this.options),this.padding=0}async postId3v2Parse(){if("fLaC"!==(await this.tokenizer.readToken(o.e)).toString())throw new g("Invalid FLAC preamble");let e;do{e=await this.tokenizer.readToken(l.Tw),await this.parseDataBlock(e)}while(!e.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}async parseDataBlock(e){switch(m(`blockHeader type=${e.type}, length=${e.length}`),e.type){case l._B.STREAMINFO:return this.readBlockStreamInfo(e.length);case l._B.PADDING:this.padding+=e.length;break;case l._B.APPLICATION:case l._B.SEEKTABLE:break;case l._B.VORBIS_COMMENT:return this.readComment(e.length);case l._B.CUESHEET:break;case l._B.PICTURE:return void await this.parsePicture(e.length);default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async readBlockStreamInfo(e){if(e!==l.om.len)throw new g("Unexpected block-stream-info length");const t=await this.tokenizer.readToken(l.om);this.metadata.setFormat("container","FLAC"),this.processsStreamInfo(t)}processsStreamInfo(e){this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("hasAudio",!0),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",e.channels),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),e.totalSamples>0&&this.metadata.setFormat("duration",e.totalSamples/e.sampleRate)}async readComment(e){const t=await this.tokenizer.readToken(new r.Uint8ArrayType(e));return this.parseComment(t)}async parseComment(e){const t=new c.Y(e,0),a=t.readStringUtf8();a.length>0&&this.metadata.setFormat("tool",a);const s=t.readInt32(),r=new Array(s);for(let e=0;e<s;e++)r[e]=t.parseUserComment();await Promise.all(r.map(e=>("ENCODER"===e.key&&this.metadata.setFormat("tool",e.value),this.addTag(e.key,e.value))))}async parsePicture(e){return this.options.skipCovers?this.tokenizer.ignore(e):this.addPictureTag(await this.tokenizer.readToken(new i.xu(e)))}addPictureTag(e){return this.addTag("METADATA_BLOCK_PICTURE",e)}addTag(e,t){return this.vorbisParser.addTag(e,t)}}},616:(e,t,a)=>{a.d(t,{S:()=>p});var s=a(4),r=a(790),i=a(288),n=a(198),o=a(972),d=a(453);const c=i("music-metadata:id3v2:frame-parser"),h="latin1";function l(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?o.jR[Number.parseInt(e)]:void 0}class m{constructor(e,t){this.major=e,this.warningCollector=t}readData(e,t,a){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${t}`);const{encoding:i,bom:o}=n.YF.get(e,0),d=e.length;let u=0,p=[];const f=m.getNullTerminatorLength(i);let T;switch(c(`Parsing tag type=${t}, encoding=${i}, bom=${o}`),"TXXX"!==t&&"T"===t[0]?"T*":t){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let a;try{a=r.sc(e.subarray(1),i).replace(/\x00+$/,"")}catch(e){if(e instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${t} header has invalid string value: ${e.message}`);break}throw e}switch(t){case"TMCL":case"TIPL":case"IPLS":p=m.functionList(this.splitValue(t,a));break;case"TRK":case"TRCK":case"TPOS":p=a;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":p=this.splitValue(t,a);break;case"TCO":case"TCON":p=this.splitValue(t,a).map(e=>function(e){const t=[];let a,s="";for(const r of e)if("string"==typeof a)if("("===r&&""===a)s+="(",a=void 0;else if(")"===r){""!==s&&(t.push(s),s="");const e=l(a);e&&t.push(e),a=void 0}else a+=r;else"("===r?a="":s+=r;return s&&(0===t.length&&s.match(/^\d*$/)&&(s=l(s)),s&&t.push(s)),t}(e)).reduce((e,t)=>e.concat(t),[]);break;case"PCS":case"PCST":p=this.major>=4?this.splitValue(t,a):[a],p=Array.isArray(p)&&""===p[0]?1:0;break;default:p=this.major>=4?this.splitValue(t,a):[a]}break}case"TXXX":{const a=m.readIdentifierAndData(e,u+1,d,i);p={description:a.id,text:this.splitValue(t,r.sc(a.data,i).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(a){const t={};switch(u+=1,this.major){case 2:t.format=r.sc(e.subarray(u,u+3),"latin1"),u+=3;break;case 3:case 4:T=r.sX(e,u,d,h),t.format=r.sc(e.subarray(u,T),h),u=T+1;break;default:throw function(e){throw new g(`Unexpected majorVer: ${e}`)}(this.major)}t.format=m.fixPictureMimeType(t.format),t.type=n.n5[e[u]],u+=1,T=r.sX(e,u,d,i),t.description=r.sc(e.subarray(u,T),i),u=T+f,t.data=e.subarray(u,d),p=t}break;case"CNT":case"PCNT":p=(0,r.ku)(e);break;case"SYLT":{const t=n.aY.get(e,0);u+=n.aY.len;const a={descriptor:"",language:t.language,contentType:t.contentType,timeStampFormat:t.timeStampFormat,syncText:[]};let r=!1;for(;u<d;){const i=m.readNullTerminatedString(e.subarray(u),t.encoding);if(u+=i.len,r){const t=s.UINT32_BE.get(e,u);u+=s.UINT32_BE.len,a.syncText.push({text:i.text,timestamp:t})}else a.descriptor=i.text,r=!0}p=a;break}case"ULT":case"USLT":case"COM":case"COMM":{const t=n.Jp.get(e,u);u+=n.Jp.len;const a=m.readNullTerminatedString(e.subarray(u),t.encoding);u+=a.len;const s=m.readNullTerminatedString(e.subarray(u),t.encoding);p={language:t.language,descriptor:a.text,text:s.text};break}case"UFID":{const t=m.readIdentifierAndData(e,u,d,h);p={owner_identifier:t.id,identifier:t.data};break}case"PRIV":{const t=m.readIdentifierAndData(e,u,d,h);p={owner_identifier:t.id,data:t.data};break}case"POPM":{T=r.sX(e,u,d,h);const t=r.sc(e.subarray(u,T),h);u=T+1;const a=d-u-1;p={email:t,rating:s.UINT8.get(e,u),counter:a>0?r.ku(e.subarray(u+1)):void 0};break}case"GEOB":{T=r.sX(e,u+1,d,i);const t=r.sc(e.subarray(u+1,T),h);u=T+1,T=r.sX(e,u,d,i);const a=r.sc(e.subarray(u,T),h);u=T+1,T=r.sX(e,u,d,i);const s=r.sc(e.subarray(u,T),h);u=T+1;p={type:t,filename:a,description:s,data:e.subarray(u,d)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":T=r.sX(e,u+1,d,i),p=r.sc(e.subarray(u,T),h);break;case"WXXX":{T=r.sX(e,u+1,d,i);const t=r.sc(e.subarray(u+1,T),i);u=T+("utf-16le"===i?2:1),p={description:t,url:r.sc(e.subarray(u,d),h)};break}case"WFD":case"WFED":p=r.sc(e.subarray(u+1,r.sX(e,u+1,d,i)),i);break;case"MCDI":p=e.subarray(0,d);break;default:c(`Warning: unsupported id3v2-tag-type: ${t}`)}return p}static readNullTerminatedString(e,t){let a=t.bom?2:0;const s=r.sX(e,a,e.length,t.encoding),i=e.subarray(a,s);return a="utf-16le"===t.encoding?s+2:s+1,{text:r.sc(i,t.encoding),len:a}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const t={};for(let a=0;a+1<e.length;a+=2){const s=e[a+1].split(",");t[e[a]]=t[e[a]]?t[e[a]].concat(s):s}return t}splitValue(e,t){let a;return this.major<4?(a=t.split(/\x00/g),a.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):a=t.split(/\//g)):a=t.split(/\x00/g),m.trimArray(a)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,t,a,s){const i=r.sX(e,t,a,s),n=r.sc(e.subarray(t,i),s);return t=i+m.getNullTerminatorLength(s),{id:n,data:e.subarray(t,a)}}static getNullTerminatorLength(e){return"utf-16le"===e?2:1}}class g extends((0,d.fO)("id3v2")){}var u=a(74);class p{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let t=0,a=0;for(;t<e.length-1;)t!==a&&(e[a]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,a++;return t<e.length&&(e[a++]=e[t]),e.subarray(0,a)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw f(e)}}static readFrameFlags(e){return{status:{tag_alter_preservation:r.mh(e,0,6),file_alter_preservation:r.mh(e,0,5),read_only:r.mh(e,0,4)},format:{grouping_identity:r.mh(e,1,7),compression:r.mh(e,1,3),encryption:r.mh(e,1,2),unsynchronisation:r.mh(e,1,1),data_length_indicator:r.mh(e,1,0)}}}static readFrameData(e,t,a,s,r){const i=new m(a,r);switch(a){case 2:return i.readData(e,t.id,s);case 3:case 4:return t.flags?.format.unsynchronisation&&(e=p.removeUnsyncBytes(e)),t.flags?.format.data_length_indicator&&(e=e.subarray(4,e.length)),i.readData(e,t.id,s);default:throw f(a)}}static makeDescriptionTagName(e,t){return e+(t?`:${t}`:"")}async parse(e,t,a){this.tokenizer=t,this.metadata=e,this.options=a;const s=await this.tokenizer.readToken(n.yW);if("ID3"!==s.fileIdentifier)throw new g("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(n.nl),t=e.size-n.nl.len;return t>0?this.parseExtendedHeaderData(t,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,t){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-t)}async parseId3Data(e){const t=await this.tokenizer.readToken(new s.Uint8ArrayType(e));for(const e of this.parseMetadata(t))if("TXXX"===e.id)e.value&&await this.handleTag(e,e.value.text,()=>e.value.description);else await(Array.isArray(e.value)?Promise.all(e.value.map(t=>this.addTag(e.id,t))):this.addTag(e.id,e.value))}async handleTag(e,t,a,s=e=>e){await Promise.all(t.map(t=>this.addTag(p.makeDescriptionTagName(e.id,a(t)),s(t))))}async addTag(e,t){await this.metadata.addTag(this.headerType,e,t)}parseMetadata(e){let t=0;const a=[];for(;t!==e.length;){const s=p.getFrameHeaderLength(this.id3Header.version.major);if(t+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const r=e.subarray(t,t+s);t+=s;const i=this.readFrameHeader(r,this.id3Header.version.major),n=e.subarray(t,t+i.length);t+=i.length;const o=p.readFrameData(n,i,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&a.push({id:i.id,value:o})}return a}readFrameHeader(e,t){let a;switch(t){case 2:a={id:(0,u.c)(e.subarray(0,3),"ascii"),length:s.UINT24_BE.get(e,3)},a.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${a.id}`);break;case 3:case 4:a={id:(0,u.c)(e.subarray(0,4),"ascii"),length:(4===t?n.St:s.UINT32_BE).get(e,4),flags:p.readFrameFlags(e.subarray(8,10))},a.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${a.id}`);break;default:throw f(t)}return a}}function f(e){throw new g(`Unexpected majorVer: ${e}`)}},834:(e,t,a)=>{a.d(t,{k:()=>h});var s=a(959),r=a(288),i=a(198),n=a(616),o=a(972),d=a(585);const c=r("music-metadata:parser:ID3");class h extends d.s{constructor(){super(...arguments),this.id3parser=new n.S}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(i.yW)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof s.d1))throw e;c("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),c("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new o.Bn(this.metadata,this.tokenizer,this.options);await e.parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(i.yW)).fileIdentifier)return c("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}},892:(e,t,a)=>{a.d(t,{Tw:()=>n,_B:()=>i,om:()=>o});var s=a(790),r=a(4);const i={STREAMINFO:0,PADDING:1,APPLICATION:2,SEEKTABLE:3,VORBIS_COMMENT:4,CUESHEET:5,PICTURE:6},n={len:4,get:(e,t)=>({lastBlock:s.mh(e,t,7),type:s.f5(e,t,1,7),length:r.UINT24_BE.get(e,t+1)})},o={len:34,get:(e,t)=>({minimumBlockSize:r.UINT16_BE.get(e,t),maximumBlockSize:r.UINT16_BE.get(e,t+2)/1e3,minimumFrameSize:r.UINT24_BE.get(e,t+4),maximumFrameSize:r.UINT24_BE.get(e,t+7),sampleRate:r.UINT24_BE.get(e,t+10)>>4,channels:s.f5(e,t+12,4,3)+1,bitsPerSample:s.f5(e,t+12,7,5)+1,totalSamples:s.f5(e,t+13,4,36),fileMD5:new r.Uint8ArrayType(16).get(e,t+18)})}},923:(e,t,a)=>{a.d(t,{_:()=>h});var s=a(4),r=a(288),i=a(195),n=a(51),o=a(453);const d=r("music-metadata:parser:ogg:vorbis1");class c extends((0,o.fO)("Vorbis")){}class h{constructor(e,t){this.pageSegments=[],this.durationOnLastPage=!0,this.metadata=e,this.options=t}async parsePage(e,t){if(this.lastPageHeader=e,e.headerType.firstPage)this.parseFirstPage(e,t);else{if(e.headerType.continued){if(0===this.pageSegments.length)throw new c("Cannot continue on previous page");this.pageSegments.push(t)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const e=h.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(e)}this.pageSegments=e.headerType.lastPage?[]:[t]}}}static mergeUint8Arrays(e){const t=e.reduce((e,t)=>e+t.length,0),a=new Uint8Array(t);return e.forEach((e,t,s)=>{const r=s.slice(0,t).reduce((e,t)=>e+t.length,0);a.set(e,r)}),a}async flush(){await this.parseFullPage(h.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,t){const a=new i.Y(e,t).parseUserComment();return await this.addTag(a.key,a.value),a.len}async addTag(e,t){if("METADATA_BLOCK_PICTURE"===e&&"string"==typeof t){if(this.options.skipCovers)return void d("Ignore picture");t=n.xu.fromBase64(t),d(`Push picture: id=${e}, format=${t.format}`)}else d(`Push tag: id=${e}, value=${t}`);await this.metadata.addTag("vorbis",e,t)}calculateDuration(){this.lastPageHeader&&this.metadata.format.sampleRate&&this.lastPageHeader.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",this.lastPageHeader.absoluteGranulePosition),this.metadata.setFormat("duration",this.lastPageHeader.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,t){this.metadata.setFormat("codec","Vorbis I"),this.metadata.setFormat("hasAudio",!0),d("Parse first page");const a=n.Z.get(t,0);if("vorbis"!==a.vorbis)throw new c("Metadata does not look like Vorbis");if(1!==a.packetType)throw new c("First Ogg page should be type 1: the identification header");{const e=n.Sl.get(t,n.Z.len);this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("bitrate",e.bitrateNominal),this.metadata.setFormat("numberOfChannels",e.channelMode),d("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",e.sampleRate,e.bitrateNominal,e.channelMode)}}async parseFullPage(e){const t=n.Z.get(e,0);if(d("Parse full page: type=%s, byteLength=%s",t.packetType,e.byteLength),3===t.packetType)return this.parseUserCommentList(e,n.Z.len)}async parseUserCommentList(e,t){const a=s.UINT32_LE.get(e,t);t+=4,t+=a;let r=s.UINT32_LE.get(e,t);for(t+=4;r-- >0;)t+=await this.parseUserComment(e,t)}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[566,572],{51:(e,t,a)=>{a.d(t,{Sl:()=>o,Z:()=>n,xu:()=>i});var s=a(4),r=a(198);class i{static fromBase64(e){return i.fromBuffer(Uint8Array.from(atob(e),e=>e.charCodeAt(0)))}static fromBuffer(e){return new i(e.length).get(e,0)}constructor(e){this.len=e}get(e,t){const a=r.n5[s.UINT32_BE.get(e,t)];t+=4;const i=s.UINT32_BE.get(e,t);t+=4;const n=new s.StringType(i,"utf-8").get(e,t);t+=i;const o=s.UINT32_BE.get(e,t);t+=4;const c=new s.StringType(o,"utf-8").get(e,t);t+=o;const d=s.UINT32_BE.get(e,t);t+=4;const h=s.UINT32_BE.get(e,t);t+=4;const g=s.UINT32_BE.get(e,t);t+=4;const l=s.UINT32_BE.get(e,t);t+=4;const m=s.UINT32_BE.get(e,t);t+=4;return{type:a,format:n,description:c,width:d,height:h,colour_depth:g,indexed_color:l,data:e.slice(t,t+m)}}}const n={len:7,get:(e,t)=>({packetType:s.UINT8.get(e,t),vorbis:new s.StringType(6,"ascii").get(e,t+1)})},o={len:23,get:(e,t)=>({version:s.UINT32_LE.get(e,t+0),channelMode:s.UINT8.get(e,t+4),sampleRate:s.UINT32_LE.get(e,t+5),bitrateMax:s.UINT32_LE.get(e,t+9),bitrateNominal:s.UINT32_LE.get(e,t+13),bitrateMin:s.UINT32_LE.get(e,t+17)})}},195:(e,t,a)=>{a.d(t,{Y:()=>i});var s=a(4),r=a(74);class i{constructor(e,t){this.data=e,this.offset=t}readInt32(){const e=s.UINT32_LE.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),t=(0,r.c)(this.data.subarray(this.offset,this.offset+e),"utf-8");return this.offset+=e,t}parseUserComment(){const e=this.offset,t=this.readStringUtf8(),a=t.indexOf("=");return{key:t.substring(0,a).toUpperCase(),value:t.substring(a+1),len:this.offset-e}}}},566:(e,t,a)=>{a.r(t),a.d(t,{FlacParser:()=>p});var s=a(288),r=a(4),i=a(51),n=a(834),o=a(68),c=a(923),d=a(195),h=a(453),g=a(892);const l=s("music-metadata:parser:FLAC");class m extends((0,h.fO)("FLAC")){}class p extends n.k{constructor(){super(...arguments),this.vorbisParser=new c._(this.metadata,this.options),this.padding=0}async postId3v2Parse(){if("fLaC"!==(await this.tokenizer.readToken(o.e)).toString())throw new m("Invalid FLAC preamble");let e;do{e=await this.tokenizer.readToken(g.Tw),await this.parseDataBlock(e)}while(!e.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}async parseDataBlock(e){switch(l(`blockHeader type=${e.type}, length=${e.length}`),e.type){case g._B.STREAMINFO:return this.readBlockStreamInfo(e.length);case g._B.PADDING:this.padding+=e.length;break;case g._B.APPLICATION:case g._B.SEEKTABLE:break;case g._B.VORBIS_COMMENT:return this.readComment(e.length);case g._B.CUESHEET:break;case g._B.PICTURE:return void await this.parsePicture(e.length);default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}async readBlockStreamInfo(e){if(e!==g.om.len)throw new m("Unexpected block-stream-info length");const t=await this.tokenizer.readToken(g.om);this.metadata.setFormat("container","FLAC"),this.processsStreamInfo(t)}processsStreamInfo(e){this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("hasAudio",!0),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",e.channels),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),e.totalSamples>0&&this.metadata.setFormat("duration",e.totalSamples/e.sampleRate)}async readComment(e){const t=await this.tokenizer.readToken(new r.Uint8ArrayType(e));return this.parseComment(t)}async parseComment(e){const t=new d.Y(e,0),a=t.readStringUtf8();a.length>0&&this.metadata.setFormat("tool",a);const s=t.readInt32(),r=new Array(s);for(let e=0;e<s;e++)r[e]=t.parseUserComment();await Promise.all(r.map(e=>("ENCODER"===e.key&&this.metadata.setFormat("tool",e.value),this.addTag(e.key,e.value))))}async parsePicture(e){return this.options.skipCovers?this.tokenizer.ignore(e):this.addPictureTag(await this.tokenizer.readToken(new i.xu(e)))}addPictureTag(e){return this.addTag("METADATA_BLOCK_PICTURE",e)}addTag(e,t){return this.vorbisParser.addTag(e,t)}}},572:(e,t,a)=>{a.r(t),a.d(t,{OggContentError:()=>_,OggParser:()=>U});var s=a(4),r=a(959),i=a(288),n=a(585),o=a(923),c=a(453);class d extends((0,c.fO)("Opus")){}class h{constructor(e){if(e<19)throw new d("ID-header-page 0 should be at least 19 bytes long");this.len=e}get(e,t){return{magicSignature:new s.StringType(8,"ascii").get(e,t+0),version:s.UINT8.get(e,t+8),channelCount:s.UINT8.get(e,t+9),preSkip:s.UINT16_LE.get(e,t+10),inputSampleRate:s.UINT32_LE.get(e,t+12),outputGain:s.UINT16_LE.get(e,t+16),channelMapping:s.UINT8.get(e,t+18)}}}class g extends o._{constructor(e,t,a){super(e,t),this.idHeader=null,this.lastPos=-1,this.tokenizer=a,this.durationOnLastPage=!0}parseFirstPage(e,t){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new h(t.length).get(t,0),"OpusHead"!==this.idHeader.magicSignature)throw new d("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount),this.metadata.setAudioOnly()}async parseFullPage(e){if("OpusTags"===new s.StringType(8,"ascii").get(e,0))await this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length}calculateDuration(){if(this.lastPageHeader&&this.metadata.format.sampleRate&&this.lastPageHeader.absoluteGranulePosition>=0){const e=this.lastPageHeader.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",e),this.metadata.setFormat("duration",e/48e3),-1!==this.lastPos&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}}}var l=a(790);const m=(e,t)=>({speex:new s.StringType(8,"ascii").get(e,t+0),version:l.qW(new s.StringType(20,"ascii").get(e,t+8)),version_id:s.INT32_LE.get(e,t+28),header_size:s.INT32_LE.get(e,t+32),rate:s.INT32_LE.get(e,t+36),mode:s.INT32_LE.get(e,t+40),mode_bitstream_version:s.INT32_LE.get(e,t+44),nb_channels:s.INT32_LE.get(e,t+48),bitrate:s.INT32_LE.get(e,t+52),frame_size:s.INT32_LE.get(e,t+56),vbr:s.INT32_LE.get(e,t+60),frames_per_packet:s.INT32_LE.get(e,t+64),extra_headers:s.INT32_LE.get(e,t+68),reserved1:s.INT32_LE.get(e,t+72),reserved2:s.INT32_LE.get(e,t+76)}),p=i("music-metadata:parser:ogg:speex");class u extends o._{constructor(e,t,a){super(e,t)}parseFirstPage(e,t){p("First Ogg/Speex page");const a=m(t,0);this.metadata.setFormat("codec",`Speex ${a.version}`),this.metadata.setFormat("numberOfChannels",a.nb_channels),this.metadata.setFormat("sampleRate",a.rate),-1!==a.bitrate&&this.metadata.setFormat("bitrate",a.bitrate),this.metadata.setAudioOnly()}}const f=(e,t)=>({id:new s.StringType(7,"ascii").get(e,t),vmaj:s.UINT8.get(e,t+7),vmin:s.UINT8.get(e,t+8),vrev:s.UINT8.get(e,t+9),vmbw:s.UINT16_BE.get(e,t+10),vmbh:s.UINT16_BE.get(e,t+17),nombr:s.UINT24_BE.get(e,t+37),nqual:s.UINT8.get(e,t+40)}),T=i("music-metadata:parser:ogg:theora");class y{constructor(e,t,a){this.durationOnLastPage=!1,this.metadata=e}async parsePage(e,t){e.headerType.firstPage&&await this.parseFirstPage(e,t)}calculateDuration(){T("duration calculation not implemented")}async parseFirstPage(e,t){T("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const a=f(t,0);this.metadata.setFormat("bitrate",a.nombr),this.metadata.setFormat("hasVideo",!0)}flush(){return Promise.resolve()}}const b={len:27,get:(e,t)=>({capturePattern:new s.StringType(4,"latin1").get(e,t),version:s.UINT8.get(e,t+4),headerType:{continued:l.mh(e,t+5,0),firstPage:l.mh(e,t+5,1),lastPage:l.mh(e,t+5,2)},absoluteGranulePosition:Number(s.UINT64_LE.get(e,t+6)),streamSerialNumber:s.UINT32_LE.get(e,t+14),pageSequenceNo:s.UINT32_LE.get(e,t+18),pageChecksum:s.UINT32_LE.get(e,t+22),page_segments:s.UINT8.get(e,t+26)})};class I{static sum(e,t,a){const s=new DataView(e.buffer,0);let r=0;for(let e=t;e<t+a;++e)r+=s.getUint8(e);return r}constructor(e){this.len=e.page_segments}get(e,t){return{totalPageSize:I.sum(e,t,this.len)}}}var w=a(892),k=a(566),P=a(68),v=a(51);const N=i("music-metadata:parser:ogg:theora");class S{constructor(e,t,a){this.durationOnLastPage=!1,this.metadata=e,this.options=t,this.tokenizer=a,this.flacParser=new k.FlacParser(this.metadata,this.tokenizer,t)}async parsePage(e,t){e.headerType.firstPage&&await this.parseFirstPage(e,t)}calculateDuration(){N("duration calculation not implemented")}async parseFirstPage(e,t){N("First Ogg/FLAC page");if("fLaC"!==(await P.e.get(t,9)).toString())throw new Error("Invalid FLAC preamble");const a=await w.Tw.get(t,13);await this.parseDataBlock(a,t.subarray(13+w.Tw.len))}async parseDataBlock(e,t){switch(N(`blockHeader type=${e.type}, length=${e.length}`),e.type){case w._B.STREAMINFO:{const e=w.om.get(t,0);return this.flacParser.processsStreamInfo(e)}case w._B.PADDING:case w._B.APPLICATION:case w._B.SEEKTABLE:break;case w._B.VORBIS_COMMENT:return this.flacParser.parseComment(t);case w._B.PICTURE:if(!this.options.skipCovers){const e=new v.xu(t.length).get(t,0);return this.flacParser.addPictureTag(e)}break;default:this.metadata.addWarning(`Unknown block type: ${e.type}`)}return this.tokenizer.ignore(e.length).then()}flush(){return Promise.resolve()}}class _ extends((0,c.fO)("Ogg")){}const E=i("music-metadata:parser:ogg");class C{constructor(e,t,a){this.pageNumber=0,this.closed=!1,this.metadata=e,this.streamSerial=t,this.options=a}async parsePage(e,t){this.pageNumber=t.pageSequenceNo,E("serial=%s page#=%s, Ogg.id=%s",t.streamSerialNumber,t.pageSequenceNo,t.capturePattern);const a=await e.readToken(new I(t));E("totalPageSize=%s",a.totalPageSize);const r=await e.readToken(new s.Uint8ArrayType(a.totalPageSize));if(E("firstPage=%s, lastPage=%s, continued=%s",t.headerType.firstPage,t.headerType.lastPage,t.headerType.continued),t.headerType.firstPage){this.metadata.setFormat("container","Ogg");const a=r.subarray(0,7),s=Array.from(a).filter(e=>e>=32&&e<=126).map(e=>String.fromCharCode(e)).join("");switch(s){case"vorbis":E(`Set Ogg stream serial ${t.streamSerialNumber}, codec=Vorbis`),this.pageConsumer=new o._(this.metadata,this.options);break;case"OpusHea":E("Set page consumer to Ogg/Opus"),this.pageConsumer=new g(this.metadata,this.options,e);break;case"Speex  ":E("Set page consumer to Ogg/Speex"),this.pageConsumer=new u(this.metadata,this.options,e);break;case"fishead":case"theora":E("Set page consumer to Ogg/Theora"),this.pageConsumer=new y(this.metadata,this.options,e);break;case"FLAC":E("Set page consumer to Vorbis"),this.pageConsumer=new S(this.metadata,this.options,e);break;default:throw new _(`Ogg codec not recognized (id=${s}`)}}if(t.headerType.lastPage&&(this.closed=!0),!this.pageConsumer)throw new Error("pageConsumer should be initialized");await this.pageConsumer.parsePage(t,r)}}class U extends n.s{constructor(){super(...arguments),this.streams=new Map}async parse(){let e;this.streams=new Map;try{do{if(e=await this.tokenizer.readToken(b),"OggS"!==e.capturePattern)throw new _("Invalid Ogg capture pattern");let t=this.streams.get(e.streamSerialNumber);if(t||(t=new C(this.metadata,e.streamSerialNumber,this.options),this.streams.set(e.streamSerialNumber,t)),await t.parsePage(this.tokenizer,e),t.pageNumber>12&&(!this.options.duration||![...this.streams.values()].find(e=>e.pageConsumer?.durationOnLastPage))){E("Stop processing Ogg stream");break}}while(![...this.streams.values()].every(e=>e.closed))}catch(e){if(e instanceof r.d1)E("Reached end-of-stream");else{if(!(e instanceof _))throw e;this.metadata.addWarning(`Corrupt Ogg content at ${this.tokenizer.position}`)}}for(const e of this.streams.values())e.closed||(this.metadata.addWarning(`End-of-stream reached before reaching last page in Ogg stream serial=${e.streamSerial}`),await(e.pageConsumer?.flush())),e.pageConsumer?.calculateDuration()}}},616:(e,t,a)=>{a.d(t,{S:()=>u});var s=a(4),r=a(790),i=a(288),n=a(198),o=a(972),c=a(453);const d=i("music-metadata:id3v2:frame-parser"),h="latin1";function g(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?o.jR[Number.parseInt(e)]:void 0}class l{constructor(e,t){this.major=e,this.warningCollector=t}readData(e,t,a){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${t}`);const{encoding:i,bom:o}=n.YF.get(e,0),c=e.length;let p=0,u=[];const f=l.getNullTerminatorLength(i);let T;switch(d(`Parsing tag type=${t}, encoding=${i}, bom=${o}`),"TXXX"!==t&&"T"===t[0]?"T*":t){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let a;try{a=r.sc(e.subarray(1),i).replace(/\x00+$/,"")}catch(e){if(e instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${t} header has invalid string value: ${e.message}`);break}throw e}switch(t){case"TMCL":case"TIPL":case"IPLS":u=l.functionList(this.splitValue(t,a));break;case"TRK":case"TRCK":case"TPOS":u=a;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":u=this.splitValue(t,a);break;case"TCO":case"TCON":u=this.splitValue(t,a).map(e=>function(e){const t=[];let a,s="";for(const r of e)if("string"==typeof a)if("("===r&&""===a)s+="(",a=void 0;else if(")"===r){""!==s&&(t.push(s),s="");const e=g(a);e&&t.push(e),a=void 0}else a+=r;else"("===r?a="":s+=r;return s&&(0===t.length&&s.match(/^\d*$/)&&(s=g(s)),s&&t.push(s)),t}(e)).reduce((e,t)=>e.concat(t),[]);break;case"PCS":case"PCST":u=this.major>=4?this.splitValue(t,a):[a],u=Array.isArray(u)&&""===u[0]?1:0;break;default:u=this.major>=4?this.splitValue(t,a):[a]}break}case"TXXX":{const a=l.readIdentifierAndData(e,p+1,c,i);u={description:a.id,text:this.splitValue(t,r.sc(a.data,i).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(a){const t={};switch(p+=1,this.major){case 2:t.format=r.sc(e.subarray(p,p+3),"latin1"),p+=3;break;case 3:case 4:T=r.sX(e,p,c,h),t.format=r.sc(e.subarray(p,T),h),p=T+1;break;default:throw function(e){throw new m(`Unexpected majorVer: ${e}`)}(this.major)}t.format=l.fixPictureMimeType(t.format),t.type=n.n5[e[p]],p+=1,T=r.sX(e,p,c,i),t.description=r.sc(e.subarray(p,T),i),p=T+f,t.data=e.subarray(p,c),u=t}break;case"CNT":case"PCNT":u=(0,r.ku)(e);break;case"SYLT":{const t=n.aY.get(e,0);p+=n.aY.len;const a={descriptor:"",language:t.language,contentType:t.contentType,timeStampFormat:t.timeStampFormat,syncText:[]};let r=!1;for(;p<c;){const i=l.readNullTerminatedString(e.subarray(p),t.encoding);if(p+=i.len,r){const t=s.UINT32_BE.get(e,p);p+=s.UINT32_BE.len,a.syncText.push({text:i.text,timestamp:t})}else a.descriptor=i.text,r=!0}u=a;break}case"ULT":case"USLT":case"COM":case"COMM":{const t=n.Jp.get(e,p);p+=n.Jp.len;const a=l.readNullTerminatedString(e.subarray(p),t.encoding);p+=a.len;const s=l.readNullTerminatedString(e.subarray(p),t.encoding);u={language:t.language,descriptor:a.text,text:s.text};break}case"UFID":{const t=l.readIdentifierAndData(e,p,c,h);u={owner_identifier:t.id,identifier:t.data};break}case"PRIV":{const t=l.readIdentifierAndData(e,p,c,h);u={owner_identifier:t.id,data:t.data};break}case"POPM":{T=r.sX(e,p,c,h);const t=r.sc(e.subarray(p,T),h);p=T+1;const a=c-p-1;u={email:t,rating:s.UINT8.get(e,p),counter:a>0?r.ku(e.subarray(p+1)):void 0};break}case"GEOB":{T=r.sX(e,p+1,c,i);const t=r.sc(e.subarray(p+1,T),h);p=T+1,T=r.sX(e,p,c,i);const a=r.sc(e.subarray(p,T),h);p=T+1,T=r.sX(e,p,c,i);const s=r.sc(e.subarray(p,T),h);p=T+1;u={type:t,filename:a,description:s,data:e.subarray(p,c)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":T=r.sX(e,p+1,c,i),u=r.sc(e.subarray(p,T),h);break;case"WXXX":{T=r.sX(e,p+1,c,i);const t=r.sc(e.subarray(p+1,T),i);p=T+("utf-16le"===i?2:1),u={description:t,url:r.sc(e.subarray(p,c),h)};break}case"WFD":case"WFED":u=r.sc(e.subarray(p+1,r.sX(e,p+1,c,i)),i);break;case"MCDI":u=e.subarray(0,c);break;default:d(`Warning: unsupported id3v2-tag-type: ${t}`)}return u}static readNullTerminatedString(e,t){let a=t.bom?2:0;const s=r.sX(e,a,e.length,t.encoding),i=e.subarray(a,s);return a="utf-16le"===t.encoding?s+2:s+1,{text:r.sc(i,t.encoding),len:a}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const t={};for(let a=0;a+1<e.length;a+=2){const s=e[a+1].split(",");t[e[a]]=t[e[a]]?t[e[a]].concat(s):s}return t}splitValue(e,t){let a;return this.major<4?(a=t.split(/\x00/g),a.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):a=t.split(/\//g)):a=t.split(/\x00/g),l.trimArray(a)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,t,a,s){const i=r.sX(e,t,a,s),n=r.sc(e.subarray(t,i),s);return t=i+l.getNullTerminatorLength(s),{id:n,data:e.subarray(t,a)}}static getNullTerminatorLength(e){return"utf-16le"===e?2:1}}class m extends((0,c.fO)("id3v2")){}var p=a(74);class u{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let t=0,a=0;for(;t<e.length-1;)t!==a&&(e[a]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,a++;return t<e.length&&(e[a++]=e[t]),e.subarray(0,a)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw f(e)}}static readFrameFlags(e){return{status:{tag_alter_preservation:r.mh(e,0,6),file_alter_preservation:r.mh(e,0,5),read_only:r.mh(e,0,4)},format:{grouping_identity:r.mh(e,1,7),compression:r.mh(e,1,3),encryption:r.mh(e,1,2),unsynchronisation:r.mh(e,1,1),data_length_indicator:r.mh(e,1,0)}}}static readFrameData(e,t,a,s,r){const i=new l(a,r);switch(a){case 2:return i.readData(e,t.id,s);case 3:case 4:return t.flags?.format.unsynchronisation&&(e=u.removeUnsyncBytes(e)),t.flags?.format.data_length_indicator&&(e=e.subarray(4,e.length)),i.readData(e,t.id,s);default:throw f(a)}}static makeDescriptionTagName(e,t){return e+(t?`:${t}`:"")}async parse(e,t,a){this.tokenizer=t,this.metadata=e,this.options=a;const s=await this.tokenizer.readToken(n.yW);if("ID3"!==s.fileIdentifier)throw new m("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(n.nl),t=e.size-n.nl.len;return t>0?this.parseExtendedHeaderData(t,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,t){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-t)}async parseId3Data(e){const t=await this.tokenizer.readToken(new s.Uint8ArrayType(e));for(const e of this.parseMetadata(t))if("TXXX"===e.id)e.value&&await this.handleTag(e,e.value.text,()=>e.value.description);else await(Array.isArray(e.value)?Promise.all(e.value.map(t=>this.addTag(e.id,t))):this.addTag(e.id,e.value))}async handleTag(e,t,a,s=e=>e){await Promise.all(t.map(t=>this.addTag(u.makeDescriptionTagName(e.id,a(t)),s(t))))}async addTag(e,t){await this.metadata.addTag(this.headerType,e,t)}parseMetadata(e){let t=0;const a=[];for(;t!==e.length;){const s=u.getFrameHeaderLength(this.id3Header.version.major);if(t+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const r=e.subarray(t,t+s);t+=s;const i=this.readFrameHeader(r,this.id3Header.version.major),n=e.subarray(t,t+i.length);t+=i.length;const o=u.readFrameData(n,i,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&a.push({id:i.id,value:o})}return a}readFrameHeader(e,t){let a;switch(t){case 2:a={id:(0,p.c)(e.subarray(0,3),"ascii"),length:s.UINT24_BE.get(e,3)},a.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${a.id}`);break;case 3:case 4:a={id:(0,p.c)(e.subarray(0,4),"ascii"),length:(4===t?n.St:s.UINT32_BE).get(e,4),flags:u.readFrameFlags(e.subarray(8,10))},a.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${a.id}`);break;default:throw f(t)}return a}}function f(e){throw new m(`Unexpected majorVer: ${e}`)}},834:(e,t,a)=>{a.d(t,{k:()=>h});var s=a(959),r=a(288),i=a(198),n=a(616),o=a(972),c=a(585);const d=r("music-metadata:parser:ID3");class h extends c.s{constructor(){super(...arguments),this.id3parser=new n.S}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(i.yW)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof s.d1))throw e;d("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),d("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new o.Bn(this.metadata,this.tokenizer,this.options);await e.parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(i.yW)).fileIdentifier)return d("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}},892:(e,t,a)=>{a.d(t,{Tw:()=>n,_B:()=>i,om:()=>o});var s=a(790),r=a(4);const i={STREAMINFO:0,PADDING:1,APPLICATION:2,SEEKTABLE:3,VORBIS_COMMENT:4,CUESHEET:5,PICTURE:6},n={len:4,get:(e,t)=>({lastBlock:s.mh(e,t,7),type:s.f5(e,t,1,7),length:r.UINT24_BE.get(e,t+1)})},o={len:34,get:(e,t)=>({minimumBlockSize:r.UINT16_BE.get(e,t),maximumBlockSize:r.UINT16_BE.get(e,t+2)/1e3,minimumFrameSize:r.UINT24_BE.get(e,t+4),maximumFrameSize:r.UINT24_BE.get(e,t+7),sampleRate:r.UINT24_BE.get(e,t+10)>>4,channels:s.f5(e,t+12,4,3)+1,bitsPerSample:s.f5(e,t+12,7,5)+1,totalSamples:s.f5(e,t+13,4,36),fileMD5:new r.Uint8ArrayType(16).get(e,t+18)})}},923:(e,t,a)=>{a.d(t,{_:()=>h});var s=a(4),r=a(288),i=a(195),n=a(51),o=a(453);const c=r("music-metadata:parser:ogg:vorbis1");class d extends((0,o.fO)("Vorbis")){}class h{constructor(e,t){this.pageSegments=[],this.durationOnLastPage=!0,this.metadata=e,this.options=t}async parsePage(e,t){if(this.lastPageHeader=e,e.headerType.firstPage)this.parseFirstPage(e,t);else{if(e.headerType.continued){if(0===this.pageSegments.length)throw new d("Cannot continue on previous page");this.pageSegments.push(t)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const e=h.mergeUint8Arrays(this.pageSegments);await this.parseFullPage(e)}this.pageSegments=e.headerType.lastPage?[]:[t]}}}static mergeUint8Arrays(e){const t=e.reduce((e,t)=>e+t.length,0),a=new Uint8Array(t);return e.forEach((e,t,s)=>{const r=s.slice(0,t).reduce((e,t)=>e+t.length,0);a.set(e,r)}),a}async flush(){await this.parseFullPage(h.mergeUint8Arrays(this.pageSegments))}async parseUserComment(e,t){const a=new i.Y(e,t).parseUserComment();return await this.addTag(a.key,a.value),a.len}async addTag(e,t){if("METADATA_BLOCK_PICTURE"===e&&"string"==typeof t){if(this.options.skipCovers)return void c("Ignore picture");t=n.xu.fromBase64(t),c(`Push picture: id=${e}, format=${t.format}`)}else c(`Push tag: id=${e}, value=${t}`);await this.metadata.addTag("vorbis",e,t)}calculateDuration(){this.lastPageHeader&&this.metadata.format.sampleRate&&this.lastPageHeader.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",this.lastPageHeader.absoluteGranulePosition),this.metadata.setFormat("duration",this.lastPageHeader.absoluteGranulePosition/this.metadata.format.sampleRate))}parseFirstPage(e,t){this.metadata.setFormat("codec","Vorbis I"),this.metadata.setFormat("hasAudio",!0),c("Parse first page");const a=n.Z.get(t,0);if("vorbis"!==a.vorbis)throw new d("Metadata does not look like Vorbis");if(1!==a.packetType)throw new d("First Ogg page should be type 1: the identification header");{const e=n.Sl.get(t,n.Z.len);this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("bitrate",e.bitrateNominal),this.metadata.setFormat("numberOfChannels",e.channelMode),c("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",e.sampleRate,e.bitrateNominal,e.channelMode)}}async parseFullPage(e){const t=n.Z.get(e,0);if(c("Parse full page: type=%s, byteLength=%s",t.packetType,e.byteLength),3===t.packetType)return this.parseUserCommentList(e,n.Z.len)}async parseUserCommentList(e,t){const a=s.UINT32_LE.get(e,t);t+=4,t+=a;let r=s.UINT32_LE.get(e,t);for(t+=4;r-- >0;)t+=await this.parseUserComment(e,t)}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[509],{509:(e,t,a)=>{a.r(t),a.d(t,{MP4Parser:()=>Y});var s=a(288),n=a(4),r=a(585),i=a(972),o=a(68),l=a(453),c=a(790);const h=s("music-metadata:parser:MP4:atom");class d extends((0,l.fO)("MP4")){}const m={len:8,get:(e,t)=>{const a=n.UINT32_BE.get(e,t);if(a<0)throw new d("Invalid atom header length");return{length:BigInt(a),name:new n.StringType(4,"latin1").get(e,t+4)}},put:(e,t,a)=>(n.UINT32_BE.put(e,t,Number(a.length)),o.e.put(e,t+4,a.name))},g=n.UINT64_BE,u={len:4,get:(e,t)=>({type:new n.StringType(4,"ascii").get(e,t)})};class p{constructor(e,t,a){if(e<t)throw new d(`Atom ${a} expected to be ${t}, but specifies ${e} bytes long.`);e>t&&h(`Warning: atom ${a} expected to be ${t}, but was actually ${e} bytes long.`),this.len=e}}const f=(e,t)=>{const a=n.UINT32_BE.get(e,t)-2082844800;return new Date(1e3*a)};class T extends p{constructor(e){super(e,24,"mdhd")}get(e,t){return{version:n.UINT8.get(e,t+0),flags:n.UINT24_BE.get(e,t+1),creationTime:f(e,t+4),modificationTime:f(e,t+8),timeScale:n.UINT32_BE.get(e,t+12),duration:n.UINT32_BE.get(e,t+16),language:n.UINT16_BE.get(e,t+20),quality:n.UINT16_BE.get(e,t+22)}}}class k extends p{constructor(e){super(e,100,"mvhd")}get(e,t){return{version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),creationTime:f(e,t+4),modificationTime:f(e,t+8),timeScale:n.UINT32_BE.get(e,t+12),duration:n.UINT32_BE.get(e,t+16),preferredRate:n.UINT32_BE.get(e,t+20),preferredVolume:n.UINT16_BE.get(e,t+24),previewTime:n.UINT32_BE.get(e,t+72),previewDuration:n.UINT32_BE.get(e,t+76),posterTime:n.UINT32_BE.get(e,t+80),selectionTime:n.UINT32_BE.get(e,t+84),selectionDuration:n.UINT32_BE.get(e,t+88),currentTime:n.UINT32_BE.get(e,t+92),nextTrackID:n.UINT32_BE.get(e,t+96)}}}class I{constructor(e){this.len=e}get(e,t){return{type:{set:n.UINT8.get(e,t+0),type:n.UINT24_BE.get(e,t+1)},locale:n.UINT24_BE.get(e,t+4),value:new n.Uint8ArrayType(this.len-8).get(e,t+8)}}}class w{constructor(e){this.len=e}get(e,t){return{version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),name:new n.StringType(this.len-4,"utf-8").get(e,t+4)}}}class N{constructor(e){this.len=e}get(e,t){return{version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),creationTime:f(e,t+4),modificationTime:f(e,t+8),trackId:n.UINT32_BE.get(e,t+12),duration:n.UINT32_BE.get(e,t+20),layer:n.UINT16_BE.get(e,t+24),alternateGroup:n.UINT16_BE.get(e,t+26),volume:n.UINT16_BE.get(e,t+28)}}}const E=8,y=(e,t)=>({version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),numberOfEntries:n.UINT32_BE.get(e,t+4)});class B{constructor(e){this.len=e}get(e,t){const a=this.len-12;return{dataFormat:o.e.get(e,t),dataReferenceIndex:n.UINT16_BE.get(e,t+10),description:a>0?new n.Uint8ArrayType(a).get(e,t+12):void 0}}}class b{constructor(e){this.len=e}get(e,t){const a=y(e,t);t+=E;const s=[];for(let r=0;r<a.numberOfEntries;++r){const a=n.UINT32_BE.get(e,t);t+=n.UINT32_BE.len,s.push(new B(a-n.UINT32_BE.len).get(e,t)),t+=a}return{header:a,table:s}}}const _={len:8,get:(e,t)=>({version:n.INT16_BE.get(e,t),revision:n.INT16_BE.get(e,t+2),vendor:n.INT32_BE.get(e,t+4)})},S={len:12,get:(e,t)=>({numAudioChannels:n.INT16_BE.get(e,t+0),sampleSize:n.INT16_BE.get(e,t+2),compressionId:n.INT16_BE.get(e,t+4),packetSize:n.INT16_BE.get(e,t+6),sampleRate:n.UINT16_BE.get(e,t+8)+n.UINT16_BE.get(e,t+10)/1e4})};class U{constructor(e,t){this.len=e,this.token=t}get(e,t){const a=n.INT32_BE.get(e,t+4);return{version:n.INT8.get(e,t+0),flags:n.INT24_BE.get(e,t+1),numberOfEntries:a,entries:x(e,this.token,t+8,this.len-8,a)}}}const z={len:8,get:(e,t)=>({count:n.INT32_BE.get(e,t+0),duration:n.INT32_BE.get(e,t+4)})};class P extends U{constructor(e){super(e,z)}}const v={len:12,get:(e,t)=>({firstChunk:n.INT32_BE.get(e,t),samplesPerChunk:n.INT32_BE.get(e,t+4),sampleDescriptionId:n.INT32_BE.get(e,t+8)})};class C extends U{constructor(e){super(e,v)}}class ${constructor(e){this.len=e}get(e,t){const a=n.INT32_BE.get(e,t+8);return{version:n.INT8.get(e,t),flags:n.INT24_BE.get(e,t+1),sampleSize:n.INT32_BE.get(e,t+4),numberOfEntries:a,entries:x(e,n.INT32_BE,t+12,this.len-12,a)}}}class A extends U{constructor(e){super(e,n.INT32_BE),this.len=e}}class D{constructor(e){this.len=e}get(e,t){const a=n.INT16_BE.get(e,t+0);return new n.StringType(a,"utf-8").get(e,t+2)}}function x(e,t,a,s,n){if(h(`remainingLen=${s}, numberOfEntries=${n} * token-len=${t.len}`),0===s)return[];if(s!==n*t.len)throw new d("mismatch number-of-entries with remaining atom-length");const r=[];for(let s=0;s<n;++s)r.push(t.get(e,a)),a+=t.len;return r}class F{constructor(e){this.len=e}get(e,t){const a=t+1,s={version:n.INT8.get(e,t),flags:{baseDataOffsetPresent:c.mh(e,a+2,0),sampleDescriptionIndexPresent:c.mh(e,a+2,1),defaultSampleDurationPresent:c.mh(e,a+2,3),defaultSampleSizePresent:c.mh(e,a+2,4),defaultSampleFlagsPresent:c.mh(e,a+2,5),defaultDurationIsEmpty:c.mh(e,a,0),defaultBaseIsMoof:c.mh(e,a,1)},trackId:n.UINT32_BE.get(e,4)};let r=8;return s.flags.baseDataOffsetPresent&&(s.baseDataOffset=n.UINT64_BE.get(e,r),r+=8),s.flags.sampleDescriptionIndexPresent&&(s.sampleDescriptionIndex=n.UINT32_BE.get(e,r),r+=4),s.flags.defaultSampleDurationPresent&&(s.defaultSampleDuration=n.UINT32_BE.get(e,r),r+=4),s.flags.defaultSampleSizePresent&&(s.defaultSampleSize=n.UINT32_BE.get(e,r),r+=4),s.flags.defaultSampleFlagsPresent&&(s.defaultSampleFlags=n.UINT32_BE.get(e,r)),s}}class O{constructor(e){this.len=e}get(e,t){const a=t+1,s={version:n.INT8.get(e,t),flags:{dataOffsetPresent:c.mh(e,a+2,0),firstSampleFlagsPresent:c.mh(e,a+2,2),sampleDurationPresent:c.mh(e,a+1,0),sampleSizePresent:c.mh(e,a+1,1),sampleFlagsPresent:c.mh(e,a+1,2),sampleCompositionTimeOffsetsPresent:c.mh(e,a+1,3)},sampleCount:n.UINT32_BE.get(e,t+4),samples:[]};let r=t+8;s.flags.dataOffsetPresent&&(s.dataOffset=n.UINT32_BE.get(e,r),r+=4),s.flags.firstSampleFlagsPresent&&(s.firstSampleFlags=n.UINT32_BE.get(e,r),r+=4);for(let t=0;t<s.sampleCount;++t){if(r>=this.len){h("TrackRunBox size mismatch");break}const t={};s.flags.sampleDurationPresent&&(t.sampleDuration=n.UINT32_BE.get(e,r),r+=4),s.flags.sampleSizePresent&&(t.sampleSize=n.UINT32_BE.get(e,r),r+=4),s.flags.sampleFlagsPresent&&(t.sampleFlags=n.UINT32_BE.get(e,r),r+=4),s.flags.sampleCompositionTimeOffsetsPresent&&(t.sampleCompositionTimeOffset=n.UINT32_BE.get(e,r),r+=4),s.samples.push(t)}return s}}class L{constructor(e){this.len=e}get(e,t){const a=new n.StringType(4,"utf-8");return{version:n.INT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),componentType:a.get(e,t+4),handlerType:a.get(e,t+8),componentName:new n.StringType(this.len-28,"utf-8").get(e,t+28)}}}class M{constructor(e){this.len=e}get(e,t){let a=0;const s=[];for(;a<this.len;)s.push(n.UINT32_BE.get(e,t+a)),a+=4;return s}}const R=s("music-metadata:parser:MP4:Atom");class W{static async readAtom(e,t,a,s){const n=e.position;R(`Reading next token on offset=${n}...`);const r=await e.readToken(m),i=1n===r.length;i&&(r.length=await e.readToken(g));const o=new W(r,i,a),l=o.getPayloadLength(s);return R(`parse atom name=${o.atomPath}, extended=${o.extended}, offset=${n}, len=${o.header.length}`),await o.readData(e,t,l),o}constructor(e,t,a){this.header=e,this.extended=t,this.parent=a,this.children=[],this.atomPath=(this.parent?`${this.parent.atomPath}.`:"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(0n===this.header.length?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,t,a){for(;a>0;){const s=await W.readAtom(e,t,this,a);this.children.push(s),a-=0n===s.header.length?a:Number(s.header.length)}}async readData(e,t,a){switch(this.header.name){case"moov":case"udta":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":case"moof":return this.readAtoms(e,t,this.getPayloadLength(a));case"meta":{const s="hdlr"===(await e.peekToken(m)).name?0:4;return await e.ignore(s),this.readAtoms(e,t,this.getPayloadLength(a)-s)}default:return t(this,a)}}}var V=a(738),j=a(946),q=a(74);const G=s("music-metadata:parser:MP4"),H={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function Q(e,t,a){return a.indexOf(e)===t}class Y extends r.s{constructor(){super(...arguments),this.tracks=new Map,this.hasVideoTrack=!1,this.hasAudioTrack=!0,this.atomParsers={mvhd:async e=>{const t=await this.tokenizer.readToken(new k(e));this.metadata.setFormat("creationTime",t.creationTime),this.metadata.setFormat("modificationTime",t.modificationTime)},chap:async e=>{const t=this.getTrackDescription(),a=[];for(;e>=n.UINT32_BE.len;)a.push(await this.tokenizer.readNumber(n.UINT32_BE)),e-=n.UINT32_BE.len;t.chapterList=a},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const t=[...this.tracks.values()].filter(e=>e.chapterList);if(1===t.length){const a=t[0].chapterList,s=[...this.tracks.values()].filter(e=>-1!==a.indexOf(e.header.trackId));if(1===s.length)return this.parseChapterTrack(s[0],t[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const t=[];for(;e>0;){const a=await this.tokenizer.readToken(u);e-=u.len;const s=a.type.replace(/\W/g,"");s.length>0&&t.push(s)}G(`ftyp: ${t.join("/")}`);const a=t.filter(Q).join("/");this.metadata.setFormat("container",a)},stsd:async e=>{const t=await this.tokenizer.readToken(new b(e));this.getTrackDescription().soundSampleDescription=t.table.map(e=>this.parseSoundSampleDescription(e))},stsz:async e=>{const t=await this.tokenizer.readToken(new $(e)),a=this.getTrackDescription();a.sampleSize=t.sampleSize,a.sampleSizeTable=t.entries},date:async e=>{const t=await this.tokenizer.readToken(new n.StringType(e,"utf-8"));await this.addTag("date",t)}}}static read_BE_Integer(e,t){const a=(t?"INT":"UINT")+8*e.length+(e.length>1?"_BE":""),s=n[a];if(!s)throw new d(`Token for integer type not found: "${a}"`);return Number(s.get(e,0))}async parse(){this.hasVideoTrack=!1,this.hasAudioTrack=!0,this.tracks.clear();let e=this.tokenizer.fileInfo.size||0;for(;!this.tokenizer.fileInfo.size||e>0;){try{if("\0\0\0\0"===(await this.tokenizer.peekToken(m)).name){const e=`Error at offset=${this.tokenizer.position}: box.id=0`;G(e),this.addWarning(e);break}}catch(e){if(!(e instanceof Error))throw e;{const t=`Error at offset=${this.tokenizer.position}: ${e.message}`;G(t),this.addWarning(t)}break}const t=await W.readAtom(this.tokenizer,(e,t)=>this.handleAtom(e,t),null,e);e-=t.header.length===BigInt(0)?e:Number(t.header.length)}const t=[];this.tracks.forEach(e=>{const a=[];e.soundSampleDescription.forEach(e=>{const t={},s=H[e.dataFormat];if(s?(a.push(s.format),t.codecName=s.format):t.codecName=`<${e.dataFormat}>`,e.description){const{description:a}=e;a.sampleRate>0&&(t.type=V.S.audio,t.audio={samplingFrequency:a.sampleRate,bitDepth:a.sampleSize,channels:a.numAudioChannels})}this.metadata.addStreamInfo(t)}),a.length>=1&&t.push(a.join("/"))}),t.length>0&&this.metadata.setFormat("codec",t.filter(Q).join("+"));const a=[...this.tracks.values()].filter(e=>e.soundSampleDescription.length>=1&&e.soundSampleDescription[0].description&&e.soundSampleDescription[0].description.numAudioChannels>0);if(a.length>=1){const e=a[0];if(e.media.header&&e.media.header.timeScale>0)if(e.media.header.duration>0){G("Using duration defined on audio track");const t=e.media.header.duration/e.media.header.timeScale;this.metadata.setFormat("duration",t)}else if(e.fragments.length>0){G("Calculate duration defined in track fragments");let t=0;for(const a of e.fragments){const e=a.header.defaultSampleDuration;for(const s of a.trackRun.samples){const a=s.sampleDuration??e;if(null==a)throw new Error("Missing sampleDuration and no default_sample_duration in tfhd");t+=a}}this.metadata.setFormat("duration",t/e.media.header.timeScale)}const t=e.soundSampleDescription[0];if(t.description&&e.media.header&&(this.metadata.setFormat("sampleRate",t.description.sampleRate),this.metadata.setFormat("bitsPerSample",t.description.sampleSize),this.metadata.setFormat("numberOfChannels",t.description.numAudioChannels),0===e.media.header.timeScale&&e.timeToSampleTable.length>0)){const a=e.timeToSampleTable.map(e=>e.count*e.duration).reduce((e,t)=>e+t)/t.description.sampleRate;this.metadata.setFormat("duration",a)}const s=H[t.dataFormat];s&&this.metadata.setFormat("lossless",!s.lossy),this.calculateBitRate()}this.metadata.setFormat("hasAudio",this.hasAudioTrack),this.metadata.setFormat("hasVideo",this.hasVideoTrack)}async handleAtom(e,t){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e);case"moov":if("trak"===e.header.name)return this.parseTrackBox(e);break;case"moof":if("traf"===e.header.name)return this.parseTrackFragmentBox(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](t);G(`No parser for atom path=${e.atomPath}, payload-len=${t}, ignoring atom`),await this.tokenizer.ignore(t)}getTrackDescription(){const e=[...this.tracks.values()];return e[e.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}async addTag(e,t){await this.metadata.addTag("iTunes",e,t)}addWarning(e){G(`Warning: ${e}`),this.metadata.addWarning(e)}parseMetadataItemData(e){let t=e.header.name;return e.readAtoms(this.tokenizer,async(e,a)=>{const s=e.getPayloadLength(a);switch(e.header.name){case"data":return this.parseValueAtom(t,e);case"name":case"mean":case"rate":{const e=await this.tokenizer.readToken(new w(s));t+=`:${e.name}`;break}default:{const a=await this.tokenizer.readToken(new n.Uint8ArrayType(s));this.addWarning(`Unsupported meta-item: ${t}[${e.header.name}] => value=${(0,j.EY)(a)} ascii=${(0,q.c)(a,"ascii")}`)}}},e.getPayloadLength(0))}async parseValueAtom(e,t){const a=await this.tokenizer.readToken(new I(Number(t.header.length)-m.len));if(0!==a.type.set)throw new d(`Unsupported type-set != 0: ${a.type.set}`);switch(a.type.type){case 0:switch(e){case"trkn":case"disk":{const t=n.UINT8.get(a.value,3),s=n.UINT8.get(a.value,5);await this.addTag(e,`${t}/${s}`);break}case"gnre":{const t=n.UINT8.get(a.value,1),s=i.jR[t-1];await this.addTag(e,s);break}case"rate":{const t=(0,q.c)(a.value,"ascii");await this.addTag(e,t);break}default:G(`unknown proprietary value type for: ${t.atomPath}`)}break;case 1:case 18:await this.addTag(e,(0,q.c)(a.value));break;case 13:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/jpeg",data:Uint8Array.from(a.value)});break;case 14:if(this.options.skipCovers)break;await this.addTag(e,{format:"image/png",data:Uint8Array.from(a.value)});break;case 21:await this.addTag(e,Y.read_BE_Integer(a.value,!0));break;case 22:await this.addTag(e,Y.read_BE_Integer(a.value,!1));break;case 65:await this.addTag(e,n.UINT8.get(a.value,0));break;case 66:await this.addTag(e,n.UINT16_BE.get(a.value,0));break;case 67:await this.addTag(e,n.UINT32_BE.get(a.value,0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${a.type.type}`)}}async parseTrackBox(e){const t={media:{},fragments:[]};await e.readAtoms(this.tokenizer,async(e,a)=>{const s=e.getPayloadLength(a);switch(e.header.name){case"chap":{const e=await this.tokenizer.readToken(new M(a));t.chapterList=e;break}case"tkhd":t.header=await this.tokenizer.readToken(new N(s));break;case"hdlr":switch(t.handler=await this.tokenizer.readToken(new L(s)),t.handler.handlerType){case"audi":G("Contains audio track"),this.hasAudioTrack=!0;break;case"vide":G("Contains video track"),this.hasVideoTrack=!0}break;case"mdhd":{const e=await this.tokenizer.readToken(new T(s));t.media.header=e;break}case"stco":{const e=await this.tokenizer.readToken(new A(s));t.chunkOffsetTable=e.entries;break}case"stsc":{const e=await this.tokenizer.readToken(new C(s));t.sampleToChunkTable=e.entries;break}case"stsd":{const e=await this.tokenizer.readToken(new b(s));t.soundSampleDescription=e.table.map(e=>this.parseSoundSampleDescription(e));break}case"stts":{const e=await this.tokenizer.readToken(new P(s));t.timeToSampleTable=e.entries;break}case"stsz":{const e=await this.tokenizer.readToken(new $(s));t.sampleSize=e.sampleSize,t.sampleSizeTable=e.entries;break}case"dinf":case"vmhd":case"smhd":G(`Ignoring: ${e.header.name}`),await this.tokenizer.ignore(s);break;default:G(`Unexpected track box: ${e.header.name}`),await this.tokenizer.ignore(s)}},e.getPayloadLength(0)),this.tracks.set(t.header.trackId,t)}parseTrackFragmentBox(e){let t;return e.readAtoms(this.tokenizer,async(e,a)=>{const s=e.getPayloadLength(a);switch(e.header.name){case"tfhd":{const s=new F(e.getPayloadLength(a));t=await this.tokenizer.readToken(s);break}case"tfdt":await this.tokenizer.ignore(s);break;case"trun":{const e=new O(s),a=await this.tokenizer.readToken(e);if(t){const e=this.tracks.get(t.trackId);e?.fragments.push({header:t,trackRun:a})}break}default:G(`Unexpected box: ${e.header.name}`),await this.tokenizer.ignore(s)}},e.getPayloadLength(0))}parseSoundSampleDescription(e){const t={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let a=0;if(e.description){const s=_.get(e.description,a);a+=_.len,0===s.version||1===s.version?t.description=S.get(e.description,a):G(`Warning: sound-sample-description ${s} not implemented`)}return t}async parseChapterTrack(e,t,a){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const s=[];for(let n=0;n<e.chunkOffsetTable.length&&a>0;++n){const r=e.timeToSampleTable.slice(0,n).reduce((e,t)=>e+t.duration,0),i=e.chunkOffsetTable[n]-this.tokenizer.position,o=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[n];if((a-=i+o)<0)throw new d("Chapter chunk exceeding token length");await this.tokenizer.ignore(i);const l=await this.tokenizer.readToken(new D(o));G(`Chapter ${n+1}: ${l}`);const c={title:l,timeScale:e.media.header?e.media.header.timeScale:0,start:r,sampleOffset:this.findSampleOffset(t,this.tokenizer.position)};G(`Chapter title=${c.title}, offset=${c.sampleOffset}/${t.header.duration}`),s.push(c)}this.metadata.setFormat("chapters",s),await this.tokenizer.ignore(a)}findSampleOffset(e,t){let a=0;for(;a<e.chunkOffsetTable.length&&e.chunkOffsetTable[a]<t;)++a;return this.getChunkDuration(a+1,e)}getChunkDuration(e,t){let a=0,s=t.timeToSampleTable[a].count,n=t.timeToSampleTable[a].duration,r=1,i=this.getSamplesPerChunk(r,t.sampleToChunkTable),o=0;for(;r<e;){const e=Math.min(s,i);o+=e*n,s-=e,i-=e,0===i?(++r,i=this.getSamplesPerChunk(r,t.sampleToChunkTable)):(++a,s=t.timeToSampleTable[a].count,n=t.timeToSampleTable[a].duration)}return o}getSamplesPerChunk(e,t){for(let a=0;a<t.length-1;++a)if(e>=t[a].firstChunk&&e<t[a+1].firstChunk)return t[a].samplesPerChunk;return t[t.length-1].samplesPerChunk}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[177],{177:(e,t,a)=>{a.r(t),a.d(t,{MpegContentError:()=>p,MpegParser:()=>v});var s=a(4),i=a(959),r=a(288),n=a(790),o=a(834);const h=(e,t)=>{const a=n.f5(e,t,0,3),s=n.f5(e,t,6,1),i=n.f5(e,t,7,9)/10;if(a>0)return{type:n.f5(e,t,0,3),origin:n.f5(e,t,3,3),adjustment:s?-i:i}},c={len:27,get:(e,t)=>{const a=s.UINT32_BE.get(e,t+2);return{revision:n.f5(e,t,0,4),vbr_method:n.f5(e,t,4,4),lowpass_filter:100*s.UINT8.get(e,t+1),track_peak:0===a?null:a/2**23,track_gain:h(e,6),album_gain:h(e,8),music_length:s.UINT32_BE.get(e,t+20),music_crc:s.UINT8.get(e,t+24),header_crc:s.UINT16_BE.get(e,t+24)}}},d=new s.StringType(4,"ascii"),l=new s.StringType(6,"ascii"),m={len:4,get:(e,t)=>({frames:n.cD(e,t,31),bytes:n.cD(e,t,30),toc:n.cD(e,t,29),vbrScale:n.cD(e,t,28)})};var f=a(453);const u=r("music-metadata:parser:mpeg");class p extends((0,f.fO)("MPEG")){}const g={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,null,null,-1]},y=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class b{constructor(e,t){this.bitrateIndex=null,this.sampRateFreqIndex=null,this.padding=null,this.privateBit=null,this.channelModeIndex=null,this.modeExtension=null,this.isOriginalMedia=null,this.version=null,this.bitrate=null,this.samplingRate=null,this.frameLength=0,this.versionIndex=n.f5(e,t+1,3,2),this.layer=b.LayerDescription[n.f5(e,t+1,5,2)],this.versionIndex>1&&0===this.layer?this.parseAdtsHeader(e,t):this.parseMpegHeader(e,t),this.isProtectedByCRC=!n.cD(e,t+1,7)}calcDuration(e){return null==this.samplingRate?null:e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return b.samplesInFrameTable[1===this.version?0:1][this.layer]}calculateSideInfoLength(){if(3!==this.layer)return 2;if(3===this.channelModeIndex){if(1===this.version)return 17;if(2===this.version||2.5===this.version)return 9}else{if(1===this.version)return 32;if(2===this.version||2.5===this.version)return 17}return null}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,t){this.container="MPEG",this.bitrateIndex=n.f5(e,t+2,0,4),this.sampRateFreqIndex=n.f5(e,t+2,4,2),this.padding=n.cD(e,t+2,6),this.privateBit=n.cD(e,t+2,7),this.channelModeIndex=n.f5(e,t+3,0,2),this.modeExtension=n.f5(e,t+3,2,2),this.isCopyrighted=n.cD(e,t+3,4),this.isOriginalMedia=n.cD(e,t+3,5),this.emphasis=n.f5(e,t+3,7,2),this.version=b.VersionID[this.versionIndex],this.channelMode=b.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const a=this.calcBitrate();if(!a)throw new p("Cannot determine bit-rate");if(this.bitrate=1e3*a,this.samplingRate=this.calcSamplingRate(),null==this.samplingRate)throw new p("Cannot determine sampling-rate")}parseAdtsHeader(e,t){u("layer=0 => ADTS"),this.version=2===this.versionIndex?4:2,this.container=`ADTS/MPEG-${this.version}`;const a=n.f5(e,t+2,0,2);this.codec="AAC",this.codecProfile=g.AudioObjectTypes[a],u(`MPEG-4 audio-codec=${this.codec}`);const s=n.f5(e,t+2,2,4);this.samplingRate=g.SamplingFrequencies[s],u(`sampling-rate=${this.samplingRate}`);const i=n.f5(e,t+2,7,3);this.mp4ChannelConfig=y[i],u(`channel-config=${this.mp4ChannelConfig?this.mp4ChannelConfig.join("+"):"?"}`),this.frameLength=n.f5(e,t+3,6,2)<<11}calcBitrate(){if(0===this.bitrateIndex||15===this.bitrateIndex)return null;if(this.version&&this.bitrateIndex){const e=10*Math.floor(this.version)+this.layer;return b.bitrate_index[this.bitrateIndex][e]}return null}calcSamplingRate(){return 3===this.sampRateFreqIndex||null===this.version||null==this.sampRateFreqIndex?null:b.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}b.SyncByte1=255,b.SyncByte2=224,b.VersionID=[2.5,null,2,1],b.LayerDescription=[0,3,2,1],b.ChannelMode=["stereo","joint_stereo","dual_channel","mono"],b.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}},b.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}},b.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];const k=4,w=(e,t)=>new b(e,t);class v extends o.k{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.offset=0,this.frame_size=0,this.crc=null,this.calculateEofDuration=!1,this.samplesPerFrame=null,this.buf_frame_header=new Uint8Array(4),this.mpegOffset=null,this.syncPeek={buf:new Uint8Array(1024),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1),this.metadata.setAudioOnly();try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(!(e instanceof i.d1))throw e;if(u("End-of-stream"),this.calculateEofDuration&&null!==this.samplesPerFrame){const e=this.frameCount*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",e),this.metadata.format.sampleRate){const t=e/this.metadata.format.sampleRate;u(`Calculate duration at EOF: ${t} sec.`,t),this.metadata.setFormat("duration",t)}}}}finalize(){const e=this.metadata.format,t=!!this.metadata.native.ID3v1;if(null!==this.mpegOffset){if(e.duration&&this.tokenizer.fileInfo.size){const a=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0);e.codecProfile&&"V"===e.codecProfile[0]&&this.metadata.setFormat("bitrate",8*a/e.duration)}if(this.tokenizer.fileInfo.size&&"CBR"===e.codecProfile){const a=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0);if(null!==this.frame_size&&null!==this.samplesPerFrame){const t=Math.round(a/this.frame_size)*this.samplesPerFrame;if(this.metadata.setFormat("numberOfSamples",t),e.sampleRate&&!e.duration){const a=t/e.sampleRate;u("Calculate CBR duration based on file size: %s",a),this.metadata.setFormat("duration",a)}}}}}async sync(){let e=!1;for(;;){let t=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:1024,mayBeLess:!0}),this.syncPeek.len<=163)throw new i.d1;for(;;){if(e&&!(224&~this.syncPeek.buf[t]))return this.buf_frame_header[0]=b.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[t],await this.tokenizer.ignore(t),u(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(u(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),void(this.syncFrameCount=this.frameCount);if(e=!1,t=this.syncPeek.buf.indexOf(b.SyncByte1,t),-1===t){if(this.syncPeek.len<this.syncPeek.buf.length)throw new i.d1;await this.tokenizer.ignore(this.syncPeek.len);break}++t,e=!0}}}async parseCommonMpegHeader(){let e;0===this.frameCount&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header.subarray(1),{length:3});try{e=w(this.buf_frame_header,0)}catch(e){if(await this.tokenizer.ignore(1),e instanceof Error)return this.metadata.addWarning(`Parse error: ${e.message}`),!1;throw e}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,null!==e.version&&e.version>=2&&0===e.layer?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels","mono"===e.channelMode?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<2e5&&u("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const t=e.calcSlotSize();if(null===t)throw new p("invalid slot_size");const a=e.calcSamplesPerFrame();u(`samples_per_frame=${a}`);const s=a/8;if(null!==e.bitrate&&null!=e.samplingRate){const a=s*e.bitrate/e.samplingRate+(e.padding?t:0);this.frame_size=Math.floor(a)}if(this.audioFrameHeader=e,null!==e.bitrate&&this.bitrates.push(e.bitrate),1===this.frameCount)return this.offset=k,await this.skipSideInformation(),!1;if(4===this.frameCount){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=a,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&4===this.frameCount&&(this.samplesPerFrame=a,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const t=new Uint8Array(3);if(await this.tokenizer.readBuffer(t),e.frameLength+=n.f5(t,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024,null!==e.samplingRate){const t=e.samplingRate/this.samplesPerFrame,a=8*(0===this.frameCount?0:this.totalDataLength/this.frameCount)*t+.5;this.metadata.setFormat("bitrate",a),u(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${a}`)}if(await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),3===this.frameCount){if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),!this.options.duration)return!0;this.calculateEofDuration=!0}return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(s.INT16_BE),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){if(this.audioFrameHeader){const e=this.audioFrameHeader.calculateSideInfoLength();if(null!==e)return await this.tokenizer.readToken(new s.Uint8ArrayType(e)),this.offset+=e,void await this.readXtraInfoHeader()}}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(d);switch(this.offset+=d.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":{const e=await this.readXingInfoHeader();if(null!==e.vbrScale){const a=(t=e.vbrScale,`V${Math.floor((100-t)/10)}`);this.metadata.setFormat("codecProfile",a)}return null}case"Xtra":break;case"LAME":{const e=await this.tokenizer.readToken(l);if(null!==this.frame_size&&this.frame_size>=this.offset+l.len)return this.offset+=l.len,this.metadata.setFormat("tool",`LAME ${e}`),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header");break}}var t;const a=this.frame_size-this.offset;return a<0?this.metadata.addWarning(`Frame ${this.frameCount}corrupt: negative frameDataLeft`):await this.skipFrameData(a),null}async readXingInfoHeader(){const e=this.tokenizer.position,t=await async function(e){const t=await e.readToken(m),a={numFrames:null,streamSize:null,vbrScale:null};if(t.frames&&(a.numFrames=await e.readToken(s.UINT32_BE)),t.bytes&&(a.streamSize=await e.readToken(s.UINT32_BE)),t.toc&&(a.toc=new Uint8Array(100),await e.readBuffer(a.toc)),t.vbrScale&&(a.vbrScale=await e.readToken(s.UINT32_BE)),"LAME"===await e.peekToken(new s.StringType(4,"ascii"))){await e.ignore(4),a.lame={version:await e.readToken(new s.StringType(5,"ascii"))};const t=a.lame.version.match(/\d+.\d+/g);if(null!==t){const s=t[0].split(".").map(e=>Number.parseInt(e,10));s[0]>=3&&s[1]>=90&&(a.lame.extended=await e.readToken(c))}}return a}(this.tokenizer);if(this.offset+=this.tokenizer.position-e,t.lame&&(this.metadata.setFormat("tool",`LAME ${n.F6(t.lame.version)}`),t.lame.extended&&(this.metadata.setFormat("trackPeakLevel",t.lame.extended.track_peak),t.lame.extended.track_gain&&this.metadata.setFormat("trackGain",t.lame.extended.track_gain.adjustment),t.lame.extended.album_gain&&this.metadata.setFormat("albumGain",t.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",t.lame.extended.music_length/1e3))),t.streamSize&&this.audioFrameHeader&&null!==t.numFrames){const e=this.audioFrameHeader.calcDuration(t.numFrames);return this.metadata.setFormat("duration",e),u("Get duration from Xing header: %s",this.metadata.format.duration),t}const a=this.frame_size-this.offset;return await this.skipFrameData(a),t}async skipFrameData(e){if(e<0)throw new p("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const t=e[0];return e.every(e=>e===t)}}},616:(e,t,a)=>{a.d(t,{S:()=>p});var s=a(4),i=a(790),r=a(288),n=a(198),o=a(972),h=a(453);const c=r("music-metadata:id3v2:frame-parser"),d="latin1";function l(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?o.jR[Number.parseInt(e)]:void 0}class m{constructor(e,t){this.major=e,this.warningCollector=t}readData(e,t,a){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${t}`);const{encoding:r,bom:o}=n.YF.get(e,0),h=e.length;let u=0,p=[];const g=m.getNullTerminatorLength(r);let y;switch(c(`Parsing tag type=${t}, encoding=${r}, bom=${o}`),"TXXX"!==t&&"T"===t[0]?"T*":t){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let a;try{a=i.sc(e.subarray(1),r).replace(/\x00+$/,"")}catch(e){if(e instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${t} header has invalid string value: ${e.message}`);break}throw e}switch(t){case"TMCL":case"TIPL":case"IPLS":p=m.functionList(this.splitValue(t,a));break;case"TRK":case"TRCK":case"TPOS":p=a;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":p=this.splitValue(t,a);break;case"TCO":case"TCON":p=this.splitValue(t,a).map(e=>function(e){const t=[];let a,s="";for(const i of e)if("string"==typeof a)if("("===i&&""===a)s+="(",a=void 0;else if(")"===i){""!==s&&(t.push(s),s="");const e=l(a);e&&t.push(e),a=void 0}else a+=i;else"("===i?a="":s+=i;return s&&(0===t.length&&s.match(/^\d*$/)&&(s=l(s)),s&&t.push(s)),t}(e)).reduce((e,t)=>e.concat(t),[]);break;case"PCS":case"PCST":p=this.major>=4?this.splitValue(t,a):[a],p=Array.isArray(p)&&""===p[0]?1:0;break;default:p=this.major>=4?this.splitValue(t,a):[a]}break}case"TXXX":{const a=m.readIdentifierAndData(e,u+1,h,r);p={description:a.id,text:this.splitValue(t,i.sc(a.data,r).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(a){const t={};switch(u+=1,this.major){case 2:t.format=i.sc(e.subarray(u,u+3),"latin1"),u+=3;break;case 3:case 4:y=i.sX(e,u,h,d),t.format=i.sc(e.subarray(u,y),d),u=y+1;break;default:throw function(e){throw new f(`Unexpected majorVer: ${e}`)}(this.major)}t.format=m.fixPictureMimeType(t.format),t.type=n.n5[e[u]],u+=1,y=i.sX(e,u,h,r),t.description=i.sc(e.subarray(u,y),r),u=y+g,t.data=e.subarray(u,h),p=t}break;case"CNT":case"PCNT":p=(0,i.ku)(e);break;case"SYLT":{const t=n.aY.get(e,0);u+=n.aY.len;const a={descriptor:"",language:t.language,contentType:t.contentType,timeStampFormat:t.timeStampFormat,syncText:[]};let i=!1;for(;u<h;){const r=m.readNullTerminatedString(e.subarray(u),t.encoding);if(u+=r.len,i){const t=s.UINT32_BE.get(e,u);u+=s.UINT32_BE.len,a.syncText.push({text:r.text,timestamp:t})}else a.descriptor=r.text,i=!0}p=a;break}case"ULT":case"USLT":case"COM":case"COMM":{const t=n.Jp.get(e,u);u+=n.Jp.len;const a=m.readNullTerminatedString(e.subarray(u),t.encoding);u+=a.len;const s=m.readNullTerminatedString(e.subarray(u),t.encoding);p={language:t.language,descriptor:a.text,text:s.text};break}case"UFID":{const t=m.readIdentifierAndData(e,u,h,d);p={owner_identifier:t.id,identifier:t.data};break}case"PRIV":{const t=m.readIdentifierAndData(e,u,h,d);p={owner_identifier:t.id,data:t.data};break}case"POPM":{y=i.sX(e,u,h,d);const t=i.sc(e.subarray(u,y),d);u=y+1;const a=h-u-1;p={email:t,rating:s.UINT8.get(e,u),counter:a>0?i.ku(e.subarray(u+1)):void 0};break}case"GEOB":{y=i.sX(e,u+1,h,r);const t=i.sc(e.subarray(u+1,y),d);u=y+1,y=i.sX(e,u,h,r);const a=i.sc(e.subarray(u,y),d);u=y+1,y=i.sX(e,u,h,r);const s=i.sc(e.subarray(u,y),d);u=y+1;p={type:t,filename:a,description:s,data:e.subarray(u,h)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":y=i.sX(e,u+1,h,r),p=i.sc(e.subarray(u,y),d);break;case"WXXX":{y=i.sX(e,u+1,h,r);const t=i.sc(e.subarray(u+1,y),r);u=y+("utf-16le"===r?2:1),p={description:t,url:i.sc(e.subarray(u,h),d)};break}case"WFD":case"WFED":p=i.sc(e.subarray(u+1,i.sX(e,u+1,h,r)),r);break;case"MCDI":p=e.subarray(0,h);break;default:c(`Warning: unsupported id3v2-tag-type: ${t}`)}return p}static readNullTerminatedString(e,t){let a=t.bom?2:0;const s=i.sX(e,a,e.length,t.encoding),r=e.subarray(a,s);return a="utf-16le"===t.encoding?s+2:s+1,{text:i.sc(r,t.encoding),len:a}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const t={};for(let a=0;a+1<e.length;a+=2){const s=e[a+1].split(",");t[e[a]]=t[e[a]]?t[e[a]].concat(s):s}return t}splitValue(e,t){let a;return this.major<4?(a=t.split(/\x00/g),a.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):a=t.split(/\//g)):a=t.split(/\x00/g),m.trimArray(a)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,t,a,s){const r=i.sX(e,t,a,s),n=i.sc(e.subarray(t,r),s);return t=r+m.getNullTerminatorLength(s),{id:n,data:e.subarray(t,a)}}static getNullTerminatorLength(e){return"utf-16le"===e?2:1}}class f extends((0,h.fO)("id3v2")){}var u=a(74);class p{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let t=0,a=0;for(;t<e.length-1;)t!==a&&(e[a]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,a++;return t<e.length&&(e[a++]=e[t]),e.subarray(0,a)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw g(e)}}static readFrameFlags(e){return{status:{tag_alter_preservation:i.mh(e,0,6),file_alter_preservation:i.mh(e,0,5),read_only:i.mh(e,0,4)},format:{grouping_identity:i.mh(e,1,7),compression:i.mh(e,1,3),encryption:i.mh(e,1,2),unsynchronisation:i.mh(e,1,1),data_length_indicator:i.mh(e,1,0)}}}static readFrameData(e,t,a,s,i){const r=new m(a,i);switch(a){case 2:return r.readData(e,t.id,s);case 3:case 4:return t.flags?.format.unsynchronisation&&(e=p.removeUnsyncBytes(e)),t.flags?.format.data_length_indicator&&(e=e.subarray(4,e.length)),r.readData(e,t.id,s);default:throw g(a)}}static makeDescriptionTagName(e,t){return e+(t?`:${t}`:"")}async parse(e,t,a){this.tokenizer=t,this.metadata=e,this.options=a;const s=await this.tokenizer.readToken(n.yW);if("ID3"!==s.fileIdentifier)throw new f("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(n.nl),t=e.size-n.nl.len;return t>0?this.parseExtendedHeaderData(t,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,t){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-t)}async parseId3Data(e){const t=await this.tokenizer.readToken(new s.Uint8ArrayType(e));for(const e of this.parseMetadata(t))if("TXXX"===e.id)e.value&&await this.handleTag(e,e.value.text,()=>e.value.description);else await(Array.isArray(e.value)?Promise.all(e.value.map(t=>this.addTag(e.id,t))):this.addTag(e.id,e.value))}async handleTag(e,t,a,s=e=>e){await Promise.all(t.map(t=>this.addTag(p.makeDescriptionTagName(e.id,a(t)),s(t))))}async addTag(e,t){await this.metadata.addTag(this.headerType,e,t)}parseMetadata(e){let t=0;const a=[];for(;t!==e.length;){const s=p.getFrameHeaderLength(this.id3Header.version.major);if(t+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.subarray(t,t+s);t+=s;const r=this.readFrameHeader(i,this.id3Header.version.major),n=e.subarray(t,t+r.length);t+=r.length;const o=p.readFrameData(n,r,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&a.push({id:r.id,value:o})}return a}readFrameHeader(e,t){let a;switch(t){case 2:a={id:(0,u.c)(e.subarray(0,3),"ascii"),length:s.UINT24_BE.get(e,3)},a.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${a.id}`);break;case 3:case 4:a={id:(0,u.c)(e.subarray(0,4),"ascii"),length:(4===t?n.St:s.UINT32_BE).get(e,4),flags:p.readFrameFlags(e.subarray(8,10))},a.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${a.id}`);break;default:throw g(t)}return a}}function g(e){throw new f(`Unexpected majorVer: ${e}`)}},834:(e,t,a)=>{a.d(t,{k:()=>d});var s=a(959),i=a(288),r=a(198),n=a(616),o=a(972),h=a(585);const c=i("music-metadata:parser:ID3");class d extends h.s{constructor(){super(...arguments),this.id3parser=new n.S}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(r.yW)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof s.d1))throw e;c("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),c("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new o.Bn(this.metadata,this.tokenizer,this.options);await e.parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(r.yW)).fileIdentifier)return c("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[283],{283:(e,a,t)=>{t.r(a),t.d(a,{DsdContentParseError:()=>u,DsfParser:()=>p});var s=t(288),r=t(834),i=t(4),n=t(68);const o={len:12,get:(e,a)=>({id:n.e.get(e,a),size:i.UINT64_LE.get(e,a+4)})},d={len:16,get:(e,a)=>({fileSize:i.INT64_LE.get(e,a),metadataPointer:i.INT64_LE.get(e,a+8)})},c={len:40,get:(e,a)=>({formatVersion:i.INT32_LE.get(e,a),formatID:i.INT32_LE.get(e,a+4),channelType:i.INT32_LE.get(e,a+8),channelNum:i.INT32_LE.get(e,a+12),samplingFrequency:i.INT32_LE.get(e,a+16),bitsPerSample:i.INT32_LE.get(e,a+20),sampleCount:i.INT64_LE.get(e,a+24),blockSizePerChannel:i.INT32_LE.get(e,a+32)})};var h=t(616),l=t(453);const m=s("music-metadata:parser:DSF");class u extends((0,l.fO)("DSD")){}class p extends r.k{async postId3v2Parse(){const e=this.tokenizer.position,a=await this.tokenizer.readToken(o);if("DSD "!==a.id)throw new u("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0),this.metadata.setAudioOnly();const t=await this.tokenizer.readToken(d);if(t.metadataPointer!==BigInt(0))return m(`expect ID3v2 at offset=${t.metadataPointer}`),await this.parseChunks(t.fileSize-a.size),await this.tokenizer.ignore(Number(t.metadataPointer)-this.tokenizer.position-e),(new h.S).parse(this.metadata,this.tokenizer,this.options);m("No ID3v2 tag present")}async parseChunks(e){for(;e>=o.len;){const a=await this.tokenizer.readToken(o);if(m(`Parsing chunk name=${a.id} size=${a.size}`),"fmt "===a.id){const e=await this.tokenizer.readToken(c);this.metadata.setFormat("numberOfChannels",e.channelNum),this.metadata.setFormat("sampleRate",e.samplingFrequency),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("numberOfSamples",e.sampleCount),this.metadata.setFormat("duration",Number(e.sampleCount)/e.samplingFrequency);const a=e.bitsPerSample*e.samplingFrequency*e.channelNum;return void this.metadata.setFormat("bitrate",a)}this.tokenizer.ignore(Number(a.size)-o.len),e-=a.size}}}},616:(e,a,t)=>{t.d(a,{S:()=>g});var s=t(4),r=t(790),i=t(288),n=t(198),o=t(972),d=t(453);const c=i("music-metadata:id3v2:frame-parser"),h="latin1";function l(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?o.jR[Number.parseInt(e)]:void 0}class m{constructor(e,a){this.major=e,this.warningCollector=a}readData(e,a,t){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${a}`);const{encoding:i,bom:o}=n.YF.get(e,0),d=e.length;let p=0,g=[];const f=m.getNullTerminatorLength(i);let y;switch(c(`Parsing tag type=${a}, encoding=${i}, bom=${o}`),"TXXX"!==a&&"T"===a[0]?"T*":a){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let t;try{t=r.sc(e.subarray(1),i).replace(/\x00+$/,"")}catch(e){if(e instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${a} header has invalid string value: ${e.message}`);break}throw e}switch(a){case"TMCL":case"TIPL":case"IPLS":g=m.functionList(this.splitValue(a,t));break;case"TRK":case"TRCK":case"TPOS":g=t;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":g=this.splitValue(a,t);break;case"TCO":case"TCON":g=this.splitValue(a,t).map(e=>function(e){const a=[];let t,s="";for(const r of e)if("string"==typeof t)if("("===r&&""===t)s+="(",t=void 0;else if(")"===r){""!==s&&(a.push(s),s="");const e=l(t);e&&a.push(e),t=void 0}else t+=r;else"("===r?t="":s+=r;return s&&(0===a.length&&s.match(/^\d*$/)&&(s=l(s)),s&&a.push(s)),a}(e)).reduce((e,a)=>e.concat(a),[]);break;case"PCS":case"PCST":g=this.major>=4?this.splitValue(a,t):[t],g=Array.isArray(g)&&""===g[0]?1:0;break;default:g=this.major>=4?this.splitValue(a,t):[t]}break}case"TXXX":{const t=m.readIdentifierAndData(e,p+1,d,i);g={description:t.id,text:this.splitValue(a,r.sc(t.data,i).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(t){const a={};switch(p+=1,this.major){case 2:a.format=r.sc(e.subarray(p,p+3),"latin1"),p+=3;break;case 3:case 4:y=r.sX(e,p,d,h),a.format=r.sc(e.subarray(p,y),h),p=y+1;break;default:throw function(e){throw new u(`Unexpected majorVer: ${e}`)}(this.major)}a.format=m.fixPictureMimeType(a.format),a.type=n.n5[e[p]],p+=1,y=r.sX(e,p,d,i),a.description=r.sc(e.subarray(p,y),i),p=y+f,a.data=e.subarray(p,d),g=a}break;case"CNT":case"PCNT":g=(0,r.ku)(e);break;case"SYLT":{const a=n.aY.get(e,0);p+=n.aY.len;const t={descriptor:"",language:a.language,contentType:a.contentType,timeStampFormat:a.timeStampFormat,syncText:[]};let r=!1;for(;p<d;){const i=m.readNullTerminatedString(e.subarray(p),a.encoding);if(p+=i.len,r){const a=s.UINT32_BE.get(e,p);p+=s.UINT32_BE.len,t.syncText.push({text:i.text,timestamp:a})}else t.descriptor=i.text,r=!0}g=t;break}case"ULT":case"USLT":case"COM":case"COMM":{const a=n.Jp.get(e,p);p+=n.Jp.len;const t=m.readNullTerminatedString(e.subarray(p),a.encoding);p+=t.len;const s=m.readNullTerminatedString(e.subarray(p),a.encoding);g={language:a.language,descriptor:t.text,text:s.text};break}case"UFID":{const a=m.readIdentifierAndData(e,p,d,h);g={owner_identifier:a.id,identifier:a.data};break}case"PRIV":{const a=m.readIdentifierAndData(e,p,d,h);g={owner_identifier:a.id,data:a.data};break}case"POPM":{y=r.sX(e,p,d,h);const a=r.sc(e.subarray(p,y),h);p=y+1;const t=d-p-1;g={email:a,rating:s.UINT8.get(e,p),counter:t>0?r.ku(e.subarray(p+1)):void 0};break}case"GEOB":{y=r.sX(e,p+1,d,i);const a=r.sc(e.subarray(p+1,y),h);p=y+1,y=r.sX(e,p,d,i);const t=r.sc(e.subarray(p,y),h);p=y+1,y=r.sX(e,p,d,i);const s=r.sc(e.subarray(p,y),h);p=y+1;g={type:a,filename:t,description:s,data:e.subarray(p,d)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":y=r.sX(e,p+1,d,i),g=r.sc(e.subarray(p,y),h);break;case"WXXX":{y=r.sX(e,p+1,d,i);const a=r.sc(e.subarray(p+1,y),i);p=y+("utf-16le"===i?2:1),g={description:a,url:r.sc(e.subarray(p,d),h)};break}case"WFD":case"WFED":g=r.sc(e.subarray(p+1,r.sX(e,p+1,d,i)),i);break;case"MCDI":g=e.subarray(0,d);break;default:c(`Warning: unsupported id3v2-tag-type: ${a}`)}return g}static readNullTerminatedString(e,a){let t=a.bom?2:0;const s=r.sX(e,t,e.length,a.encoding),i=e.subarray(t,s);return t="utf-16le"===a.encoding?s+2:s+1,{text:r.sc(i,a.encoding),len:t}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const a={};for(let t=0;t+1<e.length;t+=2){const s=e[t+1].split(",");a[e[t]]=a[e[t]]?a[e[t]].concat(s):s}return a}splitValue(e,a){let t;return this.major<4?(t=a.split(/\x00/g),t.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):t=a.split(/\//g)):t=a.split(/\x00/g),m.trimArray(t)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,a,t,s){const i=r.sX(e,a,t,s),n=r.sc(e.subarray(a,i),s);return a=i+m.getNullTerminatorLength(s),{id:n,data:e.subarray(a,t)}}static getNullTerminatorLength(e){return"utf-16le"===e?2:1}}class u extends((0,d.fO)("id3v2")){}var p=t(74);class g{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let a=0,t=0;for(;a<e.length-1;)a!==t&&(e[t]=e[a]),a+=255===e[a]&&0===e[a+1]?2:1,t++;return a<e.length&&(e[t++]=e[a]),e.subarray(0,t)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw f(e)}}static readFrameFlags(e){return{status:{tag_alter_preservation:r.mh(e,0,6),file_alter_preservation:r.mh(e,0,5),read_only:r.mh(e,0,4)},format:{grouping_identity:r.mh(e,1,7),compression:r.mh(e,1,3),encryption:r.mh(e,1,2),unsynchronisation:r.mh(e,1,1),data_length_indicator:r.mh(e,1,0)}}}static readFrameData(e,a,t,s,r){const i=new m(t,r);switch(t){case 2:return i.readData(e,a.id,s);case 3:case 4:return a.flags?.format.unsynchronisation&&(e=g.removeUnsyncBytes(e)),a.flags?.format.data_length_indicator&&(e=e.subarray(4,e.length)),i.readData(e,a.id,s);default:throw f(t)}}static makeDescriptionTagName(e,a){return e+(a?`:${a}`:"")}async parse(e,a,t){this.tokenizer=a,this.metadata=e,this.options=t;const s=await this.tokenizer.readToken(n.yW);if("ID3"!==s.fileIdentifier)throw new u("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(n.nl),a=e.size-n.nl.len;return a>0?this.parseExtendedHeaderData(a,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,a){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-a)}async parseId3Data(e){const a=await this.tokenizer.readToken(new s.Uint8ArrayType(e));for(const e of this.parseMetadata(a))if("TXXX"===e.id)e.value&&await this.handleTag(e,e.value.text,()=>e.value.description);else await(Array.isArray(e.value)?Promise.all(e.value.map(a=>this.addTag(e.id,a))):this.addTag(e.id,e.value))}async handleTag(e,a,t,s=e=>e){await Promise.all(a.map(a=>this.addTag(g.makeDescriptionTagName(e.id,t(a)),s(a))))}async addTag(e,a){await this.metadata.addTag(this.headerType,e,a)}parseMetadata(e){let a=0;const t=[];for(;a!==e.length;){const s=g.getFrameHeaderLength(this.id3Header.version.major);if(a+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const r=e.subarray(a,a+s);a+=s;const i=this.readFrameHeader(r,this.id3Header.version.major),n=e.subarray(a,a+i.length);a+=i.length;const o=g.readFrameData(n,i,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&t.push({id:i.id,value:o})}return t}readFrameHeader(e,a){let t;switch(a){case 2:t={id:(0,p.c)(e.subarray(0,3),"ascii"),length:s.UINT24_BE.get(e,3)},t.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;case 3:case 4:t={id:(0,p.c)(e.subarray(0,4),"ascii"),length:(4===a?n.St:s.UINT32_BE).get(e,4),flags:g.readFrameFlags(e.subarray(8,10))},t.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;default:throw f(a)}return t}}function f(e){throw new u(`Unexpected majorVer: ${e}`)}},834:(e,a,t)=>{t.d(a,{k:()=>h});var s=t(959),r=t(288),i=t(198),n=t(616),o=t(972),d=t(585);const c=r("music-metadata:parser:ID3");class h extends d.s{constructor(){super(...arguments),this.id3parser=new n.S}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(i.yW)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof s.d1))throw e;c("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),c("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new o.Bn(this.metadata,this.tokenizer,this.options);await e.parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(i.yW)).fileIdentifier)return c("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[679],{616:(e,a,t)=>{t.d(a,{S:()=>g});var s=t(4),r=t(790),i=t(288),n=t(198),o=t(972),c=t(453);const d=i("music-metadata:id3v2:frame-parser"),l="latin1";function h(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?o.jR[Number.parseInt(e)]:void 0}class m{constructor(e,a){this.major=e,this.warningCollector=a}readData(e,a,t){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${a}`);const{encoding:i,bom:o}=n.YF.get(e,0),c=e.length;let p=0,g=[];const f=m.getNullTerminatorLength(i);let T;switch(d(`Parsing tag type=${a}, encoding=${i}, bom=${o}`),"TXXX"!==a&&"T"===a[0]?"T*":a){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let t;try{t=r.sc(e.subarray(1),i).replace(/\x00+$/,"")}catch(e){if(e instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${a} header has invalid string value: ${e.message}`);break}throw e}switch(a){case"TMCL":case"TIPL":case"IPLS":g=m.functionList(this.splitValue(a,t));break;case"TRK":case"TRCK":case"TPOS":g=t;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":g=this.splitValue(a,t);break;case"TCO":case"TCON":g=this.splitValue(a,t).map(e=>function(e){const a=[];let t,s="";for(const r of e)if("string"==typeof t)if("("===r&&""===t)s+="(",t=void 0;else if(")"===r){""!==s&&(a.push(s),s="");const e=h(t);e&&a.push(e),t=void 0}else t+=r;else"("===r?t="":s+=r;return s&&(0===a.length&&s.match(/^\d*$/)&&(s=h(s)),s&&a.push(s)),a}(e)).reduce((e,a)=>e.concat(a),[]);break;case"PCS":case"PCST":g=this.major>=4?this.splitValue(a,t):[t],g=Array.isArray(g)&&""===g[0]?1:0;break;default:g=this.major>=4?this.splitValue(a,t):[t]}break}case"TXXX":{const t=m.readIdentifierAndData(e,p+1,c,i);g={description:t.id,text:this.splitValue(a,r.sc(t.data,i).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(t){const a={};switch(p+=1,this.major){case 2:a.format=r.sc(e.subarray(p,p+3),"latin1"),p+=3;break;case 3:case 4:T=r.sX(e,p,c,l),a.format=r.sc(e.subarray(p,T),l),p=T+1;break;default:throw function(e){throw new u(`Unexpected majorVer: ${e}`)}(this.major)}a.format=m.fixPictureMimeType(a.format),a.type=n.n5[e[p]],p+=1,T=r.sX(e,p,c,i),a.description=r.sc(e.subarray(p,T),i),p=T+f,a.data=e.subarray(p,c),g=a}break;case"CNT":case"PCNT":g=(0,r.ku)(e);break;case"SYLT":{const a=n.aY.get(e,0);p+=n.aY.len;const t={descriptor:"",language:a.language,contentType:a.contentType,timeStampFormat:a.timeStampFormat,syncText:[]};let r=!1;for(;p<c;){const i=m.readNullTerminatedString(e.subarray(p),a.encoding);if(p+=i.len,r){const a=s.UINT32_BE.get(e,p);p+=s.UINT32_BE.len,t.syncText.push({text:i.text,timestamp:a})}else t.descriptor=i.text,r=!0}g=t;break}case"ULT":case"USLT":case"COM":case"COMM":{const a=n.Jp.get(e,p);p+=n.Jp.len;const t=m.readNullTerminatedString(e.subarray(p),a.encoding);p+=t.len;const s=m.readNullTerminatedString(e.subarray(p),a.encoding);g={language:a.language,descriptor:t.text,text:s.text};break}case"UFID":{const a=m.readIdentifierAndData(e,p,c,l);g={owner_identifier:a.id,identifier:a.data};break}case"PRIV":{const a=m.readIdentifierAndData(e,p,c,l);g={owner_identifier:a.id,data:a.data};break}case"POPM":{T=r.sX(e,p,c,l);const a=r.sc(e.subarray(p,T),l);p=T+1;const t=c-p-1;g={email:a,rating:s.UINT8.get(e,p),counter:t>0?r.ku(e.subarray(p+1)):void 0};break}case"GEOB":{T=r.sX(e,p+1,c,i);const a=r.sc(e.subarray(p+1,T),l);p=T+1,T=r.sX(e,p,c,i);const t=r.sc(e.subarray(p,T),l);p=T+1,T=r.sX(e,p,c,i);const s=r.sc(e.subarray(p,T),l);p=T+1;g={type:a,filename:t,description:s,data:e.subarray(p,c)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":T=r.sX(e,p+1,c,i),g=r.sc(e.subarray(p,T),l);break;case"WXXX":{T=r.sX(e,p+1,c,i);const a=r.sc(e.subarray(p+1,T),i);p=T+("utf-16le"===i?2:1),g={description:a,url:r.sc(e.subarray(p,c),l)};break}case"WFD":case"WFED":g=r.sc(e.subarray(p+1,r.sX(e,p+1,c,i)),i);break;case"MCDI":g=e.subarray(0,c);break;default:d(`Warning: unsupported id3v2-tag-type: ${a}`)}return g}static readNullTerminatedString(e,a){let t=a.bom?2:0;const s=r.sX(e,t,e.length,a.encoding),i=e.subarray(t,s);return t="utf-16le"===a.encoding?s+2:s+1,{text:r.sc(i,a.encoding),len:t}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const a={};for(let t=0;t+1<e.length;t+=2){const s=e[t+1].split(",");a[e[t]]=a[e[t]]?a[e[t]].concat(s):s}return a}splitValue(e,a){let t;return this.major<4?(t=a.split(/\x00/g),t.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):t=a.split(/\//g)):t=a.split(/\x00/g),m.trimArray(t)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,a,t,s){const i=r.sX(e,a,t,s),n=r.sc(e.subarray(a,i),s);return a=i+m.getNullTerminatorLength(s),{id:n,data:e.subarray(a,t)}}static getNullTerminatorLength(e){return"utf-16le"===e?2:1}}class u extends((0,c.fO)("id3v2")){}var p=t(74);class g{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let a=0,t=0;for(;a<e.length-1;)a!==t&&(e[t]=e[a]),a+=255===e[a]&&0===e[a+1]?2:1,t++;return a<e.length&&(e[t++]=e[a]),e.subarray(0,t)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw f(e)}}static readFrameFlags(e){return{status:{tag_alter_preservation:r.mh(e,0,6),file_alter_preservation:r.mh(e,0,5),read_only:r.mh(e,0,4)},format:{grouping_identity:r.mh(e,1,7),compression:r.mh(e,1,3),encryption:r.mh(e,1,2),unsynchronisation:r.mh(e,1,1),data_length_indicator:r.mh(e,1,0)}}}static readFrameData(e,a,t,s,r){const i=new m(t,r);switch(t){case 2:return i.readData(e,a.id,s);case 3:case 4:return a.flags?.format.unsynchronisation&&(e=g.removeUnsyncBytes(e)),a.flags?.format.data_length_indicator&&(e=e.subarray(4,e.length)),i.readData(e,a.id,s);default:throw f(t)}}static makeDescriptionTagName(e,a){return e+(a?`:${a}`:"")}async parse(e,a,t){this.tokenizer=a,this.metadata=e,this.options=t;const s=await this.tokenizer.readToken(n.yW);if("ID3"!==s.fileIdentifier)throw new u("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(n.nl),a=e.size-n.nl.len;return a>0?this.parseExtendedHeaderData(a,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,a){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-a)}async parseId3Data(e){const a=await this.tokenizer.readToken(new s.Uint8ArrayType(e));for(const e of this.parseMetadata(a))if("TXXX"===e.id)e.value&&await this.handleTag(e,e.value.text,()=>e.value.description);else await(Array.isArray(e.value)?Promise.all(e.value.map(a=>this.addTag(e.id,a))):this.addTag(e.id,e.value))}async handleTag(e,a,t,s=e=>e){await Promise.all(a.map(a=>this.addTag(g.makeDescriptionTagName(e.id,t(a)),s(a))))}async addTag(e,a){await this.metadata.addTag(this.headerType,e,a)}parseMetadata(e){let a=0;const t=[];for(;a!==e.length;){const s=g.getFrameHeaderLength(this.id3Header.version.major);if(a+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const r=e.subarray(a,a+s);a+=s;const i=this.readFrameHeader(r,this.id3Header.version.major),n=e.subarray(a,a+i.length);a+=i.length;const o=g.readFrameData(n,i,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&t.push({id:i.id,value:o})}return t}readFrameHeader(e,a){let t;switch(a){case 2:t={id:(0,p.c)(e.subarray(0,3),"ascii"),length:s.UINT24_BE.get(e,3)},t.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;case 3:case 4:t={id:(0,p.c)(e.subarray(0,4),"ascii"),length:(4===a?n.St:s.UINT32_BE).get(e,4),flags:g.readFrameFlags(e.subarray(8,10))},t.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;default:throw f(a)}return t}}function f(e){throw new u(`Unexpected majorVer: ${e}`)}},679:(e,a,t)=>{t.r(a),t.d(a,{AIFFParser:()=>g});var s=t(4),r=t(288),i=t(959),n=t(616),o=t(68),c=t(585),d=t(453);const l={NONE:"not compressed\tPCM\tApple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float\tApple Computer",alaw:"ALaw 2:1\t8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1\t8-bit ITU-T G.711 µ-law\tApple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32\tIEEE 32-bit float "};class h extends((0,d.fO)("AIFF")){}class m{constructor(e,a){this.isAifc=a;const t=a?22:18;if(e.chunkSize<t)throw new h(`COMMON CHUNK size should always be at least ${t}`);this.len=e.chunkSize}get(e,a){const t=s.UINT16_BE.get(e,a+8)-16398,r=s.UINT16_BE.get(e,a+8+2),i={numChannels:s.UINT16_BE.get(e,a),numSampleFrames:s.UINT32_BE.get(e,a+2),sampleSize:s.UINT16_BE.get(e,a+6),sampleRate:t<0?r>>Math.abs(t):r<<t};if(this.isAifc){if(i.compressionType=o.e.get(e,a+18),this.len>22){const t=s.UINT8.get(e,a+22);if(t>0){if(23+t+(t+1)%2!==this.len)throw new h("Illegal pstring length");i.compressionName=new s.StringType(t,"latin1").get(e,a+23)}else i.compressionName=void 0}}else i.compressionName="PCM";return i}}const u={len:8,get:(e,a)=>({chunkID:o.e.get(e,a),chunkSize:Number(BigInt(s.UINT32_BE.get(e,a+4)))})},p=r("music-metadata:parser:aiff");class g extends c.s{constructor(){super(...arguments),this.isCompressed=null}async parse(){if("FORM"!==(await this.tokenizer.readToken(u)).chunkID)throw new h("Invalid Chunk-ID, expected 'FORM'");const e=await this.tokenizer.readToken(o.e);switch(e){case"AIFF":this.metadata.setFormat("container",e),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw new h(`Unsupported AIFF type: ${e}`)}this.metadata.setFormat("lossless",!this.isCompressed),this.metadata.setAudioOnly();try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=u.len;){p(`Reading AIFF chunk at offset=${this.tokenizer.position}`);const e=await this.tokenizer.readToken(u),a=2*Math.round(e.chunkSize/2),t=await this.readData(e);await this.tokenizer.ignore(a-t)}}catch(e){if(!(e instanceof i.d1))throw e;p("End-of-stream")}}async readData(e){switch(e.chunkID){case"COMM":{if(null===this.isCompressed)throw new h("Failed to parse AIFF.COMM chunk when compression type is unknown");const a=await this.tokenizer.readToken(new m(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",a.sampleSize),this.metadata.setFormat("sampleRate",a.sampleRate),this.metadata.setFormat("numberOfChannels",a.numChannels),this.metadata.setFormat("numberOfSamples",a.numSampleFrames),this.metadata.setFormat("duration",a.numSampleFrames/a.sampleRate),(a.compressionName||a.compressionType)&&this.metadata.setFormat("codec",a.compressionName??l[a.compressionType]),e.chunkSize}case"ID3 ":{const a=await this.tokenizer.readToken(new s.Uint8ArrayType(e.chunkSize)),t=i.vY(a);return await(new n.S).parse(this.metadata,t,this.options),e.chunkSize}case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return p(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){const a=(await this.tokenizer.readToken(new s.StringType(e.chunkSize,"ascii"))).split("\0").map(e=>e.trim()).filter(e=>e?.length);return await Promise.all(a.map(a=>this.metadata.addTag("AIFF",e.chunkID,a))),e.chunkSize}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[695],{695:(e,a,n)=>{n.r(a),n.d(a,{MatroskaParser:()=>E});var t=n(288),i=n(585);const r=0,s=1,l=2,o=3,m=4,c=5,u={name:"dtd",container:{440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:s},17143:{name:"ebmlReadVersion",value:s},17138:{name:"ebmlMaxIDWidth",value:s},17139:{name:"ebmlMaxSizeWidth",value:s},17026:{name:"docType",value:r},17031:{name:"docTypeVersion",value:s},17029:{name:"docTypeReadVersion",value:s}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",multiple:!0,container:{21419:{name:"id",value:m},21420:{name:"position",value:s}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:l},29572:{name:"filename",value:r},3979555:{name:"prevUID",value:l},3965867:{name:"prevFilename",value:r},4110627:{name:"nextUID",value:l},4096955:{name:"nextFilename",value:r},2807729:{name:"timecodeScale",value:s},17545:{name:"duration",value:c},17505:{name:"dateUTC",value:s},31657:{name:"title",value:r},19840:{name:"muxingApp",value:r},22337:{name:"writingApp",value:r}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:l},22743:{name:"silentTracks ",multiple:!0},167:{name:"position",value:l},171:{name:"prevSize",value:l},160:{name:"blockGroup"},163:{name:"simpleBlock"}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:s},29637:{name:"uid",value:l},131:{name:"trackType",value:s},185:{name:"flagEnabled",value:o},136:{name:"flagDefault",value:o},21930:{name:"flagForced",value:o},156:{name:"flagLacing",value:o},28135:{name:"minCache",value:s},28136:{name:"maxCache",value:s},2352003:{name:"defaultDuration",value:s},2306383:{name:"timecodeScale",value:c},21358:{name:"name",value:r},2274716:{name:"language",value:r},134:{name:"codecID",value:r},25506:{name:"codecPrivate",value:m},2459272:{name:"codecName",value:r},3839639:{name:"codecSettings",value:r},3883072:{name:"codecInfoUrl",value:r},2536e3:{name:"codecDownloadUrl",value:r},170:{name:"codecDecodeAll",value:o},28587:{name:"trackOverlay",value:s},224:{name:"video",container:{154:{name:"flagInterlaced",value:o},21432:{name:"stereoMode",value:s},176:{name:"pixelWidth",value:s},186:{name:"pixelHeight",value:s},21680:{name:"displayWidth",value:s},21690:{name:"displayHeight",value:s},21683:{name:"aspectRatioType",value:s},3061028:{name:"colourSpace",value:s},3126563:{name:"gammaValue",value:c}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:c},30901:{name:"outputSamplingFrequency",value:c},159:{name:"channels",value:s},148:{name:"channels",value:s},32123:{name:"channelPositions",value:m},25188:{name:"bitDepth",value:s}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:s},20530:{name:"scope",value:o},20531:{name:"type",value:s},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:s},16981:{name:"contentCompSettings",value:m}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:s},18402:{name:"contentEncKeyID",value:m},18403:{name:"contentSignature ",value:m},18404:{name:"ContentSigKeyID  ",value:m},18405:{name:"contentSigAlgo ",value:s},18406:{name:"contentSigHashAlgo ",value:s}}},25188:{name:"bitDepth",value:s}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:l},183:{name:"positions",container:{247:{name:"track",value:s},241:{name:"clusterPosition",value:s},21368:{name:"blockNumber",value:s},234:{name:"codecState",value:s},219:{name:"reference",container:{150:{name:"time",value:s},151:{name:"cluster",value:s},21343:{name:"number",value:s},235:{name:"codecState",value:s}}},240:{name:"relativePosition",value:s}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:r},18030:{name:"name",value:r},18016:{name:"mimeType",value:r},18012:{name:"data",value:m},18094:{name:"uid",value:l}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:l},145:{name:"timeStart",value:s},146:{name:"timeEnd",value:l},152:{name:"hidden",value:o},17816:{name:"enabled",value:l},143:{name:"track",container:{137:{name:"trackNumber",value:l},128:{name:"display",container:{133:{name:"string",value:r},17276:{name:"language ",value:r},17278:{name:"country ",value:r}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:l},25540:{name:"tagChapterUID",value:s},25542:{name:"tagAttachmentUID",value:l},25546:{name:"targetType",value:r},26826:{name:"targetTypeValue",value:s},25545:{name:"tagEditionUID",value:l}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:r},17543:{name:"string",value:r},17541:{name:"binary",value:m},17530:{name:"language",value:r},17531:{name:"languageIETF",value:r},17540:{name:"default",value:o}}}}}}}}}}};var d=n(738),p=n(4),v=n(959),g=n(453);const h=t("music-metadata:parser:ebml");class f extends((0,g.fO)("EBML")){}const k=0,y=2,b=3,w=4,T=5;class I{constructor(e){this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.tokenizer=e,this.parserMap.set(s,e=>this.readUint(e)),this.parserMap.set(r,e=>this.readString(e)),this.parserMap.set(m,e=>this.readBuffer(e)),this.parserMap.set(l,async e=>this.readBuffer(e)),this.parserMap.set(o,e=>this.readFlag(e)),this.parserMap.set(c,e=>this.readFloat(e))}async iterate(e,a,n){return this.parseContainer(S(e),a,n)}async parseContainer(e,a,n){const t={};for(;this.tokenizer.position<a;){let i;const r=this.tokenizer.position;try{i=await this.readElement()}catch(e){if(e instanceof v.d1)break;throw e}const s=e.container[i.id];if(s){switch(n.startNext(s)){case k:if(i.id,h(`Read element: name=${x(s)}{id=0x${i.id.toString(16)}, container=${!!s.container}} at position=${r}`),s.container){const e=await this.parseContainer(s,i.len>=0?this.tokenizer.position+i.len:-1,n);s.multiple?(t[s.name]||(t[s.name]=[]),t[s.name].push(e)):t[s.name]=e,await n.elementValue(s,e,r)}else{const e=this.parserMap.get(s.value);if("function"==typeof e){const a=await e(i);t[s.name]=a,await n.elementValue(s,a,r)}}break;case T:h(`Go to next element: name=${x(s)}, element.id=0x${i.id}, container=${!!s.container} at position=${r}`);break;case y:h(`Ignore element: name=${x(s)}, element.id=0x${i.id}, container=${!!s.container} at position=${r}`),await this.tokenizer.ignore(i.len);break;case b:h(`Ignore remaining container, at: name=${x(s)}, element.id=0x${i.id}, container=${!!s.container} at position=${r}`),await this.tokenizer.ignore(a-this.tokenizer.position);break;case w:return h(`Terminate parsing at element: name=${x(s)}, element.id=0x${i.id}, container=${!!s.container} at position=${r}`),t}}else if(236===i.id)this.padding+=i.len,await this.tokenizer.ignore(i.len);else h(`parseEbml: parent=${x(e)}, unknown child: id=${i.id.toString(16)} at position=${r}`),this.padding+=i.len,await this.tokenizer.ignore(i.len)}return t}async readVintData(e){const a=await this.tokenizer.peekNumber(p.UINT8);let n=128,t=1;for(;0===(a&n);){if(t>e)throw new f("VINT value exceeding maximum size");++t,n>>=1}const i=new Uint8Array(t);return await this.tokenizer.readBuffer(i),i}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),a=await this.readVintData(this.ebmlMaxSizeLength);return a[0]^=128>>a.length-1,{id:$(e,e.length),len:$(a,a.length)}}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(p.Float32_BE);case 8:case 10:return this.tokenizer.readNumber(p.Float64_BE);default:throw new f(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return 1===await this.readUint(e)}async readUint(e){return $(await this.readBuffer(e),e.len)}async readString(e){return(await this.tokenizer.readToken(new p.StringType(e.len,"utf-8"))).replace(/\x00.*$/g,"")}async readBuffer(e){const a=new Uint8Array(e.len);return await this.tokenizer.readBuffer(a),a}}function $(e,a){return Number(function(e,a){const n=new Uint8Array(8),t=e.subarray(0,a);try{return n.set(t,8-a),p.UINT64_BE.get(n,0)}catch(e){return BigInt(-1)}}(e,a))}function S(e){return e.container&&Object.keys(e.container).map(a=>{const n=e.container[a];return n.id=Number.parseInt(a),n}).forEach(a=>{a.parent=e,S(a)}),e}function x(e){let a="";return e.parent&&"dtd"!==e.parent.name&&(a+=`${x(e.parent)}/`),a+e.name}const D=t("music-metadata:parser:matroska");class E extends i.s{constructor(){super(...arguments),this.seekHeadOffset=0,this.flagUseIndexToSkipClusters=this.options.mkvUseIndex??!1}async parse(){const e=this.tokenizer.fileInfo.size??Number.MAX_SAFE_INTEGER,a=new I(this.tokenizer);D("Initializing DTD end MatroskaIterator"),await a.iterate(u,e,{startNext:e=>{switch(e.id){case 475249515:return D(`Skip element: name=${e.name}, id=0x${e.id.toString(16)}`),y;case 524531317:if(this.flagUseIndexToSkipClusters&&this.seekHead){const e=this.seekHead.seek.find(e=>e.position+this.seekHeadOffset>this.tokenizer.position);if(e){const a=e.position+this.seekHeadOffset-this.tokenizer.position;return D(`Use index to go to next position, ignoring ${a} bytes`),this.tokenizer.ignore(a),T}}return y;default:return k}},elementValue:async(e,a,n)=>{switch(D(`Received: name=${e.name}, value=${a}`),e.id){case 17026:this.metadata.setFormat("container",`EBML/${a}`);break;case 290298740:this.seekHead=a,this.seekHeadOffset=n;break;case 357149030:{const e=a,n=e.timecodeScale?e.timecodeScale:1e6;if("number"==typeof e.duration){const a=e.duration*n/1e9;await this.addTag("segment:title",e.title),this.metadata.setFormat("duration",Number(a))}}break;case 374648427:{const e=a;if(e?.entries){e.entries.forEach(e=>{const a={codecName:e.codecID.replace("A_","").replace("V_",""),codecSettings:e.codecSettings,flagDefault:e.flagDefault,flagLacing:e.flagLacing,flagEnabled:e.flagEnabled,language:e.language,name:e.name,type:e.trackType,audio:e.audio,video:e.video};this.metadata.addStreamInfo(a)});const a=e.entries.filter(e=>e.trackType===d.S.audio).reduce((e,a)=>e?a.flagDefault&&!e.flagDefault||a.trackNumber<e.trackNumber?a:e:a,null);a&&(this.metadata.setFormat("codec",a.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",a.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",a.audio.channels))}}break;case 307544935:{const e=a;await Promise.all(e.tag.map(async e=>{const a=e.target,n=a?.targetTypeValue?d.yK[a.targetTypeValue]:a?.targetType?a.targetType:"track";await Promise.all(e.simpleTags.map(async e=>{const a=e.string?e.string:e.binary;await this.addTag(`${n}:${e.name}`,a)}))}))}break;case 423732329:{const e=a;await Promise.all(e.attachedFiles.filter(e=>e.mimeType.startsWith("image/")).map(e=>this.addTag("picture",{data:e.data,format:e.mimeType,description:e.description,name:e.name})))}}}})}async addTag(e,a){await this.metadata.addTag("matroska",e,a)}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[773],{616:(e,a,t)=>{t.d(a,{S:()=>k});var s=t(4),r=t(790),i=t(288),n=t(198),o=t(972),c=t(453);const d=i("music-metadata:id3v2:frame-parser"),h="latin1";function l(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?o.jR[Number.parseInt(e)]:void 0}class g{constructor(e,a){this.major=e,this.warningCollector=a}readData(e,a,t){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${a}`);const{encoding:i,bom:o}=n.YF.get(e,0),c=e.length;let m=0,k=[];const p=g.getNullTerminatorLength(i);let T;switch(d(`Parsing tag type=${a}, encoding=${i}, bom=${o}`),"TXXX"!==a&&"T"===a[0]?"T*":a){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let t;try{t=r.sc(e.subarray(1),i).replace(/\x00+$/,"")}catch(e){if(e instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${a} header has invalid string value: ${e.message}`);break}throw e}switch(a){case"TMCL":case"TIPL":case"IPLS":k=g.functionList(this.splitValue(a,t));break;case"TRK":case"TRCK":case"TPOS":k=t;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":k=this.splitValue(a,t);break;case"TCO":case"TCON":k=this.splitValue(a,t).map(e=>function(e){const a=[];let t,s="";for(const r of e)if("string"==typeof t)if("("===r&&""===t)s+="(",t=void 0;else if(")"===r){""!==s&&(a.push(s),s="");const e=l(t);e&&a.push(e),t=void 0}else t+=r;else"("===r?t="":s+=r;return s&&(0===a.length&&s.match(/^\d*$/)&&(s=l(s)),s&&a.push(s)),a}(e)).reduce((e,a)=>e.concat(a),[]);break;case"PCS":case"PCST":k=this.major>=4?this.splitValue(a,t):[t],k=Array.isArray(k)&&""===k[0]?1:0;break;default:k=this.major>=4?this.splitValue(a,t):[t]}break}case"TXXX":{const t=g.readIdentifierAndData(e,m+1,c,i);k={description:t.id,text:this.splitValue(a,r.sc(t.data,i).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(t){const a={};switch(m+=1,this.major){case 2:a.format=r.sc(e.subarray(m,m+3),"latin1"),m+=3;break;case 3:case 4:T=r.sX(e,m,c,h),a.format=r.sc(e.subarray(m,T),h),m=T+1;break;default:throw function(e){throw new u(`Unexpected majorVer: ${e}`)}(this.major)}a.format=g.fixPictureMimeType(a.format),a.type=n.n5[e[m]],m+=1,T=r.sX(e,m,c,i),a.description=r.sc(e.subarray(m,T),i),m=T+p,a.data=e.subarray(m,c),k=a}break;case"CNT":case"PCNT":k=(0,r.ku)(e);break;case"SYLT":{const a=n.aY.get(e,0);m+=n.aY.len;const t={descriptor:"",language:a.language,contentType:a.contentType,timeStampFormat:a.timeStampFormat,syncText:[]};let r=!1;for(;m<c;){const i=g.readNullTerminatedString(e.subarray(m),a.encoding);if(m+=i.len,r){const a=s.UINT32_BE.get(e,m);m+=s.UINT32_BE.len,t.syncText.push({text:i.text,timestamp:a})}else t.descriptor=i.text,r=!0}k=t;break}case"ULT":case"USLT":case"COM":case"COMM":{const a=n.Jp.get(e,m);m+=n.Jp.len;const t=g.readNullTerminatedString(e.subarray(m),a.encoding);m+=t.len;const s=g.readNullTerminatedString(e.subarray(m),a.encoding);k={language:a.language,descriptor:t.text,text:s.text};break}case"UFID":{const a=g.readIdentifierAndData(e,m,c,h);k={owner_identifier:a.id,identifier:a.data};break}case"PRIV":{const a=g.readIdentifierAndData(e,m,c,h);k={owner_identifier:a.id,data:a.data};break}case"POPM":{T=r.sX(e,m,c,h);const a=r.sc(e.subarray(m,T),h);m=T+1;const t=c-m-1;k={email:a,rating:s.UINT8.get(e,m),counter:t>0?r.ku(e.subarray(m+1)):void 0};break}case"GEOB":{T=r.sX(e,m+1,c,i);const a=r.sc(e.subarray(m+1,T),h);m=T+1,T=r.sX(e,m,c,i);const t=r.sc(e.subarray(m,T),h);m=T+1,T=r.sX(e,m,c,i);const s=r.sc(e.subarray(m,T),h);m=T+1;k={type:a,filename:t,description:s,data:e.subarray(m,c)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":T=r.sX(e,m+1,c,i),k=r.sc(e.subarray(m,T),h);break;case"WXXX":{T=r.sX(e,m+1,c,i);const a=r.sc(e.subarray(m+1,T),i);m=T+("utf-16le"===i?2:1),k={description:a,url:r.sc(e.subarray(m,c),h)};break}case"WFD":case"WFED":k=r.sc(e.subarray(m+1,r.sX(e,m+1,c,i)),i);break;case"MCDI":k=e.subarray(0,c);break;default:d(`Warning: unsupported id3v2-tag-type: ${a}`)}return k}static readNullTerminatedString(e,a){let t=a.bom?2:0;const s=r.sX(e,t,e.length,a.encoding),i=e.subarray(t,s);return t="utf-16le"===a.encoding?s+2:s+1,{text:r.sc(i,a.encoding),len:t}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const a={};for(let t=0;t+1<e.length;t+=2){const s=e[t+1].split(",");a[e[t]]=a[e[t]]?a[e[t]].concat(s):s}return a}splitValue(e,a){let t;return this.major<4?(t=a.split(/\x00/g),t.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):t=a.split(/\//g)):t=a.split(/\x00/g),g.trimArray(t)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,a,t,s){const i=r.sX(e,a,t,s),n=r.sc(e.subarray(a,i),s);return a=i+g.getNullTerminatorLength(s),{id:n,data:e.subarray(a,t)}}static getNullTerminatorLength(e){return"utf-16le"===e?2:1}}class u extends((0,c.fO)("id3v2")){}var m=t(74);class k{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let a=0,t=0;for(;a<e.length-1;)a!==t&&(e[t]=e[a]),a+=255===e[a]&&0===e[a+1]?2:1,t++;return a<e.length&&(e[t++]=e[a]),e.subarray(0,t)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw p(e)}}static readFrameFlags(e){return{status:{tag_alter_preservation:r.mh(e,0,6),file_alter_preservation:r.mh(e,0,5),read_only:r.mh(e,0,4)},format:{grouping_identity:r.mh(e,1,7),compression:r.mh(e,1,3),encryption:r.mh(e,1,2),unsynchronisation:r.mh(e,1,1),data_length_indicator:r.mh(e,1,0)}}}static readFrameData(e,a,t,s,r){const i=new g(t,r);switch(t){case 2:return i.readData(e,a.id,s);case 3:case 4:return a.flags?.format.unsynchronisation&&(e=k.removeUnsyncBytes(e)),a.flags?.format.data_length_indicator&&(e=e.subarray(4,e.length)),i.readData(e,a.id,s);default:throw p(t)}}static makeDescriptionTagName(e,a){return e+(a?`:${a}`:"")}async parse(e,a,t){this.tokenizer=a,this.metadata=e,this.options=t;const s=await this.tokenizer.readToken(n.yW);if("ID3"!==s.fileIdentifier)throw new u("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(n.nl),a=e.size-n.nl.len;return a>0?this.parseExtendedHeaderData(a,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,a){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-a)}async parseId3Data(e){const a=await this.tokenizer.readToken(new s.Uint8ArrayType(e));for(const e of this.parseMetadata(a))if("TXXX"===e.id)e.value&&await this.handleTag(e,e.value.text,()=>e.value.description);else await(Array.isArray(e.value)?Promise.all(e.value.map(a=>this.addTag(e.id,a))):this.addTag(e.id,e.value))}async handleTag(e,a,t,s=e=>e){await Promise.all(a.map(a=>this.addTag(k.makeDescriptionTagName(e.id,t(a)),s(a))))}async addTag(e,a){await this.metadata.addTag(this.headerType,e,a)}parseMetadata(e){let a=0;const t=[];for(;a!==e.length;){const s=k.getFrameHeaderLength(this.id3Header.version.major);if(a+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const r=e.subarray(a,a+s);a+=s;const i=this.readFrameHeader(r,this.id3Header.version.major),n=e.subarray(a,a+i.length);a+=i.length;const o=k.readFrameData(n,i,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&t.push({id:i.id,value:o})}return t}readFrameHeader(e,a){let t;switch(a){case 2:t={id:(0,m.c)(e.subarray(0,3),"ascii"),length:s.UINT24_BE.get(e,3)},t.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;case 3:case 4:t={id:(0,m.c)(e.subarray(0,4),"ascii"),length:(4===a?n.St:s.UINT32_BE).get(e,4),flags:k.readFrameFlags(e.subarray(8,10))},t.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;default:throw p(a)}return t}}function p(e){throw new u(`Unexpected majorVer: ${e}`)}},773:(e,a,t)=>{t.r(a),t.d(a,{WaveParser:()=>P});var s=t(959),r=t(4),i=t(288);const n={len:8,get:(e,a)=>({chunkID:new r.StringType(4,"latin1").get(e,a),chunkSize:r.UINT32_LE.get(e,a+4)})};class o{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=1&this.len}get(e,a){return new r.StringType(this.tagHeader.chunkSize,"ascii").get(e,a)}}var c=t(453);class d extends((0,c.fO)("Wave")){}const h=1,l=2,g=3,u=5632,m=5634,k=255,p=146,T=8192,f=576,I=577,y=9,w=8193,b=80,S={[h]:"PCM",[l]:"ADPCM",[g]:"IEEE_FLOAT",[u]:"MPEG_ADTS_AAC",[m]:"MPEG_LOAS",[k]:"RAW_AAC1",[p]:"DOLBY_AC3_SPDIF",[T]:"DVM",[f]:"RAW_SPORT",[I]:"ESST_AC3",[y]:"DRM",[w]:"DTS2",[b]:"MPEG"};class F{constructor(e){if(e.chunkSize<16)throw new d("Invalid chunk size");this.len=e.chunkSize}get(e,a){return{wFormatTag:r.UINT16_LE.get(e,a),nChannels:r.UINT16_LE.get(e,a+2),nSamplesPerSec:r.UINT32_LE.get(e,a+4),nAvgBytesPerSec:r.UINT32_LE.get(e,a+8),nBlockAlign:r.UINT16_LE.get(e,a+12),wBitsPerSample:r.UINT16_LE.get(e,a+14)}}}class z{constructor(e){if(e.chunkSize<4)throw new d("Invalid fact chunk size.");this.len=e.chunkSize}get(e,a){return{dwSampleLength:r.UINT32_LE.get(e,a)}}}var v=t(616),D=t(790),A=t(68),L=t(585);const C={len:420,get:(e,a)=>({description:(0,D.F6)(new r.StringType(256,"ascii").get(e,a)).trim(),originator:(0,D.F6)(new r.StringType(32,"ascii").get(e,a+256)).trim(),originatorReference:(0,D.F6)(new r.StringType(32,"ascii").get(e,a+288)).trim(),originationDate:(0,D.F6)(new r.StringType(10,"ascii").get(e,a+320)).trim(),originationTime:(0,D.F6)(new r.StringType(8,"ascii").get(e,a+330)).trim(),timeReferenceLow:r.UINT32_LE.get(e,a+338),timeReferenceHigh:r.UINT32_LE.get(e,a+342),version:r.UINT16_LE.get(e,a+346),umid:new r.Uint8ArrayType(64).get(e,a+348),loudnessValue:r.UINT16_LE.get(e,a+412),maxTruePeakLevel:r.UINT16_LE.get(e,a+414),maxMomentaryLoudness:r.UINT16_LE.get(e,a+416),maxShortTermLoudness:r.UINT16_LE.get(e,a+418)})},E=i("music-metadata:parser:RIFF");class P extends L.s{constructor(){super(...arguments),this.blockAlign=0}async parse(){const e=await this.tokenizer.readToken(n);if(E(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),"RIFF"===e.chunkID)return this.metadata.setAudioOnly(),this.parseRiffChunk(e.chunkSize).catch(e=>{if(!(e instanceof s.d1))throw e})}async parseRiffChunk(e){const a=await this.tokenizer.readToken(A.e);if(this.metadata.setFormat("container",a),"WAVE"===a)return this.readWaveChunk(e-A.e.len);throw new d(`Unsupported RIFF format: RIFF/${a}`)}async readWaveChunk(e){for(;e>=n.len;){const a=await this.tokenizer.readToken(n);switch(e-=n.len+a.chunkSize,a.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=a,E(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${a.chunkID}`),a.chunkID){case"LIST":await this.parseListTag(a);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new z(a));break;case"fmt ":{const e=await this.tokenizer.readToken(new F(a));let t=S[e.wFormatTag];t||(E(`WAVE/non-PCM format=${e.wFormatTag}`),t=`non-PCM (${e.wFormatTag})`),this.metadata.setFormat("codec",t),this.metadata.setFormat("bitsPerSample",e.wBitsPerSample),this.metadata.setFormat("sampleRate",e.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",e.nChannels),this.metadata.setFormat("bitrate",e.nBlockAlign*e.nSamplesPerSec*8),this.blockAlign=e.nBlockAlign;break}case"id3 ":case"ID3 ":{const e=await this.tokenizer.readToken(new r.Uint8ArrayType(a.chunkSize)),t=s.vY(e);await(new v.S).parse(this.metadata,t,this.options);break}case"data":{!1!==this.metadata.format.lossless&&this.metadata.setFormat("lossless",!0);let e=a.chunkSize;if(this.tokenizer.fileInfo.size){const a=this.tokenizer.fileInfo.size-this.tokenizer.position;a<e&&(this.metadata.addWarning("data chunk length exceeding file length"),e=a)}const t=this.fact?this.fact.dwSampleLength:4294967295===e?void 0:e/this.blockAlign;t&&(this.metadata.setFormat("numberOfSamples",t),this.metadata.format.sampleRate&&this.metadata.setFormat("duration",t/this.metadata.format.sampleRate)),"ADPCM"===this.metadata.format.codec?this.metadata.setFormat("bitrate",352e3):this.metadata.format.sampleRate&&this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(a.chunkSize);break}case"bext":{const e=await this.tokenizer.readToken(C);Object.keys(e).forEach(a=>{this.metadata.addTag("exif",`bext.${a}`,e[a])});const t=a.chunkSize-C.len;await this.tokenizer.ignore(t);break}case"\0\0\0\0":E(`Ignore padding chunk: RIFF/${a.chunkID} of ${a.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${a.chunkID}`),await this.tokenizer.ignore(a.chunkSize);break;default:E(`Ignore chunk: RIFF/${a.chunkID} of ${a.chunkSize} bytes`),this.metadata.addWarning(`Ignore chunk: RIFF/${a.chunkID}`),await this.tokenizer.ignore(a.chunkSize)}this.header.chunkSize%2==1&&(E("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const a=await this.tokenizer.readToken(new r.StringType(4,"latin1"));return E("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,a),"INFO"===a?this.parseRiffInfoTags(e.chunkSize-4):(this.metadata.addWarning(`Ignore chunk: RIFF/WAVE/LIST/${a}`),E(`Ignoring chunkID=RIFF/WAVE/LIST/${a}`),this.tokenizer.ignore(e.chunkSize-4).then())}async parseRiffInfoTags(e){for(;e>=8;){const a=await this.tokenizer.readToken(n),t=new o(a),s=await this.tokenizer.readToken(t);this.addTag(a.chunkID,D.F6(s)),e-=8+t.len}if(0!==e)throw new d(`Illegal remaining size: ${e}`)}addTag(e,a){this.metadata.addTag("exif",e,a)}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[869],{869:(a,e,t)=>{t.r(e),t.d(e,{WavPackContentError:()=>u,WavPackParser:()=>p});var s=t(4),i=t(142),o=t(68),n=t(585);const r=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1],l={len:32,get:(a,e)=>{const t=s.UINT32_LE.get(a,e+24),i={BlockID:o.e.get(a,e),blockSize:s.UINT32_LE.get(a,e+4),version:s.UINT16_LE.get(a,e+8),totalSamples:s.UINT32_LE.get(a,e+12),blockIndex:s.UINT32_LE.get(a,e+16),blockSamples:s.UINT32_LE.get(a,e+20),flags:{bitsPerSample:8*(1+k(t,0,2)),isMono:d(t,2),isHybrid:d(t,3),isJointStereo:d(t,4),crossChannel:d(t,5),hybridNoiseShaping:d(t,6),floatingPoint:d(t,7),samplingRate:r[k(t,23,4)],isDSD:d(t,31)},crc:new s.Uint8ArrayType(4).get(a,e+28)};return i.flags.isDSD&&(i.totalSamples*=8),i}},c={len:1,get:(a,e)=>({functionId:k(a[e],0,6),isOptional:d(a[e],5),isOddSize:d(a[e],6),largeBlock:d(a[e],7)})};function d(a,e){return 1===k(a,e,1)}function k(a,e,t){return a>>>e&4294967295>>>32-t}var m=t(288),h=t(946),f=t(453);const g=m("music-metadata:parser:WavPack");class u extends((0,f.fO)("WavPack")){}class p extends n.s{constructor(){super(...arguments),this.audioDataSize=0}async parse(){return this.metadata.setAudioOnly(),this.audioDataSize=0,await this.parseWavPackBlocks(),(0,i.tryParseApeHeader)(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if("wvpk"!==await this.tokenizer.peekToken(o.e))break;const a=await this.tokenizer.readToken(l);if("wvpk"!==a.BlockID)throw new u("Invalid WavPack Block-ID");g(`WavPack header blockIndex=${a.blockIndex}, len=${l.len}`),0!==a.blockIndex||this.metadata.format.container||(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!a.flags.isHybrid),this.metadata.setFormat("bitsPerSample",a.flags.bitsPerSample),a.flags.isDSD||(this.metadata.setFormat("sampleRate",a.flags.samplingRate),this.metadata.setFormat("duration",a.totalSamples/a.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",a.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",a.totalSamples),this.metadata.setFormat("codec",a.flags.isDSD?"DSD":"PCM"));const e=a.blockSize-(l.len-8);await(0===a.blockIndex?this.parseMetadataSubBlock(a,e):this.tokenizer.ignore(e)),a.blockSamples>0&&(this.audioDataSize+=a.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=l.len);this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioDataSize/this.metadata.format.duration)}async parseMetadataSubBlock(a,e){let t=e;for(;t>c.len;){const e=await this.tokenizer.readToken(c),i=await this.tokenizer.readNumber(e.largeBlock?s.UINT24_LE:s.UINT8),o=new Uint8Array(2*i-(e.isOddSize?1:0));switch(await this.tokenizer.readBuffer(o),g(`Metadata Sub-Blocks functionId=0x${e.functionId.toString(16)}, id.largeBlock=${e.largeBlock},data-size=${o.length}`),e.functionId){case 0:break;case 14:{g("ID_DSD_BLOCK");const e=1<<s.UINT8.get(o,0),t=a.flags.samplingRate*e*8;if(!a.flags.isDSD)throw new u("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",t),this.metadata.setFormat("duration",a.totalSamples/t);break}case 36:g("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",o);break;case 47:g(`ID_BLOCK_CHECKSUM: checksum=${(0,h.EY)(o)}`);break;default:g(`Ignore unsupported meta-sub-block-id functionId=0x${e.functionId.toString(16)}`)}t-=c.len+(e.largeBlock?s.UINT24_LE.len:s.UINT8.len)+2*i,g(`remainingLength=${t}`),e.isOddSize&&this.tokenizer.ignore(1)}if(0!==t)throw new u("metadata-sub-block should fit it remaining length")}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[873],{616:(e,a,t)=>{t.d(a,{S:()=>g});var s=t(4),r=t(790),i=t(288),n=t(198),o=t(972),d=t(453);const c=i("music-metadata:id3v2:frame-parser"),h="latin1";function l(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?o.jR[Number.parseInt(e)]:void 0}class u{constructor(e,a){this.major=e,this.warningCollector=a}readData(e,a,t){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${a}`);const{encoding:i,bom:o}=n.YF.get(e,0),d=e.length;let p=0,g=[];const k=u.getNullTerminatorLength(i);let y;switch(c(`Parsing tag type=${a}, encoding=${i}, bom=${o}`),"TXXX"!==a&&"T"===a[0]?"T*":a){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let t;try{t=r.sc(e.subarray(1),i).replace(/\x00+$/,"")}catch(e){if(e instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${a} header has invalid string value: ${e.message}`);break}throw e}switch(a){case"TMCL":case"TIPL":case"IPLS":g=u.functionList(this.splitValue(a,t));break;case"TRK":case"TRCK":case"TPOS":g=t;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":g=this.splitValue(a,t);break;case"TCO":case"TCON":g=this.splitValue(a,t).map(e=>function(e){const a=[];let t,s="";for(const r of e)if("string"==typeof t)if("("===r&&""===t)s+="(",t=void 0;else if(")"===r){""!==s&&(a.push(s),s="");const e=l(t);e&&a.push(e),t=void 0}else t+=r;else"("===r?t="":s+=r;return s&&(0===a.length&&s.match(/^\d*$/)&&(s=l(s)),s&&a.push(s)),a}(e)).reduce((e,a)=>e.concat(a),[]);break;case"PCS":case"PCST":g=this.major>=4?this.splitValue(a,t):[t],g=Array.isArray(g)&&""===g[0]?1:0;break;default:g=this.major>=4?this.splitValue(a,t):[t]}break}case"TXXX":{const t=u.readIdentifierAndData(e,p+1,d,i);g={description:t.id,text:this.splitValue(a,r.sc(t.data,i).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(t){const a={};switch(p+=1,this.major){case 2:a.format=r.sc(e.subarray(p,p+3),"latin1"),p+=3;break;case 3:case 4:y=r.sX(e,p,d,h),a.format=r.sc(e.subarray(p,y),h),p=y+1;break;default:throw function(e){throw new m(`Unexpected majorVer: ${e}`)}(this.major)}a.format=u.fixPictureMimeType(a.format),a.type=n.n5[e[p]],p+=1,y=r.sX(e,p,d,i),a.description=r.sc(e.subarray(p,y),i),p=y+k,a.data=e.subarray(p,d),g=a}break;case"CNT":case"PCNT":g=(0,r.ku)(e);break;case"SYLT":{const a=n.aY.get(e,0);p+=n.aY.len;const t={descriptor:"",language:a.language,contentType:a.contentType,timeStampFormat:a.timeStampFormat,syncText:[]};let r=!1;for(;p<d;){const i=u.readNullTerminatedString(e.subarray(p),a.encoding);if(p+=i.len,r){const a=s.UINT32_BE.get(e,p);p+=s.UINT32_BE.len,t.syncText.push({text:i.text,timestamp:a})}else t.descriptor=i.text,r=!0}g=t;break}case"ULT":case"USLT":case"COM":case"COMM":{const a=n.Jp.get(e,p);p+=n.Jp.len;const t=u.readNullTerminatedString(e.subarray(p),a.encoding);p+=t.len;const s=u.readNullTerminatedString(e.subarray(p),a.encoding);g={language:a.language,descriptor:t.text,text:s.text};break}case"UFID":{const a=u.readIdentifierAndData(e,p,d,h);g={owner_identifier:a.id,identifier:a.data};break}case"PRIV":{const a=u.readIdentifierAndData(e,p,d,h);g={owner_identifier:a.id,data:a.data};break}case"POPM":{y=r.sX(e,p,d,h);const a=r.sc(e.subarray(p,y),h);p=y+1;const t=d-p-1;g={email:a,rating:s.UINT8.get(e,p),counter:t>0?r.ku(e.subarray(p+1)):void 0};break}case"GEOB":{y=r.sX(e,p+1,d,i);const a=r.sc(e.subarray(p+1,y),h);p=y+1,y=r.sX(e,p,d,i);const t=r.sc(e.subarray(p,y),h);p=y+1,y=r.sX(e,p,d,i);const s=r.sc(e.subarray(p,y),h);p=y+1;g={type:a,filename:t,description:s,data:e.subarray(p,d)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":y=r.sX(e,p+1,d,i),g=r.sc(e.subarray(p,y),h);break;case"WXXX":{y=r.sX(e,p+1,d,i);const a=r.sc(e.subarray(p+1,y),i);p=y+("utf-16le"===i?2:1),g={description:a,url:r.sc(e.subarray(p,d),h)};break}case"WFD":case"WFED":g=r.sc(e.subarray(p+1,r.sX(e,p+1,d,i)),i);break;case"MCDI":g=e.subarray(0,d);break;default:c(`Warning: unsupported id3v2-tag-type: ${a}`)}return g}static readNullTerminatedString(e,a){let t=a.bom?2:0;const s=r.sX(e,t,e.length,a.encoding),i=e.subarray(t,s);return t="utf-16le"===a.encoding?s+2:s+1,{text:r.sc(i,a.encoding),len:t}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const a={};for(let t=0;t+1<e.length;t+=2){const s=e[t+1].split(",");a[e[t]]=a[e[t]]?a[e[t]].concat(s):s}return a}splitValue(e,a){let t;return this.major<4?(t=a.split(/\x00/g),t.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):t=a.split(/\//g)):t=a.split(/\x00/g),u.trimArray(t)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,a,t,s){const i=r.sX(e,a,t,s),n=r.sc(e.subarray(a,i),s);return a=i+u.getNullTerminatorLength(s),{id:n,data:e.subarray(a,t)}}static getNullTerminatorLength(e){return"utf-16le"===e?2:1}}class m extends((0,d.fO)("id3v2")){}var p=t(74);class g{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let a=0,t=0;for(;a<e.length-1;)a!==t&&(e[t]=e[a]),a+=255===e[a]&&0===e[a+1]?2:1,t++;return a<e.length&&(e[t++]=e[a]),e.subarray(0,t)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw k(e)}}static readFrameFlags(e){return{status:{tag_alter_preservation:r.mh(e,0,6),file_alter_preservation:r.mh(e,0,5),read_only:r.mh(e,0,4)},format:{grouping_identity:r.mh(e,1,7),compression:r.mh(e,1,3),encryption:r.mh(e,1,2),unsynchronisation:r.mh(e,1,1),data_length_indicator:r.mh(e,1,0)}}}static readFrameData(e,a,t,s,r){const i=new u(t,r);switch(t){case 2:return i.readData(e,a.id,s);case 3:case 4:return a.flags?.format.unsynchronisation&&(e=g.removeUnsyncBytes(e)),a.flags?.format.data_length_indicator&&(e=e.subarray(4,e.length)),i.readData(e,a.id,s);default:throw k(t)}}static makeDescriptionTagName(e,a){return e+(a?`:${a}`:"")}async parse(e,a,t){this.tokenizer=a,this.metadata=e,this.options=t;const s=await this.tokenizer.readToken(n.yW);if("ID3"!==s.fileIdentifier)throw new m("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(n.nl),a=e.size-n.nl.len;return a>0?this.parseExtendedHeaderData(a,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,a){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-a)}async parseId3Data(e){const a=await this.tokenizer.readToken(new s.Uint8ArrayType(e));for(const e of this.parseMetadata(a))if("TXXX"===e.id)e.value&&await this.handleTag(e,e.value.text,()=>e.value.description);else await(Array.isArray(e.value)?Promise.all(e.value.map(a=>this.addTag(e.id,a))):this.addTag(e.id,e.value))}async handleTag(e,a,t,s=e=>e){await Promise.all(a.map(a=>this.addTag(g.makeDescriptionTagName(e.id,t(a)),s(a))))}async addTag(e,a){await this.metadata.addTag(this.headerType,e,a)}parseMetadata(e){let a=0;const t=[];for(;a!==e.length;){const s=g.getFrameHeaderLength(this.id3Header.version.major);if(a+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const r=e.subarray(a,a+s);a+=s;const i=this.readFrameHeader(r,this.id3Header.version.major),n=e.subarray(a,a+i.length);a+=i.length;const o=g.readFrameData(n,i,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&t.push({id:i.id,value:o})}return t}readFrameHeader(e,a){let t;switch(a){case 2:t={id:(0,p.c)(e.subarray(0,3),"ascii"),length:s.UINT24_BE.get(e,3)},t.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;case 3:case 4:t={id:(0,p.c)(e.subarray(0,4),"ascii"),length:(4===a?n.St:s.UINT32_BE).get(e,4),flags:g.readFrameFlags(e.subarray(8,10))},t.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;default:throw k(a)}return t}}function k(e){throw new m(`Unexpected majorVer: ${e}`)}},834:(e,a,t)=>{t.d(a,{k:()=>h});var s=t(959),r=t(288),i=t(198),n=t(616),o=t(972),d=t(585);const c=r("music-metadata:parser:ID3");class h extends d.s{constructor(){super(...arguments),this.id3parser=new n.S}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(i.yW)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof s.d1))throw e;c("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),c("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new o.Bn(this.metadata,this.tokenizer,this.options);await e.parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(i.yW)).fileIdentifier)return c("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}},873:(e,a,t)=>{t.r(a),t.d(a,{MusepackParser:()=>S});var s=t(288),r=t(4),i=t(834),n=t(585),o=t(142),d=t(68),c=t(790);const h=s("music-metadata:parser:musepack:sv8"),l=new r.StringType(2,"latin1"),u={len:5,get:(e,a)=>({crc:r.UINT32_LE.get(e,a),streamVersion:r.UINT8.get(e,a+4)})},m={len:2,get:(e,a)=>({sampleFrequency:[44100,48e3,37800,32e3][c.f5(e,a,0,3)],maxUsedBands:c.f5(e,a,3,5),channelCount:c.f5(e,a+1,0,4)+1,msUsed:c.cD(e,a+1,4),audioBlockFrames:c.f5(e,a+1,5,3)})};class p{get tokenizer(){return this._tokenizer}set tokenizer(e){this._tokenizer=e}constructor(e){this._tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(l),a=await this.readVariableSizeField();return{key:e,payloadLength:a.value-2-a.len}}async readStreamHeader(e){const a={};h(`Reading SH at offset=${this.tokenizer.position}`);const t=await this.tokenizer.readToken(u);e-=u.len,Object.assign(a,t),h(`SH.streamVersion = ${t.streamVersion}`);const s=await this.readVariableSizeField();e-=s.len,a.sampleCount=s.value;const r=await this.readVariableSizeField();e-=r.len,a.beginningOfSilence=r.value;const i=await this.tokenizer.readToken(m);return e-=m.len,Object.assign(a,i),await this.tokenizer.ignore(e),a}async readVariableSizeField(e=1,a=0){let t=await this.tokenizer.readNumber(r.UINT8);return 128&t?(t&=127,t+=a,this.readVariableSizeField(e+1,t<<7)):{len:e,value:a+t}}}var g=t(453);class k extends((0,g.fO)("Musepack")){}const y=s("music-metadata:parser:musepack");class f extends n.s{constructor(){super(...arguments),this.audioLength=0}async parse(){if("MPCK"!==await this.tokenizer.readToken(d.e))throw new k("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new p(this.tokenizer);for(;;){const a=await e.readPacketHeader();switch(y(`packet-header key=${a.key}, payloadLength=${a.payloadLength}`),a.key){case"SH":{const t=await e.readStreamHeader(a.payloadLength);this.metadata.setFormat("numberOfSamples",t.sampleCount),this.metadata.setFormat("sampleRate",t.sampleFrequency),this.metadata.setFormat("duration",t.sampleCount/t.sampleFrequency),this.metadata.setFormat("numberOfChannels",t.channelCount);break}case"AP":this.audioLength+=a.payloadLength,await this.tokenizer.ignore(a.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(a.payloadLength);break;case"SE":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLength/this.metadata.format.duration),(0,o.tryParseApeHeader)(this.metadata,this.tokenizer,this.options);default:throw new k(`Unexpected header: ${a.key}`)}}}}class w{constructor(e){this.pos=0,this.dword=null,this.tokenizer=e}async read(e){for(;null===this.dword;)this.dword=await this.tokenizer.readToken(r.UINT32_LE);let a=this.dword;return this.pos+=e,this.pos<32?(a>>>=32-this.pos,a&(1<<e)-1):(this.pos-=32,0===this.pos?(this.dword=null,a&(1<<e)-1):(this.dword=await this.tokenizer.readToken(r.UINT32_LE),this.pos&&(a<<=this.pos,a|=this.dword>>>32-this.pos),a&(1<<e)-1))}async ignore(e){if(this.pos>0){const a=32-this.pos;this.dword=null,e-=a,this.pos=0}const a=e%32,t=(e-a)/32;return await this.tokenizer.ignore(4*t),this.read(a)}}var b=t(74);const T={len:24,get:(e,a)=>{const t={signature:(0,b.c)(e.subarray(a,a+3),"latin1"),streamMinorVersion:c.f5(e,a+3,0,4),streamMajorVersion:c.f5(e,a+3,4,4),frameCount:r.UINT32_LE.get(e,a+4),maxLevel:r.UINT16_LE.get(e,a+8),sampleFrequency:[44100,48e3,37800,32e3][c.f5(e,a+10,0,2)],link:c.f5(e,a+10,2,2),profile:c.f5(e,a+10,4,4),maxBand:c.f5(e,a+11,0,6),intensityStereo:c.cD(e,a+11,6),midSideStereo:c.cD(e,a+11,7),titlePeak:r.UINT16_LE.get(e,a+12),titleGain:r.UINT16_LE.get(e,a+14),albumPeak:r.UINT16_LE.get(e,a+16),albumGain:r.UINT16_LE.get(e,a+18),lastFrameLength:r.UINT32_LE.get(e,a+20)>>>20&2047,trueGapless:c.cD(e,a+23,0)};return t.lastFrameLength=t.trueGapless?r.UINT32_LE.get(e,20)>>>20&2047:0,t}},v=s("music-metadata:parser:musepack");class I extends n.s{constructor(){super(...arguments),this.bitreader=null,this.audioLength=0,this.duration=null}async parse(){const e=await this.tokenizer.readToken(T);if("MP+"!==e.signature)throw new k("Unexpected magic number");v(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const a=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",a),this.duration=a/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new w(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const t=await this.bitreader.read(8);return this.metadata.setFormat("codec",(t/100).toFixed(2)),await this.skipAudioData(e.frameCount),v(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),(0,o.tryParseApeHeader)(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const e=await this.bitreader.read(20);this.audioLength+=20+e,await this.bitreader.ignore(e)}const a=await this.bitreader.read(11);this.audioLength+=a,null!==this.duration&&this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}const z=s("music-metadata:parser:musepack");class S extends i.k{async postId3v2Parse(){let e;switch(await this.tokenizer.peekToken(new r.StringType(3,"latin1"))){case"MP+":z("Stream-version 7"),e=new I(this.metadata,this.tokenizer,this.options);break;case"MPC":z("Stream-version 8"),e=new f(this.metadata,this.tokenizer,this.options);break;default:throw new k("Invalid signature prefix")}return this.metadata.setAudioOnly(),e.parse()}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[883],{883:(e,t,a)=>{a.r(t),a.d(t,{AsfParser:()=>_});var n=a(288),r=a(738),i=a(946);class s{static fromBin(e,t=0){return new s(s.decode(e,t))}static decode(e,t=0){const a=new DataView(e.buffer,t);return`${a.getUint32(0,!0).toString(16)}-${a.getUint16(4,!0).toString(16)}-${a.getUint16(6,!0).toString(16)}-${a.getUint16(8).toString(16)}-${(0,i.EY)(e.subarray(t+10,t+16))}`.toUpperCase()}static decodeMediaType(e){switch(e.str){case s.AudioMedia.str:return"audio";case s.VideoMedia.str:return"video";case s.CommandMedia.str:return"command";case s.Degradable_JPEG_Media.str:return"degradable-jpeg";case s.FileTransferMedia.str:return"file-transfer";case s.BinaryMedia.str:return"binary"}}static encode(e){const t=new Uint8Array(16),a=new DataView(t.buffer);return a.setUint32(0,Number.parseInt(e.substring(0,8),16),!0),a.setUint16(4,Number.parseInt(e.substring(9,13),16),!0),a.setUint16(6,Number.parseInt(e.substring(14,18),16),!0),t.set((0,i.AS)(e.substring(19,23)),8),t.set((0,i.AS)(e.substring(24)),10),t}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return s.encode(this.str)}}s.HeaderObject=new s("75B22630-668E-11CF-A6D9-00AA0062CE6C"),s.DataObject=new s("75B22636-668E-11CF-A6D9-00AA0062CE6C"),s.SimpleIndexObject=new s("33000890-E5B1-11CF-89F4-00A0C90349CB"),s.IndexObject=new s("D6E229D3-35DA-11D1-9034-00A0C90349BE"),s.MediaObjectIndexObject=new s("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C"),s.TimecodeIndexObject=new s("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C"),s.FilePropertiesObject=new s("8CABDCA1-A947-11CF-8EE4-00C00C205365"),s.StreamPropertiesObject=new s("B7DC0791-A9B7-11CF-8EE6-00C00C205365"),s.HeaderExtensionObject=new s("5FBF03B5-A92E-11CF-8EE3-00C00C205365"),s.CodecListObject=new s("86D15240-311D-11D0-A3A4-00A0C90348F6"),s.ScriptCommandObject=new s("1EFB1A30-0B62-11D0-A39B-00A0C90348F6"),s.MarkerObject=new s("F487CD01-A951-11CF-8EE6-00C00C205365"),s.BitrateMutualExclusionObject=new s("D6E229DC-35DA-11D1-9034-00A0C90349BE"),s.ErrorCorrectionObject=new s("75B22635-668E-11CF-A6D9-00AA0062CE6C"),s.ContentDescriptionObject=new s("75B22633-668E-11CF-A6D9-00AA0062CE6C"),s.ExtendedContentDescriptionObject=new s("D2D0A440-E307-11D2-97F0-00A0C95EA850"),s.ContentBrandingObject=new s("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E"),s.StreamBitratePropertiesObject=new s("7BF875CE-468D-11D1-8D82-006097C9A2B2"),s.ContentEncryptionObject=new s("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E"),s.ExtendedContentEncryptionObject=new s("298AE614-2622-4C17-B935-DAE07EE9289C"),s.DigitalSignatureObject=new s("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E"),s.PaddingObject=new s("1806D474-CADF-4509-A4BA-9AABCB96AAE8"),s.ExtendedStreamPropertiesObject=new s("14E6A5CB-C672-4332-8399-A96952065B5A"),s.AdvancedMutualExclusionObject=new s("A08649CF-4775-4670-8A16-6E35357566CD"),s.GroupMutualExclusionObject=new s("D1465A40-5A79-4338-B71B-E36B8FD6C249"),s.StreamPrioritizationObject=new s("D4FED15B-88D3-454F-81F0-ED5C45999E24"),s.BandwidthSharingObject=new s("A69609E6-517B-11D2-B6AF-00C04FD908E9"),s.LanguageListObject=new s("7C4346A9-EFE0-4BFC-B229-393EDE415C85"),s.MetadataObject=new s("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA"),s.MetadataLibraryObject=new s("44231C94-9498-49D1-A141-1D134E457054"),s.IndexParametersObject=new s("D6E229DF-35DA-11D1-9034-00A0C90349BE"),s.MediaObjectIndexParametersObject=new s("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7"),s.TimecodeIndexParametersObject=new s("F55E496D-9797-4B5D-8C8B-604DFE9BFB24"),s.CompatibilityObject=new s("26F18B5D-4584-47EC-9F5F-0E651F0452C9"),s.AdvancedContentEncryptionObject=new s("43058533-6981-49E6-9B74-AD12CB86D58C"),s.AudioMedia=new s("F8699E40-5B4D-11CF-A8FD-00805F5C442B"),s.VideoMedia=new s("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B"),s.CommandMedia=new s("59DACFC0-59E6-11D0-A3AC-00A0C90348F6"),s.JFIF_Media=new s("B61BE100-5B4E-11CF-A8FD-00805F5C442B"),s.Degradable_JPEG_Media=new s("35907DE0-E415-11CF-A917-00805F5C442B"),s.FileTransferMedia=new s("91BD222C-F21C-497A-8B6D-5AA86BFC0185"),s.BinaryMedia=new s("3AFB65E2-47EF-40F2-AC2C-70A90D71D343"),s.ASF_Index_Placeholder_Object=new s("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2");const o=s;var c=a(4),d=a(790);function u(e){return d.F6(d.sc(e,"utf-16le"))}const b=[u,g,function(e,t=0){return 1===C(e,t)},function(e,t=0){return c.UINT32_LE.get(e,t)},function(e,t=0){return c.UINT64_LE.get(e,t)},C,g];function g(e){return new Uint8Array(e)}function C(e,t=0){return c.UINT16_LE.get(e,t)}var w=a(198),l=a(453);class D extends((0,l.fO)("ASF")){}const E={len:30,get:(e,t)=>({objectId:o.fromBin(e,t),objectSize:Number(c.UINT64_LE.get(e,t+16)),numberOfHeaderObjects:c.UINT32_LE.get(e,t+24)})},A={len:24,get:(e,t)=>({objectId:o.fromBin(e,t),objectSize:Number(c.UINT64_LE.get(e,t+16))})};class m{constructor(e){this.len=Number(e.objectSize)-A.len}postProcessTag(e,t,a,n){if("WM/Picture"===t)e.push({id:t,value:N.fromBuffer(n)});else{const r=b[a];if(!r)throw new D(`unexpected value headerType: ${a}`);e.push({id:t,value:r(n)})}}}class B extends m{get(e,t){return null}}class F extends m{get(e,t){return{fileId:o.fromBin(e,t),fileSize:c.UINT64_LE.get(e,t+16),creationDate:c.UINT64_LE.get(e,t+24),dataPacketsCount:c.UINT64_LE.get(e,t+32),playDuration:c.UINT64_LE.get(e,t+40),sendDuration:c.UINT64_LE.get(e,t+48),preroll:c.UINT64_LE.get(e,t+56),flags:{broadcast:d.mh(e,t+64,24),seekable:d.mh(e,t+64,25)},minimumDataPacketSize:c.UINT32_LE.get(e,t+68),maximumDataPacketSize:c.UINT32_LE.get(e,t+72),maximumBitrate:c.UINT32_LE.get(e,t+76)}}}F.guid=o.FilePropertiesObject;class f extends m{get(e,t){return{streamType:o.decodeMediaType(o.fromBin(e,t)),errorCorrectionType:o.fromBin(e,t+8)}}}f.guid=o.StreamPropertiesObject;class j{constructor(){this.len=22}get(e,t){const a=new DataView(e.buffer,t);return{reserved1:o.fromBin(e,t),reserved2:a.getUint16(16,!0),extensionDataSize:a.getUint16(18,!0)}}}j.guid=o.HeaderExtensionObject;const p={len:20,get:(e,t)=>({entryCount:new DataView(e.buffer,t).getUint16(16,!0)})};async function h(e){const t=await e.readNumber(c.UINT16_LE);return(await e.readToken(new c.StringType(2*t,"utf-16le"))).replace("\0","")}async function I(e){const t=await e.readToken(p),a=[];for(let n=0;n<t.entryCount;++n)a.push(await T(e));return a}async function O(e){const t=await e.readNumber(c.UINT16_LE),a=new Uint8Array(t);return await e.readBuffer(a),a}async function T(e){const t=await e.readNumber(c.UINT16_LE);return{type:{videoCodec:!(1&~t),audioCodec:!(2&~t)},codecName:await h(e),description:await h(e),information:await O(e)}}class k extends m{get(e,t){const a=[],n=new DataView(e.buffer,t);let r=10;for(let i=0;i<k.contentDescTags.length;++i){const s=n.getUint16(2*i,!0);if(s>0){const n=k.contentDescTags[i],o=r+s;a.push({id:n,value:u(e.subarray(t+r,t+o))}),r=o}}return a}}k.guid=o.ContentDescriptionObject,k.contentDescTags=["Title","Author","Copyright","Description","Rating"];class y extends m{get(e,t){const a=[],n=new DataView(e.buffer,t),r=n.getUint16(0,!0);let i=2;for(let s=0;s<r;s+=1){const r=n.getUint16(i,!0);i+=2;const s=u(e.subarray(t+i,t+i+r));i+=r;const o=n.getUint16(i,!0);i+=2;const c=n.getUint16(i,!0);i+=2;const d=e.subarray(t+i,t+i+c);i+=c,this.postProcessTag(a,s,o,d)}return a}}y.guid=o.ExtendedContentDescriptionObject;class U extends m{get(e,t){const a=new DataView(e.buffer,t);return{startTime:c.UINT64_LE.get(e,t),endTime:c.UINT64_LE.get(e,t+8),dataBitrate:a.getInt32(12,!0),bufferSize:a.getInt32(16,!0),initialBufferFullness:a.getInt32(20,!0),alternateDataBitrate:a.getInt32(24,!0),alternateBufferSize:a.getInt32(28,!0),alternateInitialBufferFullness:a.getInt32(32,!0),maximumObjectSize:a.getInt32(36,!0),flags:{reliableFlag:d.mh(e,t+40,0),seekableFlag:d.mh(e,t+40,1),resendLiveCleanpointsFlag:d.mh(e,t+40,2)},streamNumber:a.getInt16(42,!0),streamLanguageId:a.getInt16(44,!0),averageTimePerFrame:a.getInt32(52,!0),streamNameCount:a.getInt32(54,!0),payloadExtensionSystems:a.getInt32(56,!0),streamNames:[],streamPropertiesObject:null}}}U.guid=o.ExtendedStreamPropertiesObject;class S extends m{get(e,t){const a=[],n=new DataView(e.buffer,t),r=n.getUint16(0,!0);let i=2;for(let s=0;s<r;s+=1){i+=4;const r=n.getUint16(i,!0);i+=2;const s=n.getUint16(i,!0);i+=2;const o=n.getUint32(i,!0);i+=4;const c=u(e.subarray(t+i,t+i+r));i+=r;const d=e.subarray(t+i,t+i+o);i+=o,this.postProcessTag(a,c,s,d)}return a}}S.guid=o.MetadataObject;class x extends S{}x.guid=o.MetadataLibraryObject;class N{static fromBuffer(e){return new N(e.length).get(e,0)}constructor(e){this.len=e}get(e,t){const a=new DataView(e.buffer,t),n=a.getUint8(0),r=a.getInt32(1,!0);let i=5;for(;0!==a.getUint16(i);)i+=2;const s=new c.StringType(i-5,"utf-16le").get(e,5);for(;0!==a.getUint16(i);)i+=2;const o=new c.StringType(i-5,"utf-16le").get(e,5);return{type:w.n5[n],format:s,description:o,size:r,data:e.slice(i+4)}}}var z=a(585);const P=n("music-metadata:parser:ASF");class _ extends z.s{async parse(){const e=await this.tokenizer.readToken(E);if(!e.objectId.equals(o.HeaderObject))throw new D(`expected asf header; but was not found; got: ${e.objectId.str}`);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(e){P("Error while parsing ASF: %s",e)}}async parseObjectHeader(e){let t;do{const e=await this.tokenizer.readToken(A);switch(P("header GUID=%s",e.objectId.str),e.objectId.str){case F.guid.str:{const t=await this.tokenizer.readToken(new F(e));this.metadata.setFormat("duration",Number(t.playDuration/BigInt(1e3))/1e4-Number(t.preroll)/1e3),this.metadata.setFormat("bitrate",t.maximumBitrate);break}case f.guid.str:{const t=await this.tokenizer.readToken(new f(e));this.metadata.setFormat("container",`ASF/${t.streamType}`);break}case j.guid.str:{const e=await this.tokenizer.readToken(new j);await this.parseExtensionObject(e.extensionDataSize);break}case k.guid.str:t=await this.tokenizer.readToken(new k(e)),await this.addTags(t);break;case y.guid.str:t=await this.tokenizer.readToken(new y(e)),await this.addTags(t);break;case o.CodecListObject.str:{const e=await I(this.tokenizer);e.forEach(e=>{this.metadata.addStreamInfo({type:e.type.videoCodec?r.S.video:r.S.audio,codecName:e.codecName})});const t=e.filter(e=>e.type.audioCodec).map(e=>e.codecName).join("/");this.metadata.setFormat("codec",t);break}case o.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(e.objectSize-A.len);break;case o.PaddingObject.str:P("Padding: %s bytes",e.objectSize-A.len),await this.tokenizer.ignore(e.objectSize-A.len);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${e.objectId.str}`),P("Ignore ASF-Object-GUID: %s",e.objectId.str),await this.tokenizer.readToken(new B(e))}}while(--e)}async addTags(e){await Promise.all(e.map(({id:e,value:t})=>this.metadata.addTag("asf",e,t)))}async parseExtensionObject(e){do{const t=await this.tokenizer.readToken(A),a=t.objectSize-A.len;switch(t.objectId.str){case U.guid.str:await this.tokenizer.readToken(new U(t));break;case S.guid.str:{const e=await this.tokenizer.readToken(new S(t));await this.addTags(e);break}case x.guid.str:{const e=await this.tokenizer.readToken(new x(t));await this.addTags(e);break}case o.PaddingObject.str:case o.CompatibilityObject.str:case o.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(a);break;default:this.metadata.addWarning(`Ignore ASF-Object-GUID: ${t.objectId.str}`),await this.tokenizer.readToken(new B(t))}e-=t.objectSize}while(e>0)}}}}]);
        "use strict";(self.webpackChunkmeta=self.webpackChunkmeta||[]).push([[897],{616:(e,a,t)=>{t.d(a,{S:()=>g});var s=t(4),r=t(790),n=t(288),i=t(198),o=t(972),c=t(453);const d=n("music-metadata:id3v2:frame-parser"),h="latin1";function u(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?o.jR[Number.parseInt(e)]:void 0}class l{constructor(e,a){this.major=e,this.warningCollector=a}readData(e,a,t){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${a}`);const{encoding:n,bom:o}=i.YF.get(e,0),c=e.length;let k=0,g=[];const p=l.getNullTerminatorLength(n);let f;switch(d(`Parsing tag type=${a}, encoding=${n}, bom=${o}`),"TXXX"!==a&&"T"===a[0]?"T*":a){case"T*":case"GRP1":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":{let t;try{t=r.sc(e.subarray(1),n).replace(/\x00+$/,"")}catch(e){if(e instanceof Error){this.warningCollector.addWarning(`id3v2.${this.major} type=${a} header has invalid string value: ${e.message}`);break}throw e}switch(a){case"TMCL":case"TIPL":case"IPLS":g=l.functionList(this.splitValue(a,t));break;case"TRK":case"TRCK":case"TPOS":g=t;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":g=this.splitValue(a,t);break;case"TCO":case"TCON":g=this.splitValue(a,t).map(e=>function(e){const a=[];let t,s="";for(const r of e)if("string"==typeof t)if("("===r&&""===t)s+="(",t=void 0;else if(")"===r){""!==s&&(a.push(s),s="");const e=u(t);e&&a.push(e),t=void 0}else t+=r;else"("===r?t="":s+=r;return s&&(0===a.length&&s.match(/^\d*$/)&&(s=u(s)),s&&a.push(s)),a}(e)).reduce((e,a)=>e.concat(a),[]);break;case"PCS":case"PCST":g=this.major>=4?this.splitValue(a,t):[t],g=Array.isArray(g)&&""===g[0]?1:0;break;default:g=this.major>=4?this.splitValue(a,t):[t]}break}case"TXXX":{const t=l.readIdentifierAndData(e,k+1,c,n);g={description:t.id,text:this.splitValue(a,r.sc(t.data,n).replace(/\x00+$/,""))};break}case"PIC":case"APIC":if(t){const a={};switch(k+=1,this.major){case 2:a.format=r.sc(e.subarray(k,k+3),"latin1"),k+=3;break;case 3:case 4:f=r.sX(e,k,c,h),a.format=r.sc(e.subarray(k,f),h),k=f+1;break;default:throw function(e){throw new m(`Unexpected majorVer: ${e}`)}(this.major)}a.format=l.fixPictureMimeType(a.format),a.type=i.n5[e[k]],k+=1,f=r.sX(e,k,c,n),a.description=r.sc(e.subarray(k,f),n),k=f+p,a.data=e.subarray(k,c),g=a}break;case"CNT":case"PCNT":g=(0,r.ku)(e);break;case"SYLT":{const a=i.aY.get(e,0);k+=i.aY.len;const t={descriptor:"",language:a.language,contentType:a.contentType,timeStampFormat:a.timeStampFormat,syncText:[]};let r=!1;for(;k<c;){const n=l.readNullTerminatedString(e.subarray(k),a.encoding);if(k+=n.len,r){const a=s.UINT32_BE.get(e,k);k+=s.UINT32_BE.len,t.syncText.push({text:n.text,timestamp:a})}else t.descriptor=n.text,r=!0}g=t;break}case"ULT":case"USLT":case"COM":case"COMM":{const a=i.Jp.get(e,k);k+=i.Jp.len;const t=l.readNullTerminatedString(e.subarray(k),a.encoding);k+=t.len;const s=l.readNullTerminatedString(e.subarray(k),a.encoding);g={language:a.language,descriptor:t.text,text:s.text};break}case"UFID":{const a=l.readIdentifierAndData(e,k,c,h);g={owner_identifier:a.id,identifier:a.data};break}case"PRIV":{const a=l.readIdentifierAndData(e,k,c,h);g={owner_identifier:a.id,data:a.data};break}case"POPM":{f=r.sX(e,k,c,h);const a=r.sc(e.subarray(k,f),h);k=f+1;const t=c-k-1;g={email:a,rating:s.UINT8.get(e,k),counter:t>0?r.ku(e.subarray(k+1)):void 0};break}case"GEOB":{f=r.sX(e,k+1,c,n);const a=r.sc(e.subarray(k+1,f),h);k=f+1,f=r.sX(e,k,c,n);const t=r.sc(e.subarray(k,f),h);k=f+1,f=r.sX(e,k,c,n);const s=r.sc(e.subarray(k,f),h);k=f+1;g={type:a,filename:t,description:s,data:e.subarray(k,c)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":f=r.sX(e,k+1,c,n),g=r.sc(e.subarray(k,f),h);break;case"WXXX":{f=r.sX(e,k+1,c,n);const a=r.sc(e.subarray(k+1,f),n);k=f+("utf-16le"===n?2:1),g={description:a,url:r.sc(e.subarray(k,c),h)};break}case"WFD":case"WFED":g=r.sc(e.subarray(k+1,r.sX(e,k+1,c,n)),n);break;case"MCDI":g=e.subarray(0,c);break;default:d(`Warning: unsupported id3v2-tag-type: ${a}`)}return g}static readNullTerminatedString(e,a){let t=a.bom?2:0;const s=r.sX(e,t,e.length,a.encoding),n=e.subarray(t,s);return t="utf-16le"===a.encoding?s+2:s+1,{text:r.sc(n,a.encoding),len:t}}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const a={};for(let t=0;t+1<e.length;t+=2){const s=e[t+1].split(",");a[e[t]]=a[e[t]]?a[e[t]].concat(s):s}return a}splitValue(e,a){let t;return this.major<4?(t=a.split(/\x00/g),t.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):t=a.split(/\//g)):t=a.split(/\x00/g),l.trimArray(t)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,a,t,s){const n=r.sX(e,a,t,s),i=r.sc(e.subarray(a,n),s);return a=n+l.getNullTerminatorLength(s),{id:i,data:e.subarray(a,t)}}static getNullTerminatorLength(e){return"utf-16le"===e?2:1}}class m extends((0,c.fO)("id3v2")){}var k=t(74);class g{constructor(){this.tokenizer=void 0,this.id3Header=void 0,this.metadata=void 0,this.headerType=void 0,this.options=void 0}static removeUnsyncBytes(e){let a=0,t=0;for(;a<e.length-1;)a!==t&&(e[t]=e[a]),a+=255===e[a]&&0===e[a+1]?2:1,t++;return a<e.length&&(e[t++]=e[a]),e.subarray(0,t)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw p(e)}}static readFrameFlags(e){return{status:{tag_alter_preservation:r.mh(e,0,6),file_alter_preservation:r.mh(e,0,5),read_only:r.mh(e,0,4)},format:{grouping_identity:r.mh(e,1,7),compression:r.mh(e,1,3),encryption:r.mh(e,1,2),unsynchronisation:r.mh(e,1,1),data_length_indicator:r.mh(e,1,0)}}}static readFrameData(e,a,t,s,r){const n=new l(t,r);switch(t){case 2:return n.readData(e,a.id,s);case 3:case 4:return a.flags?.format.unsynchronisation&&(e=g.removeUnsyncBytes(e)),a.flags?.format.data_length_indicator&&(e=e.subarray(4,e.length)),n.readData(e,a.id,s);default:throw p(t)}}static makeDescriptionTagName(e,a){return e+(a?`:${a}`:"")}async parse(e,a,t){this.tokenizer=a,this.metadata=e,this.options=t;const s=await this.tokenizer.readToken(i.yW);if("ID3"!==s.fileIdentifier)throw new m("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=s,this.headerType=`ID3v2.${s.version.major}`,s.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(s.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(i.nl),a=e.size-i.nl.len;return a>0?this.parseExtendedHeaderData(a,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,a){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-a)}async parseId3Data(e){const a=await this.tokenizer.readToken(new s.Uint8ArrayType(e));for(const e of this.parseMetadata(a))if("TXXX"===e.id)e.value&&await this.handleTag(e,e.value.text,()=>e.value.description);else await(Array.isArray(e.value)?Promise.all(e.value.map(a=>this.addTag(e.id,a))):this.addTag(e.id,e.value))}async handleTag(e,a,t,s=e=>e){await Promise.all(a.map(a=>this.addTag(g.makeDescriptionTagName(e.id,t(a)),s(a))))}async addTag(e,a){await this.metadata.addTag(this.headerType,e,a)}parseMetadata(e){let a=0;const t=[];for(;a!==e.length;){const s=g.getFrameHeaderLength(this.id3Header.version.major);if(a+s>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const r=e.subarray(a,a+s);a+=s;const n=this.readFrameHeader(r,this.id3Header.version.major),i=e.subarray(a,a+n.length);a+=n.length;const o=g.readFrameData(i,n,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&t.push({id:n.id,value:o})}return t}readFrameHeader(e,a){let t;switch(a){case 2:t={id:(0,k.c)(e.subarray(0,3),"ascii"),length:s.UINT24_BE.get(e,3)},t.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;case 3:case 4:t={id:(0,k.c)(e.subarray(0,4),"ascii"),length:(4===a?i.St:s.UINT32_BE).get(e,4),flags:g.readFrameFlags(e.subarray(8,10))},t.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${t.id}`);break;default:throw p(a)}return t}}function p(e){throw new m(`Unexpected majorVer: ${e}`)}},897:(e,a,t)=>{t.r(a),t.d(a,{DsdiffContentParseError:()=>l,DsdiffParser:()=>m});var s=t(4),r=t(288),n=t(959),i=t(68),o=t(585),c=t(616);const d={len:12,get:(e,a)=>({chunkID:i.e.get(e,a),chunkSize:s.INT64_BE.get(e,a+4)})};var h=t(453);const u=r("music-metadata:parser:aiff");class l extends((0,h.fO)("DSDIFF")){}class m extends o.s{async parse(){const e=await this.tokenizer.readToken(d);if("FRM8"!==e.chunkID)throw new l("Unexpected chunk-ID");this.metadata.setAudioOnly();const a=(await this.tokenizer.readToken(i.e)).trim();if("DSD"===a)return this.metadata.setFormat("container",`DSDIFF/${a}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(i.e.len));throw new l(`Unsupported DSDIFF type: ${a}`)}async readFmt8Chunks(e){for(;e>=d.len;){const a=await this.tokenizer.readToken(d);u(`Chunk id=${a.chunkID}`),await this.readData(a),e-=BigInt(d.len)+a.chunkSize}}async readData(e){u(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const a=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":{const e=await this.tokenizer.readToken(s.UINT32_LE);u(`DSDIFF version=${e}`);break}case"PROP":if("SND "!==await this.tokenizer.readToken(i.e))throw new l("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(i.e.len));break;case"ID3":{const a=await this.tokenizer.readToken(new s.Uint8ArrayType(Number(e.chunkSize))),t=n.vY(a);await(new c.S).parse(this.metadata,t,this.options);break}case"DSD":this.metadata.format.numberOfChannels&&this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.format.numberOfSamples&&this.metadata.format.sampleRate&&this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate);break;default:u(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`)}const t=e.chunkSize-BigInt(this.tokenizer.position-a);t>0&&(u(`After Parsing chunk, remaining ${t} bytes`),await this.tokenizer.ignore(Number(t)))}async handleSoundPropertyChunks(e){for(u(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const a=await this.tokenizer.readToken(d);u(`Sound-property-chunk[ID=${a.chunkID}, size=${a.chunkSize}]`);const t=this.tokenizer.position;switch(a.chunkID.trim()){case"FS":{const e=await this.tokenizer.readToken(s.UINT32_BE);this.metadata.setFormat("sampleRate",e);break}case"CHNL":{const e=await this.tokenizer.readToken(s.UINT16_BE);this.metadata.setFormat("numberOfChannels",e),await this.handleChannelChunks(a.chunkSize-BigInt(s.UINT16_BE.len));break}case"CMPR":{const e=(await this.tokenizer.readToken(i.e)).trim(),a=await this.tokenizer.readToken(s.UINT8),t=await this.tokenizer.readToken(new s.StringType(a,"ascii"));"DSD"===e&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${e} (${t})`);break}case"ABSS":{const e=await this.tokenizer.readToken(s.UINT16_BE),a=await this.tokenizer.readToken(s.UINT8),t=await this.tokenizer.readToken(s.UINT8),r=await this.tokenizer.readToken(s.UINT32_BE);u(`ABSS ${e}:${a}:${t}.${r}`);break}case"LSCO":{const e=await this.tokenizer.readToken(s.UINT16_BE);u(`LSCO lsConfig=${e}`);break}default:u(`Unknown sound-property-chunk[ID=${a.chunkID}, size=${a.chunkSize}]`),await this.tokenizer.ignore(Number(a.chunkSize))}const r=a.chunkSize-BigInt(this.tokenizer.position-t);r>0&&(u(`After Parsing sound-property-chunk ${a.chunkSize}, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r))),e-=BigInt(d.len)+a.chunkSize,u(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const e=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",e)}}async handleChannelChunks(e){u(`Parsing channel-chunks, remainingSize=${e}`);const a=[];for(;e>=i.e.len;){const t=await this.tokenizer.readToken(i.e);u(`Channel[ID=${t}]`),a.push(t),e-=BigInt(i.e.len)}return u(`Channels: ${a.join(", ")}`),a}}}}]);

        // just don't look


        var placeholderCover = "data:image/png;base64,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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADc69efczQAAAEIAIAABABAAAIAIAABABCAAAAIQAAABCAAAAIQAAABCACAAAQAEIACEABAAApAAAABKAABAAQgAAACEAAAAQgAgAAEAEAAAgAgAAEAEIAAAAhAAAAEIAAAAhAAAAEIACAABSAAgAAUgAAAAlAAAgDkAtDNAAAEIAAAAhAAAAEIAIAABABAAAIAIAABABCAAAAIQAAABCAAAAIQAEAACkAAAAGoAAEABKAABAAQgAAACEAAAAQgAAACEAAAAQgAgAAEAEAAAgAgAAEAEIAAAAhAAAAEIACAABSAAAACUAACAAhAAQgAIAABAFgPQAUIACAAAQAQgAAACEAAAAQgAAACEACA4wJQAQIACEAAAAQgAAACEAAAAQgAgAAEAOC4AJSAAAACEAAAAQgAgAAEAEAAAgAgAAEAEIAAAAhAAAAEIAAAAhAAAAEIACAABSAAgAAUgAAAAlABAgAIQAAABCAAAAIQAAABCACAAAQA4OwAVIAAAAIQAAABCACAAAQA4NIA1IAAAAIQAAABCACAAAQAQAACACAAAQAQgAAACEAAAAQgAAACEAAAAQgAIAAFIACAABSAAAACUAACAKQDUAMCAAhAAAAEIAAAAhAAAAEIAIAABADgwABUgAAAAhAAAAEIAIAABABAAAIAIAABABCAAAC8G4ASEABAAAIAsB2AChAAQAACACAAAQAQgAAACEAAAAQgAADHBaAEBAAQgAAACEAAAIYCUAECAAhAAAAEIAAAAhAAAAEIAIAABABAAAIAIAABAHgwABUgAIAABABAAAIAsBOAChAAQAACACAAAQDYCUAFCAAgAAEAmA5ADQgAIAABABCAAAAsBaACBAAQgAAATAegAgQAEIAAAEwHoAIEABCAAABMB6ACBAAQgAAATAegAgQAEIAAAEwHoAIEABCAAABMB6ACBAAQgAAATAegAgQAEIAAAEwHoAIEABCAAABMB6ACBAAQgAAATAegAgQAqAWgAgQAEIAAAEwHoAIEABCAAABMB6ACBAAQgAAATAegAgQAEIAAAEwHoAIEAKgFoAIEABCAAABMB6ACBACoBaACBAAQgAAACEAAAAQgAACXBqAEBAAQgAAACEAAAIYCUAICAAhAAAAEIAAAQwEoAQEAcgGoAAEABCAAANMBqAABAGoBqAABAAQgAADTAagAAQBqAagAAQAEIAAAAhAAgJ0AlIAAAAIQAAABCADAUABKQACAXAAqQAAAAQgAgAAEAGAnACUgAEAuABUgAEAtABUgAIAABABgOgAVIABALQAVIACAAAQAQAACALATgBIQACAXgAoQAEAAAgAgAAEAEIAAAFwagAoQAKAWgAoQAEAAAgAwHYAKEACgFoAaEACgF4AKEABAAAIAIAABABCAAABcGoAKEACgFoAaEACgF4AKEACgFoAKEABAAAIAIAABANgJQAkIAJALQAUIACAAAQAQgAAACEAAAC4NQAUIAFALQA0IANALQAUIAFALQAUIACAAAQAQgAAACEAAAC4NQAUIAFALQA0IANALQAUIACAAAQAQgAAACEAAAC4NQAUIAFALQA0IANALQAUIAFALQAUIACAAAQAQgAAACEAAAC4NQAUIAFALQAUIAFALQA0IANALQAUIAFALQAUIACAAAQAQgAAACEAAAC4NQAUIAFALQAUIAFALQAUIAFALQA0IANALQAUIAFALQAUIACAAAQAQgAAACEAAAC4NQAUIAFALQAUIAFALQA0IANALQAUIAFALQAUIACAAAQAQgAAACEAAAC4NQAUIAFALQAUIAFALQAUIAFALQAUIAFALQA0IANALQAUIAFALQAUIACAAAQAQgAAACEAAAAGoAAEABKACBAAQgAoQAEAAakAAAAGoAAEABKACBAAQgAoQAEAACkAAAAEoAAEABKAABAAQgAoQAKAXgAoQAKAWgAoQAKAWgBoQAKAXgAoQAKAWgAoQAEAAAgAgAAEAEIAAAAJQAQIACEAFCAAgADUgAIAAVIAAAAJQAQIACEAFCAAgAAUgAIAAFIAAAAJQAAIACEAFCAAgADUgAEAxABUgAEAtABUgAIAABABAAAIACEABCAAgABUgAIAA1IAAAAJQAQIACEABCAAgAAUgAIAAFIAAAAJQAQIACEANCAAgABUgAIAAVIAAAAJQAAIACEAAAAEoAAEABKAGBAAQgAoQAEAAKkAAAAEoAAEABKAABAAQgAIQAEAAakAAAAGoAAEABKACBAB4KQB/BCAAQCwA//pPCkAAgAsD8H/3owQEALg3AG9rQA8OAPCRiBKAAACxALwnAj04AMAHI0oAAgDEAvCSCPTmAIAA/GxBKUAAgFgAXtCAXh0AEICf7ycBCAAQC8CjE9CrAwAC8Ev9JAEBAGIBeHACengAQAB+LZ4EIABALADPTEAPDwAIwK/GkwAEAIgFoAYEAOgF4IEJ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MSMABSAAIGZkzQeOZl4AgAAUgAAAAlAAAgAIwJmbmRcAIAAFIACAABSAAAACUAACAAhAAQgAIAAFIACAABSAAAACUAACAAhAAQgAiBkB+J2bWRcAIAAFIACAABSAAAACUAACAAhAAQgAIAAFIACAABSAAAAC8M2bGRcAIAAFIACAABSAAAACUAACAAhAAQgAIAAFIACAABSAAAAC8M2b2RYAIAAFIACAABSAAAACUAACAAhAAQgAIAAFIACAADzsZqYFAAhAAQgAIAAFIACAABSAAAACUAACAAhAAQgAIAAPu5llAQACUAACAAhAAQgAIAAFIACAABSAAAACUAACAAjAw25mWACAABSAAAACUAACAAhAAQgAIACvvJldAQACUAACAAhAAQgAIAAFIACAABSAAAACUAACAAhAAQgAIABfPZldAQACUAACAAhAAQgAIABnLmZXAIAAFIAAAAJQAAIACEABCAAgAAUgAIAAPP5iVgUACEABCAAgAAUgAIAAFIAAAALwzoNZFQCwFoAO5kAAgAB0MAcCAASgAAQAEICJg5kUACAABSAAgAAUgAAAAlAAAgAIwCsPZlEAgAAUgAAAAlAAAgAIwJmLWRQAIAD1HwCAABSAAAACUAACAAhAAQgAIAD1HwCAABSAAAACUAACAAhAAQgAIAC/cS9zAgAEYOxc5gQACEABCAAgAAUgAIAAFIAAAAJQAAIACMALrmVOAIAAFIAAAAJQAAIACEABCAAgAO88lTkBAAKwdCpbAgAEoAAEABCAAhAAQADqPwAAASgAAQAEoAAEABCAAhAAQAC+eClLAgAEoAAEABCAAhAAQAAKQAAAASgAAQAEoAAEABCAAhAAQAC+eihLAgAEoAAEABCAAhAAQAAKQAAAAaj/AAAEoAAEABCAAhAAQAC+eCc7AgAEYOxMdgQACEABCAAgAAUgAIAA1H8AAALwxitZEQAgAAUgAIAAXD6SFQEAAlAAAgAIQAEIACAAVy5kRACAAExdyIQAAAEoAAEABKAABAAQgAIQAEAA3nkgEwIABKAABAAQgMv3MSEAQAAKQAAAAbh7HwMCAASgAAQAEIACEABAAApAAAABeOd1DAgAEIACEABAAA5fx34AAAEYO479AAACsHUc8wEABKAABAAQgAIQAEAACkAAAAEoAAEABOD5p7EeAEAAtk5jPACAABSAAAACUAACAAjAmcsYDwAgAFOHMR0AQAAKQAAAASgAAQAEoAAEABCAAhAAQAAKQAAAAXjYYSwHABCAAhAAQAAun8VyAAABmLqK3QAAAlAAAgAIQAEIACAABSAAgAAUgAAAAlAAAgAIwMNuYjYAgABs3cRqAAABKAABAASgAAQAEIAzJ7EaAEAA6j8AAAEoAAEABODGRUwGABCA+g8AQAAKQAAAAbhyD4sBAASgAAQAEIACEABAAApAAAABKAABAASgAAQAEICH3cNgAAABKAABAASgAAQAEID6DwBAAApAAAABePw5zAUAEICxW5gLACAABSAAgADcPYWxAAACUAACAAhAAQgAIAAFIACAABSAAAAC8PxD2AoAIAAFIACAABw+hKkAAAJQAAIACEABCAAgAFcOYSkAgACMncFSAAABKAABAASg/gMAEIACEABAAN54BTsBAASgAAQAEIDLR7ATAEAA6j8AAAE4ewMjAQAEYOsGNgIACEABCAAgAAUgAIAAnLmAjQAAAlAAAgAIQAEIACAAZw5gIwCAAGwdwEQAAAH4q/X9JgIACMBWAFoIACAABSAAgABc/nwLAQAEYCsADQQAEIACEABAAC5/vYEAAAKwFYD2AQAIwK0q0n8AgAAUgAIQABCAAhAAQAA2vt02AAABKAABAASgAAQAEIACEABAAApAAAABKAABAATgYd9uGgCAABxLI/8GIAAgAAWgAAQABGA4AC0DABCAAhAAQAAOf7hhAAACcCyO/A1AAEAACkD9BwAIQAEIACAAGwFoFQCAABSAAAACUAACAAhAAQgAIACv/GyjAAAE4Fog+RVgAEAACkD9BwAIQAEIACAABSAAgAAc/GaTAAAEYCsALQIAEIACEABAAApAAAABqP8AAASgAAQAEIDHf689AAACUAACAAjA4QA0BwBAAApAAAABOByA1gAACMBWABoDACAA90LJD4ABAASgAAQABGA1AG0BABCArQA0BQBAAApAAAABOByAlgAACEABCAAgAC9vJb8BAgAgAAUgACAAowFoBwCAABSAAAACcDgAzQAAEICtALQCAEAACkAAAAE4HIBGAAAIwM0A1H8AAAJQAAIAAnA2ANUfAIAAFIAAgAAMBqD3BwAEoAAEABCAAhAAQAAKQAAAASgAAQAE4Pkf6fkBAAG4GYD6DwBAAOo/AEAACkAAAAE4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Qg3o8AAAoQR0cgCAUAQ6NQBAqAHdGACgE4FOCwCQqUD3BADoRKAzAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf7cDkP4NgTjM/70AAAAASUVORK5CYII="
        
        
        
        
        //player
        var playerState = 'paused'
        
        var currentAudio = document.getElementById('currentAudio'),
            pause = document.getElementById('paused'),
            next = document.getElementById('forward'),
            back = document.getElementById('back'),
            seek = document.getElementById('playerSeek'),
            currentTime = document.getElementById('currentTime'),
            totalTime = document.getElementById('totalTime'),
            minusTime = document.getElementById('minusTime')
          
        const artist = document.getElementById('playingArtist')
        const album = document.getElementById('playingAlbum')
        const title = document.getElementById('playingTitle')
        const cover = document.getElementById('albumcover')
        const smallCover = document.getElementById('smallcover')
        const queueList = document.getElementById('queue')
        const data = document.getElementById('data')
        const errormsg = document.getElementById('errormsg')

        var fileList = []
        var playlistIndex = -2

        pause.onclick = function () {
            if (currentAudio.readyState >= 3) {
                if (playerState == 'paused') {
                    currentAudio.play()
                } else {
                    currentAudio.pause()
                }
            } else {
                pause.textContent = "▶"
                playerState = 'paused'
            }
        }

        navigator.mediaSession.setActionHandler('pause', () => {
            if (currentAudio.readyState >= 3) {
                currentAudio.pause()
            } else {
                pause.textContent = "▶"
                playerState = 'paused'
            }
        })

        navigator.mediaSession.setActionHandler('play', () => {
            if (currentAudio.readyState >= 3) {
                currentAudio.play()
            } else {
                pause.textContent = "▶"
                playerState = 'paused'
            }
        })

        next.onclick = function () {
            musicChange(1)
        }

        back.onclick = function () {
            if (seek.value <= 5) {
                musicChange(-1)
            } else {
                currentAudio.currentTime = 0
            }
        }

        navigator.mediaSession.setActionHandler('nexttrack', () => {
            musicChange(1)
        })

        navigator.mediaSession.setActionHandler('previoustrack', () => {
            if (seek.value <= 5) {
                musicChange(-1)
            } else {
                currentAudio.currentTime = 0
            }
        })

        seek.addEventListener('input', () => {
            currentTime.textContent = calculateTime(seek.value)
            minusTime.textContent = `-${calculateTime(seek.max - seek.value)}`
        })

        seek.addEventListener('change', () => {
            currentAudio.currentTime = seek.value
        })

        currentAudio.addEventListener('timeupdate', () => {
            seek.value = Math.floor(currentAudio.currentTime)
            currentTime.textContent = calculateTime(currentAudio.currentTime)
            minusTime.textContent = `-${calculateTime(currentAudio.duration - currentAudio.currentTime)}`
        })

        currentAudio.addEventListener('loadedmetadata', () => {
            seek.max = Math.floor(currentAudio.duration)
            totalTime.textContent = calculateTime(currentAudio.duration)
        });

        currentAudio.addEventListener('play', () => {
            pause.textContent = "❙❙"
            playerState = 'play'
        })

        currentAudio.addEventListener('pause', () => {
            pause.textContent = "▶"
            playerState = 'paused'
        })

        currentAudio.addEventListener("ended", function(){
            currentAudio.currentTime = 0;
            musicChange(1)
            currentAudio.play()
        });

        const calculateTime = (secs) => {
            const minutes = Math.floor(secs / 60);
            const seconds = Math.floor(secs % 60);
            const returnedSeconds = seconds < 10 ? `0${seconds}` : `${seconds}`;
            return `${minutes}:${returnedSeconds}`;
        }

        function musicChange (amt) {
            if (playlistIndex >= 0) {
                var current = document.getElementById(playlistIndex)
                current.className = 'queueblob'
            }

            if ((playlistIndex + amt) < 0) {
                playlistIndex = fileList.length - 1
            } else if (playlistIndex + amt > fileList.length - 1) {
                playlistIndex = 0
            } else {
                playlistIndex += amt
            }

            var next = document.getElementById(playlistIndex)
            next.className = 'queueblob select'
            next.scrollIntoView({ behavior: "smooth", block: "center"})

            setMusic(fileList[playlistIndex])
        }

        function changeTo (index) {
            if (playlistIndex >= 0) {
                var current = document.getElementById(playlistIndex)
                current.className = 'queueblob'
            }
            
            playlistIndex = index

            var next = document.getElementById(playlistIndex)
            next.className = 'queueblob select'

            setMusic(fileList[playlistIndex])
        }

        function setMusic(musicFile) {
            currentAudio.pause()
            var musicURL = URL.createObjectURL(musicFile)
            currentAudio.src = musicURL;

            seek.value = 0

            const audioCtx = new AudioContext()
            const source = audioCtx.createMediaElementSource(currentAudio)
            const gainNode = audioCtx.createGain()
            gainNode.gain.value = 1
            source.connect(gainNode)
            gainNode.connect(audioCtx.destination)


            if (playerState == 'paused') {
                playerState = 'paused'
                pause.textContent = "▶"
            } else {
                currentAudio.play()
            }

            //music-metadata
            (async () => {
                try {
                    var metadata = await meta.parseBlob(musicFile);

                    errormsg.textContent = ''

                    data.textContent = metadata.format.codec + ' | ' + metadata.format.sampleRate + ' Hz | ' + (Math.round(parseInt(metadata.format.bitrate) / 1000)) + ' kbps'
                    
                    metadata = metadata.common

                    title.textContent = metadata.title || musicFile.name
                    artist.textContent = metadata.artist || ''
                    album.textContent = metadata.album || ''

                    var titleStr = metadata.title || musicFile.name
                    if (metadata.artist || metadata.album) {
                        titleStr += ' - '
                        titleStr += metadata.artist || metadata.album
                    }
                    document.title = titleStr

                    var gain = /* 10 ** (metada.replaygain_album_gain.dB / 20) || */ 10 ** (metadata.replaygain_track_gain.dB / 20) || 1
                    console.log('gain: ' + gain)

                    
                    gainNode.gain.value = gain
                    source.connect(gainNode)
                    gainNode.connect(audioCtx.destination)
                    

                    /*
                    if (metadata.artist && metadata.album) {
                        artist.textContent = metadata.album + ' - ' + metadata.artist
                    } else {
                        artist.textContent = metadata.artist || metadata.album || ""
                    }
                    */

                    
                    var mmeta = new MediaMetadata({
                        title: metadata.title || musicFile.name,
                        artist: metadata.artist || '',
                        album: metadata.album || '',
                    })

                    /*
                    mmeta.title = metadata.title || musicFile.name
                    mmeta.artist = metadata.artist || ''
                    mmeta.album = metadata.album || ''
                    */

                    var color = [0,0,139]

                    try {
                        if (metadata.picture) {
                            var picture = meta.selectCover(metadata.picture)

                            //var imageData = `data:${picture.format};base64,${picture.data.toBase64()}`;
                            var base64String = "";
                            for (var i = 0; i < picture.data.length; i++) {
                                base64String += String.fromCharCode(picture.data[i]);
                            }
                            var imageData = "data:" + picture.format + ";base64," + window.btoa(base64String);

                            cover.src = imageData

                            var smallImage = imageData

                            if (imageData.length > 2000) {
                                smallImage = resizeImage(cover)
                            }
                            
                            mmeta.artwork = [
                                {
                                    src: smallImage,
                                }
                            ]

                            const colorThief = new ColorThief();
                            
                            if (cover.complete) {
                                color = colorThief.getColor(cover);
                            } else {
                                cover.addEventListener('load', function() {
                                    color = colorThief.getColor(cover);
                                });
                            }
                        } else {
                            cover.src = placeholderCover
                            mmeta.artwork = [
                                {
                                    src: placeholderCover,
                                }
                            ]
                            color = [0,0,139]
                        }

                        setColor(color)
                    } catch (error) {
                        console.error('Error parsing image:', error.message)
                        errormsg.textContent = error.message
                        cover.src = placeholderCover
                        mmeta.artwork = [
                                {
                                    src: placeholderCover,
                                }
                        ]
                        setColor([0,0,139])
                    }
                    navigator.mediaSession.metadata = mmeta
                } catch (error) {
                    console.error('Error parsing metadata:', error.message);
                    data.textContent = ''
                    errormsg.textContent = error.message
                    cover.src = placeholderCover
                    title.textContent = musicFile.name
                    document.title = musicFile.name
                    artist.textContent = ''
                    album.textContent = ''
                    setColor([0,0,139])
                }
            })();
        }

        document.getElementById('loadFolders').addEventListener('change', function(e) {
            if (e.target.files) {
                fileList = fileList.concat(Array.from(e.target.files))
                fileList = filterList(fileList)
                if (playlistIndex == -2) {
                    setMusic(fileList[0])
                    playlistIndex = 0
                }
                setQueue()
            }
        })

        document.getElementById('loadFiles').addEventListener('change', function(e) {
            if (e.target.files) {
                fileList = fileList.concat(Array.from(e.target.files))
                filterList(fileList)
                if (playlistIndex == -2) {
                    setMusic(fileList[0])
                    playlistIndex = 0
                }
                setQueue()
            }
        })

        function filterList(list) {
            for (var i = 0; i < list.length; i++) {
                var file = list[i]
                if (!file.type.startsWith('audio/') && (file.type != 'application/ogg')) {
                    console.log(file.name + ' is bad type ' + file.type + ', removed')
                    list.splice(i,1)
                    i -= 1
                }
            }

            return list
        }

        function setColor(color) {
            // 0,0,139
            // 0,0,255
            // 91,91,255

            var clickMod = 2.5
            var hoverMod = 1.5

            var textColor = '#FFFFFF'
            var hover = 'rgb('
            var click = 'rgb('

            if ((color[0] + color[1] + color[2])/3 > 120) {
                textColor = '#000000'
                hover += (color[0]/hoverMod + ',' + color[1]/hoverMod + ',' + color[2]/hoverMod + ')')
                click += (color[0]/clickMod + ',' + color[1]/clickMod + ',' + color[2]/clickMod + ')')
            } else {
                hover += (color[0]*hoverMod + ',' + color[1]*hoverMod + ',' + color[2]*hoverMod + ')')
                click += (color[0]*clickMod + ',' + color[1]*clickMod + ',' + color[2]*clickMod + ')')
            }

            var finalColor = `rgb(${color[0]},${color[1]},${color[2]})`

            const style = document.getElementById('styleMod')
            style.innerHTML = `
            .select {
                background-color: ${finalColor};
                color: ${textColor};
            }
            label {
                background-color: ${finalColor};
                color: ${textColor};
                border: 1px solid ${textColor};
            }
            button {
                background-color: ${finalColor};
                color: ${textColor};
                border: 1px solid ${textColor};
            }
            button:hover {
                background-color: ${hover};
            }
            button:active {
                background-color: ${click};
            }
            label:hover {
                background-color: ${hover};
            }
            label:active {
                background-color: ${click};
            }
            input[type='range']{
                accent-color: ${finalColor};
            }`
        }

        function resizeImage(image) {
            const canvas = document.createElement('canvas')
            var context = canvas.getContext('2d')

            canvas.width = 500
            canvas.height = 500

            context.drawImage(image, 0, 0, 500, 500)

            return canvas.toDataURL()
        }

        function setQueue(start) {
            queueList.innerHTML = ''

            if (!fileList.length) {
                queueList.appendChild(document.createTextNode('Nothing Loaded, Bozo'))
                return
            }

            fileList.forEach ((musicFile, pos) => {
                //const musicFile = fileList[pos]
                const newBlob = document.createElement('div');
                newBlob.className = 'queueblob' + (pos == playlistIndex? ' select':'');
                newBlob.addEventListener('click', function (event) {changeTo(pos)});
                newBlob.id = pos;

                const blobImg = document.createElement('img');
                blobImg.className = 'smallcover';

                const newTitle = document.createElement('div');
                newTitle.className = 'smalltitle';

                const newInfo = document.createElement('div');
                newInfo.className = 'smallinfo';
            
                newBlob.appendChild(blobImg);
                newBlob.appendChild(newTitle);
                newBlob.appendChild(newInfo);
                queueList.appendChild(newBlob);
                /*
                console.log('blobImg', blobImg, blobImg instanceof Node);
                console.log('newTitle', newTitle, newTitle instanceof Node);
                console.log('newInfo', newInfo, newInfo instanceof Node);
                */

                //music-metadata
                (async () => {
                try {
                    var metadata = await meta.parseBlob(musicFile);
                    metadata = metadata.common

                    newTitle.textContent = metadata.title || musicFile.name

                    if (metadata.artist && metadata.album) {
                        newInfo.textContent = metadata.album + ' - ' + metadata.artist
                    } else {
                        newInfo.textContent = metadata.artist || metadata.album || ""
                    }

                    try {
                        if (metadata.picture) {
                            var picture = meta.selectCover(metadata.picture)
                            
                            //var blobImg.src = `data:${picture.format};base64,${picture.data.toBase64()}`;
                            var base64String = "";
                            for (var i = 0; i < picture.data.length; i++) {
                                base64String += String.fromCharCode(picture.data[i]);
                            }
                            blobImg.src = "data:" + picture.format + ";base64," + window.btoa(base64String);
                            
                        } else {
                            blobImg.src = placeholderCover
                        }
                    } catch (error) {
                        console.error('Error parsing image:', error.message)
                        blobImg.src = placeholderCover
                    }
                } catch (error) {
                    console.error('Error parsing metadata:', error.message);
                    blobImg.src = placeholderCover
                    newTitle.textContent = musicFile.name
                    newInfo.textContent = ''
                }
            })();
            })
            if (document.getElementById(0)) {
                document.getElementById(0).scrollIntoView({ behavior: "smooth", block: "center"})
            }
        }

        function shufflePlaylist() {
            fileList = shuffleArray(fileList)
            playlistIndex = -1
            setQueue(0)
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function clearQueue() {
            fileList = []
            playlistIndex = -1
            setQueue(0)
        }

        window.shufflePlaylist = shufflePlaylist;
        window.clearQueue = clearQueue;

        cover.src = placeholderCover
    </script>
    <script>
        //color-thief
        !function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t||self).ColorThief=n()}(this,function(){var t=function(t,n){return t<n?-1:t>n?1:0},n=function(t){return t.reduce(function(t,n){return t+n},0)},r=/*#__PURE__*/function(){function t(t){this.colors=t}var n=t.prototype;return n.palette=function(){return this.colors},n.map=function(t){return t},t}(),o=function(){function o(t,n,r){return(t<<10)+(n<<5)+r}function e(t){var n=[],r=!1;function o(){n.sort(t),r=!0}return{push:function(t){n.push(t),r=!1},peek:function(t){return r||o(),void 0===t&&(t=n.length-1),n[t]},pop:function(){return r||o(),n.pop()},size:function(){return n.length},map:function(t){return n.map(t)},debug:function(){return r||o(),n}}}function i(t,n,r,o,e,i,u){var a=this;a.r1=t,a.r2=n,a.g1=r,a.g2=o,a.b1=e,a.b2=i,a.histo=u}function u(){this.vboxes=new e(function(n,r){return t(n.vbox.count()*n.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function a(t,n){if(n.count()){var r=n.r2-n.r1+1,e=n.g2-n.g1+1,i=Math.max.apply(null,[r,e,n.b2-n.b1+1]);if(1==n.count())return[n.copy()];var u,a,c,f,s=0,h=[],l=[];if(i==r)for(u=n.r1;u<=n.r2;u++){for(f=0,a=n.g1;a<=n.g2;a++)for(c=n.b1;c<=n.b2;c++)f+=t[o(u,a,c)]||0;h[u]=s+=f}else if(i==e)for(u=n.g1;u<=n.g2;u++){for(f=0,a=n.r1;a<=n.r2;a++)for(c=n.b1;c<=n.b2;c++)f+=t[o(a,u,c)]||0;h[u]=s+=f}else for(u=n.b1;u<=n.b2;u++){for(f=0,a=n.r1;a<=n.r2;a++)for(c=n.g1;c<=n.g2;c++)f+=t[o(a,c,u)]||0;h[u]=s+=f}return h.forEach(function(t,n){l[n]=s-t}),function(t){var r,o,e,i,a,c=t+"1",f=t+"2",v=0;for(u=n[c];u<=n[f];u++)if(h[u]>s/2){for(e=n.copy(),i=n.copy(),a=(r=u-n[c])<=(o=n[f]-u)?Math.min(n[f]-1,~~(u+o/2)):Math.max(n[c],~~(u-1-r/2));!h[a];)a++;for(v=l[a];!v&&h[a-1];)v=l[--a];return e[f]=a,i[c]=e[f]+1,[e,i]}}(i==r?"r":i==e?"g":"b")}}return i.prototype={volume:function(t){var n=this;return n._volume&&!t||(n._volume=(n.r2-n.r1+1)*(n.g2-n.g1+1)*(n.b2-n.b1+1)),n._volume},count:function(t){var n=this,r=n.histo;if(!n._count_set||t){var e,i,u,a=0;for(e=n.r1;e<=n.r2;e++)for(i=n.g1;i<=n.g2;i++)for(u=n.b1;u<=n.b2;u++)a+=r[o(e,i,u)]||0;n._count=a,n._count_set=!0}return n._count},copy:function(){var t=this;return new i(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(t){var n=this,r=n.histo;if(!n._avg||t){var e,i,u,a,c=0,f=0,s=0,h=0;if(n.r1===n.r2&&n.g1===n.g2&&n.b1===n.b2)n._avg=[n.r1<<3,n.g1<<3,n.b1<<3];else{for(i=n.r1;i<=n.r2;i++)for(u=n.g1;u<=n.g2;u++)for(a=n.b1;a<=n.b2;a++)c+=e=r[o(i,u,a)]||0,f+=e*(i+.5)*8,s+=e*(u+.5)*8,h+=e*(a+.5)*8;n._avg=c?[~~(f/c),~~(s/c),~~(h/c)]:[~~(8*(n.r1+n.r2+1)/2),~~(8*(n.g1+n.g2+1)/2),~~(8*(n.b1+n.b2+1)/2)]}}return n._avg},contains:function(t){var n=this,r=t[0]>>3;return gval=t[1]>>3,bval=t[2]>>3,r>=n.r1&&r<=n.r2&&gval>=n.g1&&gval<=n.g2&&bval>=n.b1&&bval<=n.b2}},u.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var n=this.vboxes,r=0;r<n.size();r++)if(n.peek(r).vbox.contains(t))return n.peek(r).color;return this.nearest(t)},nearest:function(t){for(var n,r,o,e=this.vboxes,i=0;i<e.size();i++)((r=Math.sqrt(Math.pow(t[0]-e.peek(i).color[0],2)+Math.pow(t[1]-e.peek(i).color[1],2)+Math.pow(t[2]-e.peek(i).color[2],2)))<n||void 0===n)&&(n=r,o=e.peek(i).color);return o},forcebw:function(){var r=this.vboxes;r.sort(function(r,o){return t(n(r.color),n(o.color))});var o=r[0].color;o[0]<5&&o[1]<5&&o[2]<5&&(r[0].color=[0,0,0]);var e=r.length-1,i=r[e].color;i[0]>251&&i[1]>251&&i[2]>251&&(r[e].color=[255,255,255])}},{quantize:function(n,c){if(!Number.isInteger(c)||c<1||c>256)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!n.length||c<2||c>256)return!1;if(!n.length||c<2||c>256)return!1;for(var f=[],s=new Set,h=0;h<n.length;h++){var l=n[h],v=l.join(",");s.has(v)||(s.add(v),f.push(l))}if(f.length<=c)return new r(f);var g=function(t){var n,r=new Array(32768);return t.forEach(function(t){n=o(t[0]>>3,t[1]>>3,t[2]>>3),r[n]=(r[n]||0)+1}),r}(n);g.forEach(function(){});var p=function(t,n){var r,o,e,u=1e6,a=0,c=1e6,f=0,s=1e6,h=0;return t.forEach(function(t){(r=t[0]>>3)<u?u=r:r>a&&(a=r),(o=t[1]>>3)<c?c=o:o>f&&(f=o),(e=t[2]>>3)<s?s=e:e>h&&(h=e)}),new i(u,a,c,f,s,h,n)}(n,g),b=new e(function(n,r){return t(n.count(),r.count())});function d(t,n){for(var r,o=t.size(),e=0;e<1e3;){if(o>=n)return;if(e++>1e3)return;if((r=t.pop()).count()){var i=a(g,r),u=i[0],c=i[1];if(!u)return;t.push(u),c&&(t.push(c),o++)}else t.push(r),e++}}b.push(p),d(b,.75*c);for(var m=new e(function(n,r){return t(n.count()*n.volume(),r.count()*r.volume())});b.size();)m.push(b.pop());d(m,c);for(var w=new u;m.size();)w.push(m.pop());return w}}}().quantize,e=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=t.naturalWidth,this.height=this.canvas.height=t.naturalHeight,this.context.drawImage(t,0,0,this.width,this.height)};e.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var u=function(){};return u.prototype.getColor=function(t,n){return void 0===n&&(n=10),this.getPalette(t,5,n)[0]},u.prototype.getPalette=function(t,n,r){var i=function(t){var n=t.colorCount,r=t.quality;if(void 0!==n&&Number.isInteger(n)){if(1===n)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");n=Math.max(n,2),n=Math.min(n,20)}else n=10;return(void 0===r||!Number.isInteger(r)||r<1)&&(r=10),{colorCount:n,quality:r}}({colorCount:n,quality:r}),u=new e(t),a=function(t,n,r){for(var o,e,i,u,a,c=t,f=[],s=0;s<n;s+=r)e=c[0+(o=4*s)],i=c[o+1],u=c[o+2],(void 0===(a=c[o+3])||a>=125)&&(e>250&&i>250&&u>250||f.push([e,i,u]));return f}(u.getImageData().data,u.width*u.height,i.quality),c=o(a,i.colorCount);return c?c.palette():null},u.prototype.getColorFromUrl=function(t,n,r){var o=this,e=document.createElement("img");e.addEventListener("load",function(){var i=o.getPalette(e,5,r);n(i[0],t)}),e.src=t},u.prototype.getImageData=function(t,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){if(200==this.status){var t=new Uint8Array(this.response);i=t.length;for(var r=new Array(i),o=0;o<t.length;o++)r[o]=String.fromCharCode(t[o]);var e=r.join(""),u=window.btoa(e);n("data:image/png;base64,"+u)}},r.send()},u.prototype.getColorAsync=function(t,n,r){var o=this;this.getImageData(t,function(t){var e=document.createElement("img");e.addEventListener("load",function(){var t=o.getPalette(e,5,r);n(t[0],this)}),e.src=t})},u});    
    </script>
</html>
